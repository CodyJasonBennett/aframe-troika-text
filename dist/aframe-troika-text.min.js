!function(e,r){"use strict";e=e&&e.hasOwnProperty("default")?e.default:e;var t="function"==typeof Promise?function(){var e,r,t=new Promise(function(t,n){e=t,r=n});return{then:t.then.bind(t),resolve:e,reject:r}}:function e(){var r,t=0,n=[],a=0,i=0;var o=c(function(e){i||u(1,e)}),s=c(function(e){i||u(-1,e)});function u(e,n){i++;var a=0;try{n===g&&p();var o=e>0&&d(n);o?o.call(n,c(function(e){a++,u(1,e)}),c(function(e){a++,u(-1,e)})):(t=e,r=n,f())}catch(e){t||a||u(-1,e)}}function f(){a||(setTimeout(l,0),a=1)}function l(){var e=n;a=0,n=[],e.forEach(h)}function h(e){e()}function d(e){var r=e&&(v(e)||"object"==typeof e)&&e.then;return v(r)&&r}function c(e){var r=0;return function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];r++||e.apply(this,t)}}function p(){throw new TypeError("Chaining cycle detected")}var v=function(e){return"function"==typeof e},g={then:function(a,i){var o=e();return n.push(function(){var e=t>0?a:i;if(v(e))try{var n=e(r);n===o&&p();var s=d(n);s?s.call(n,o.resolve,o.reject):o.resolve(n)}catch(e){o.reject(e)}else o[t>0?"resolve":"reject"](r)}),t&&f(),o},resolve:o,reject:s};return g},n=0,a=0,i=Object.create(null),o=Object.create(null);function s(e){if(!e||"function"!=typeof e.init)throw new Error("requires `options.init` function");var r=e.dependencies,t=e.init,a=e.getTransferables,i=e.workerId;null==i&&(i="#default");var o="workerModule"+ ++n,f=null;function h(){for(var e=[],r=arguments.length;r--;)e[r]=arguments[r];return f||(f=l(i,"registerModule",h.workerModuleData)),f.then(function(r){if(r.isCallable)return l(i,"callModule",{id:o,args:e});throw new Error("Worker module function was called but `init` did not return a callable function")})}return r=r&&r.map(function(e){return"function"!=typeof e||e.workerModuleData||(e=s({workerId:i,init:new Function("return function(){return ("+u(e)+")}")()})),e&&e.workerModuleData&&(e=e.workerModuleData),e}),h.workerModuleData={isWorkerModule:!0,id:o,dependencies:r,init:u(t),getTransferables:a&&u(a)},h}function u(e){var r=e.toString();return!/^function/.test(r)&&/^\w+\s*\(/.test(r)&&(r="function "+r),r}function f(e){var r=i[e];if(!r){var t=function(){var e=Object.create(null);self.addEventListener("message",function(r){var t=r.data,n=t.messageId,a=t.action,i=t.data;try{"registerModule"===a&&function r(t,n){var a=t.id,i=t.dependencies;void 0===i&&(i=[]);var o=t.init;void 0===o&&(o=function(){});var s=t.getTransferables;if(void 0===s&&(s=null),!e[a])try{i=i.map(function(t){return t&&t.isWorkerModule&&(r(t,function(e){if(e instanceof Error)throw e}),t=e[t.id].value),t}),o=new Function("return ("+o+")")(),s&&(s=new Function("return ("+s+")")());var u=o.apply(void 0,i);e[a]={id:a,value:u,getTransferables:s},n(u)}catch(e){e&&e.noLog||console.error(e),n(e)}}(i,function(e){e instanceof Error?postMessage({messageId:n,success:!1,error:e.message}):postMessage({messageId:n,success:!0,result:{isCallable:"function"==typeof e}})}),"callModule"===a&&function(r,t){var n,a=r.id,i=r.args;e[a]&&"function"==typeof e[a].value||t(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var o=(n=e[a]).value.apply(n,i);o&&"function"==typeof o.then?o.then(s,function(e){return t(e instanceof Error?e:new Error(""+e))}):s(o)}catch(e){t(e)}function s(r){try{var n=e[a].getTransferables&&e[a].getTransferables(r);n&&Array.isArray(n)&&n.length||(n=void 0),t(r,n)}catch(e){console.error(e),t(e)}}}(i,function(e,r){e instanceof Error?postMessage({messageId:n,success:!1,error:e.message}):postMessage({messageId:n,success:!0,result:e},r||void 0)})}catch(e){postMessage({messageId:n,success:!1,error:e.stack})}})}.toString();(r=i[e]=new Worker(URL.createObjectURL(new Blob([";("+t+")()"],{type:"application/javascript"})))).onmessage=function(e){var r=e.data,t=r.messageId,n=o[t];if(!n)throw new Error("WorkerModule response with empty or unknown messageId");delete o[t],o.count--,n(r)}}return r}function l(e,r,n){var i=t(),s=++a;return o[s]=function(e){e.success?i.resolve(e.result):i.reject(new Error("Error in worker "+r+" call: "+e.error))},o._count++,o.count>1e3&&console.warn("Large number of open WorkerModule requests, some may not be returning"),f(e).postMessage({messageId:s,action:r,data:n}),i}o._count=0;var h=s({dependencies:[t],init:function(e){return e}}),d=/\bvoid\s+main\s*\(\s*\)\s*{/g;function c(e){return e.replace(/^[ \t]*#include +<([\w\d.\/]+)>/gm,function(e,t){var n=r.ShaderChunk[t];return n?c(n):e})}var p=Object.assign||function(){for(var e=arguments,r=arguments[0],t=1,n=arguments.length;t<n;t++){var a=e[t];if(a)for(var i in a)a.hasOwnProperty(i)&&(r[i]=a[i])}return r},v=0,g=Date.now(),m=new WeakMap;function y(e,t){var n=function(e){return JSON.stringify(e,U)}(t),a=m.get(e);if(a||(a=Object.create(null),m.set(e,a)),a[n])return a[n].clone();var i,o,s=++v,u="_derivedShaders"+s,f="_onBeforeCompile"+s;function l(r){e.onBeforeCompile.call(this,r);var n=this[u]||(this[u]={vertex:{},fragment:{}}),a=n.vertex,i=n.fragment;if(a.source!==r.vertexShader||i.source!==r.fragmentShader){var o=function(e,r,t){var n=e.vertexShader,a=e.fragmentShader,i=r.vertexDefs,o=r.vertexMainIntro,s=r.vertexTransform,u=r.fragmentDefs,f=r.fragmentMainIntro,l=r.fragmentColorTransform,h=r.timeUniform;if(h){var p="\nuniform float "+h+";\n";i=(i||"")+p,u=(u||"")+p}(i||o||s)&&(s&&(n=c(n),i=(i||"")+"\nvoid troikaVertexTransform"+t+"(inout vec3 position, inout vec3 normal, inout vec2 uv) {\n  "+s+"\n}\n",n=n.replace(/\b(position|normal|uv)\b/g,function(e,r,n,a){return/\battribute\s+vec[23]\s+$/.test(a.substr(0,n))?r:"troika_"+r+"_"+t}),o="\nvec3 troika_position_"+t+" = vec3(position);\nvec3 troika_normal_"+t+" = vec3(normal);\nvec2 troika_uv_"+t+" = vec2(uv);\ntroikaVertexTransform"+t+"(troika_position_"+t+", troika_normal_"+t+", troika_uv_"+t+");\n"+(o||"")+"\n"),n=n.replace(d,(i||"")+"\n\n$&\n\n"+(o||"")));(u||f||l)&&(a=(a=c(a)).replace(d,"\n"+(u||"")+"\nvoid troikaOrigMain"+t+"() {\n"+(f||"")+"\n"),a+="\nvoid main() {\n  troikaOrigMain"+t+"();\n  "+(l||"")+"\n}");return{vertexShader:n,fragmentShader:a}}(r,t,s);a.source=r.vertexShader,a.result=o.vertexShader,i.source=r.fragmentShader,i.result=o.fragmentShader}r.vertexShader=a.result,r.fragmentShader=i.result,p(r.uniforms,this.uniforms),t.timeUniform&&(r.uniforms[t.timeUniform]={get value(){return Date.now()-g}}),this[f]&&this[f](r)}function h(){e.constructor.apply(this,arguments),this._listeners=void 0}h.prototype=Object.create(e,{constructor:{value:h},isDerivedMaterial:{value:!0},baseMaterial:{value:e},onBeforeCompile:{get:function(){return l},set:function(e){this[f]=e}},copy:{value:function(t){return e.copy.call(this,t),e.isShaderMaterial||e.isDerivedMaterial||(this.extensions=p({},t.extensions),this.defines=p({},t.defines),this.uniforms=r.UniformsUtils.clone(t.uniforms)),this}},getDepthMaterial:{value:function(){var n=this._depthMaterial;return n||(o||((o=y(e.isDerivedMaterial?e.getDepthMaterial():new r.MeshDepthMaterial({depthPacking:r.RGBADepthPacking}),t)).defines.IS_DEPTH_MATERIAL=""),n=this._depthMaterial=o.clone()),n}},getDistanceMaterial:{value:function(){var n=this._distanceMaterial;return n||(i||((i=y(e.isDerivedMaterial?e.getDistanceMaterial():new r.MeshDistanceMaterial,t)).defines.IS_DISTANCE_MATERIAL=""),n=this._distanceMaterial=i.clone()),n}},dispose:{value:function(){var r=this._depthMaterial,t=this._distanceMaterial;r&&r.dispose(),t&&t.dispose(),e.dispose.call(this)}}});var S=new h;return S.copy(e),S.uniforms=p(r.UniformsUtils.clone(e.uniforms||{}),t.uniforms),S.defines=p({},e.defines,t.defines),S.defines.TROIKA_DERIVED_MATERIAL=s,S.extensions=p({},e.extensions,t.extensions),a[n]=S,S.clone()}function U(e,r){return"uniforms"===e?void 0:r}var S=function(e){this.name=e,this.textureUniform="dataTex_"+e,this.textureSizeUniform="dataTexSize_"+e,this.multiplierUniform="dataMultiplier_"+e,this.dataSizeUniform="dataSize_"+e,this.readFunction="readData_"+e,this._raw=new Float32Array(0),this._texture=new r.DataTexture(new Uint8Array(0),0,1),this._length=0,this._multiplier=1},x={length:{configurable:!0}};function b(e,r,t){var n=255*e,a=n%1*255,i=a%1*255,o=i%1*255;return n&=255,a&=255,i&=255,o=255&Math.round(o),r[t]=n,r[t+1]=a,r[t+2]=i,r[t+3]=o,r}x.length.set=function(e){if(e!==this._length){var r=Math.pow(2,Math.ceil(Math.log2(e))),t=this._raw;r<t.length?this._raw=t.subarray(0,r):r>t.length&&(this._raw=new Float32Array(r),this._raw.set(t)),this._length=e}},x.length.get=function(){return this._length},S.prototype.push=function(e){return this.set(this.length++,e)},S.prototype.setArray=function(e){this.length=e.length,this._raw.set(e),this._needsRepack=!0},S.prototype.get=function(e){return this._raw[e]},S.prototype.set=function(e,r){e+1>this._length&&(this.length=e+1),r!==this._raw[e]&&(this._raw[e]=r,b(r/this._multiplier,this._texture.image.data,4*e),this._needsMultCheck=!0)},S.prototype.clone=function(){var e=new S(this.name);return e.setArray(this._raw),e},S.prototype.getShaderUniforms=function(){var e,r=this;return(e={})[this.textureUniform]={get value(){return r._sync(),r._texture}},e[this.textureSizeUniform]={get value(){return r._sync(),r._texture.image.width}},e[this.dataSizeUniform]={get value(){return r._sync(),r.length}},e[this.multiplierUniform]={get value(){return r._sync(),r._multiplier}},e},S.prototype.getShaderHeaderCode=function(){var e=this.textureUniform,r=this.textureSizeUniform,t=this.dataSizeUniform,n=this.multiplierUniform;return"\nuniform sampler2D "+e+";\nuniform float "+r+";\nuniform float "+t+";\nuniform float "+n+";\n\nfloat "+this.readFunction+"(float index) {\n  vec2 texUV = vec2((index + 0.5) / "+r+", 0.5);\n  vec4 pixel = texture2D("+e+", texUV);\n  return dot(pixel, 1.0 / vec4(1.0, 255.0, 65025.0, 16581375.0)) * "+n+";\n}\n"},S.prototype._sync=function(){var e=this._texture,r=this._raw,t=this._needsRepack;if(r.length!==e.image.width&&(e.image={data:new Uint8Array(4*r.length),width:r.length,height:1},t=!0),t||this._needsMultCheck){var n=this._raw.reduce(function(e,r){return Math.max(e,r)},0),a=Math.pow(2,Math.ceil(Math.log2(n)));a!==this._multiplier&&(this._multiplier=a,t=!0),e.needsUpdate=!0,this._needsMultCheck=!1}if(t){for(var i=0,o=r.length,s=this._multiplier;i<o;i++)b(r[i]/s,e.image.data,4*i);this._needsRepack=!1}},Object.defineProperties(S.prototype,x);var _="\nuniform vec3 pointA;\nuniform vec3 controlA;\nuniform vec3 controlB;\nuniform vec3 pointB;\nuniform float radius;\nvarying float bezierT;\n\nvec3 cubicBezier(vec3 p1, vec3 c1, vec3 c2, vec3 p2, float t) {\n  float t2 = 1.0 - t;\n  float b0 = t2 * t2 * t2;\n  float b1 = 3.0 * t * t2 * t2;\n  float b2 = 3.0 * t * t * t2;\n  float b3 = t * t * t;\n  return b0 * p1 + b1 * c1 + b2 * c2 + b3 * p2;\n}\n\nvec3 cubicBezierDerivative(vec3 p1, vec3 c1, vec3 c2, vec3 p2, float t) {\n  float t2 = 1.0 - t;\n  return -3.0 * p1 * t2 * t2 +\n    c1 * (3.0 * t2 * t2 - 6.0 * t2 * t) +\n    c2 * (6.0 * t2 * t - 3.0 * t * t) +\n    3.0 * p2 * t * t;\n}\n",w='\nfloat t = position.y;\nbezierT = t;\nvec3 bezierCenterPos = cubicBezier(pointA, controlA, controlB, pointB, t);\nvec3 bezierDir = normalize(cubicBezierDerivative(pointA, controlA, controlB, pointB, t));\n\n// Make "sideways" always perpendicular to the camera ray; this ensures that any twists\n// in the cylinder occur where you won\'t see them: \nvec3 viewDirection = normalMatrix * vec3(0.0, 0.0, 1.0);\nif (bezierDir == viewDirection) {\n  bezierDir = normalize(cubicBezierDerivative(pointA, controlA, controlB, pointB, t == 1.0 ? t - 0.0001 : t + 0.0001));\n}\nvec3 sideways = normalize(cross(bezierDir, viewDirection));\nvec3 upish = normalize(cross(sideways, bezierDir));\n\n// Build a matrix for transforming this disc in the cylinder:\nmat4 discTx;\ndiscTx[0].xyz = sideways * radius;\ndiscTx[1].xyz = bezierDir * radius;\ndiscTx[2].xyz = upish * radius;\ndiscTx[3].xyz = bezierCenterPos;\ndiscTx[3][3] = 1.0;\n\n// Apply transform, ignoring original y\nposition = (discTx * vec4(position.x, 0.0, position.z, 1.0)).xyz;\nnormal = normalize(mat3(discTx) * normal);\n',F="\nuniform vec3 dashing;\nvarying float bezierT;\n",k="\nif (dashing.x + dashing.y > 0.0) {\n  float dashFrac = mod(bezierT - dashing.z, dashing.x + dashing.y);\n  if (dashFrac > dashing.x) {\n    discard;\n  }\n}\n";var C=null,T=new r.MeshStandardMaterial({color:16777215,side:r.DoubleSide});!function(e){function t(){e.call(this,C||(C=new r.CylinderBufferGeometry(1,1,1,6,64).translate(0,.5,0)),T),this.pointA=new r.Vector3,this.controlA=new r.Vector3,this.controlB=new r.Vector3,this.pointB=new r.Vector3,this.radius=.01,this.dashArray=new r.Vector2,this.dashOffset=0,this.frustumCulled=!1}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={material:{configurable:!0},customDepthMaterial:{configurable:!0},customDistanceMaterial:{configurable:!0}};n.material.get=function(){var e=this._derivedMaterial,t=this._baseMaterial||T;return e&&e.baseMaterial===t||(e&&e.dispose(),e=this._derivedMaterial=function(e){return y(e,{uniforms:{pointA:{value:new r.Vector3},controlA:{value:new r.Vector3},controlB:{value:new r.Vector3},pointB:{value:new r.Vector3},radius:{value:.01},dashing:{value:new r.Vector3}},vertexDefs:_,vertexTransform:w,fragmentDefs:F,fragmentMainIntro:k})}(t),t.addEventListener("dispose",function r(){t.removeEventListener("dispose",r),e.dispose()})),e},n.material.set=function(e){this._baseMaterial=e},n.customDepthMaterial.get=function(){return this._updateBezierUniforms(this.material.getDepthMaterial())},n.customDistanceMaterial.get=function(){return this._updateBezierUniforms(this.material.getDistanceMaterial())},t.prototype.onBeforeRender=function(e){this._updateBezierUniforms(this.material)},t.prototype._updateBezierUniforms=function(e){var r=e.uniforms,t=this.pointA,n=this.controlA,a=this.controlB,i=this.pointB,o=this.radius,s=this.dashArray,u=this.dashOffset;return r.pointA.value.copy(t),r.controlA.value.copy(n),r.controlB.value.copy(a),r.pointB.value.copy(i),r.radius.value=o,r.dashing.value.set(s.x,s.y,u||0),e},t.prototype.raycast=function(e,r){},Object.defineProperties(t.prototype,n)}(r.Mesh);var M=s({dependencies:[function(){var e=self,r={parse:function(e){var t=r._bin,n=new Uint8Array(e);if("ttcf"==t.readASCII(n,0,4)){var a=4;t.readUshort(n,a);a+=2;t.readUshort(n,a);a+=2;var i=t.readUint(n,a);a+=4;for(var o=[],s=0;s<i;s++){var u=t.readUint(n,a);a+=4,o.push(r._readFont(n,u))}return o}return[r._readFont(n,0)]},_readFont:function(e,t){var n=r._bin,a=t;n.readFixed(e,t);t+=4;var i=n.readUshort(e,t);t+=2;n.readUshort(e,t);t+=2;n.readUshort(e,t);t+=2;n.readUshort(e,t);t+=2;for(var o=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],s={_data:e,_offset:a},u={},f=0;f<i;f++){var l=n.readASCII(e,t,4);t+=4;n.readUint(e,t);t+=4;var h=n.readUint(e,t);t+=4;var d=n.readUint(e,t);t+=4,u[l]={offset:h,length:d}}for(f=0;f<o.length;f++){var c=o[f];u[c]&&(s[c.trim()]=r[c.trim()].parse(e,u[c].offset,u[c].length,s))}return s},_tabOffset:function(e,t,n){for(var a=r._bin,i=a.readUshort(e,n+4),o=n+12,s=0;s<i;s++){var u=a.readASCII(e,o,4);o+=4;a.readUint(e,o);o+=4;var f=a.readUint(e,o);o+=4;a.readUint(e,o);if(o+=4,u==t)return f}return 0}};return r._bin={readFixed:function(e,r){return(e[r]<<8|e[r+1])+(e[r+2]<<8|e[r+3])/65540},readF2dot14:function(e,t){return r._bin.readShort(e,t)/16384},readInt:function(e,t){var n=r._bin.t.uint8;return n[0]=e[t+3],n[1]=e[t+2],n[2]=e[t+1],n[3]=e[t],r._bin.t.int32[0]},readInt8:function(e,t){return r._bin.t.uint8[0]=e[t],r._bin.t.int8[0]},readShort:function(e,t){var n=r._bin.t.uint8;return n[1]=e[t],n[0]=e[t+1],r._bin.t.int16[0]},readUshort:function(e,r){return e[r]<<8|e[r+1]},readUshorts:function(e,t,n){for(var a=[],i=0;i<n;i++)a.push(r._bin.readUshort(e,t+2*i));return a},readUint:function(e,t){var n=r._bin.t.uint8;return n[3]=e[t],n[2]=e[t+1],n[1]=e[t+2],n[0]=e[t+3],r._bin.t.uint32[0]},readUint64:function(e,t){return 4294967296*r._bin.readUint(e,t)+r._bin.readUint(e,t+4)},readASCII:function(e,r,t){for(var n="",a=0;a<t;a++)n+=String.fromCharCode(e[r+a]);return n},readUnicode:function(e,r,t){for(var n="",a=0;a<t;a++){var i=e[r++]<<8|e[r++];n+=String.fromCharCode(i)}return n},_tdec:e.TextDecoder?new e.TextDecoder:null,readUTF8:function(e,t,n){var a=r._bin._tdec;return a&&0==t&&n==e.length?a.decode(e):r._bin.readASCII(e,t,n)},readBytes:function(e,r,t){for(var n=[],a=0;a<t;a++)n.push(e[r+a]);return n},readASCIIArray:function(e,r,t){for(var n=[],a=0;a<t;a++)n.push(String.fromCharCode(e[r+a]));return n}},r._bin.t={buff:new ArrayBuffer(8)},r._bin.t.int8=new Int8Array(r._bin.t.buff),r._bin.t.uint8=new Uint8Array(r._bin.t.buff),r._bin.t.int16=new Int16Array(r._bin.t.buff),r._bin.t.uint16=new Uint16Array(r._bin.t.buff),r._bin.t.int32=new Int32Array(r._bin.t.buff),r._bin.t.uint32=new Uint32Array(r._bin.t.buff),r._lctf={},r._lctf.parse=function(e,t,n,a,i){var o=r._bin,s={},u=t;o.readFixed(e,t);t+=4;var f=o.readUshort(e,t);t+=2;var l=o.readUshort(e,t);t+=2;var h=o.readUshort(e,t);return t+=2,s.scriptList=r._lctf.readScriptList(e,u+f),s.featureList=r._lctf.readFeatureList(e,u+l),s.lookupList=r._lctf.readLookupList(e,u+h,i),s},r._lctf.readLookupList=function(e,t,n){var a=r._bin,i=t,o=[],s=a.readUshort(e,t);t+=2;for(var u=0;u<s;u++){var f=a.readUshort(e,t);t+=2;var l=r._lctf.readLookupTable(e,i+f,n);o.push(l)}return o},r._lctf.readLookupTable=function(e,t,n){var a=r._bin,i=t,o={tabs:[]};o.ltype=a.readUshort(e,t),t+=2,o.flag=a.readUshort(e,t),t+=2;var s=a.readUshort(e,t);t+=2;for(var u=0;u<s;u++){var f=a.readUshort(e,t);t+=2;var l=n(e,o.ltype,i+f);o.tabs.push(l)}return o},r._lctf.numOfOnes=function(e){for(var r=0,t=0;t<32;t++)0!=(e>>>t&1)&&r++;return r},r._lctf.readClassDef=function(e,t){var n=r._bin,a=[],i=n.readUshort(e,t);if(t+=2,1==i){var o=n.readUshort(e,t);t+=2;var s=n.readUshort(e,t);t+=2;for(var u=0;u<s;u++)a.push(o+u),a.push(o+u),a.push(n.readUshort(e,t)),t+=2}if(2==i){var f=n.readUshort(e,t);t+=2;for(u=0;u<f;u++)a.push(n.readUshort(e,t)),t+=2,a.push(n.readUshort(e,t)),t+=2,a.push(n.readUshort(e,t)),t+=2}return a},r._lctf.getInterval=function(e,r){for(var t=0;t<e.length;t+=3){var n=e[t],a=e[t+1];e[t+2];if(n<=r&&r<=a)return t}return-1},r._lctf.readCoverage=function(e,t){var n=r._bin,a={};a.fmt=n.readUshort(e,t),t+=2;var i=n.readUshort(e,t);return t+=2,1==a.fmt&&(a.tab=n.readUshorts(e,t,i)),2==a.fmt&&(a.tab=n.readUshorts(e,t,3*i)),a},r._lctf.coverageIndex=function(e,t){var n=e.tab;if(1==e.fmt)return n.indexOf(t);if(2==e.fmt){var a=r._lctf.getInterval(n,t);if(-1!=a)return n[a+2]+(t-n[a])}return-1},r._lctf.readFeatureList=function(e,t){var n=r._bin,a=t,i=[],o=n.readUshort(e,t);t+=2;for(var s=0;s<o;s++){var u=n.readASCII(e,t,4);t+=4;var f=n.readUshort(e,t);t+=2,i.push({tag:u.trim(),tab:r._lctf.readFeatureTable(e,a+f)})}return i},r._lctf.readFeatureTable=function(e,t){var n=r._bin;n.readUshort(e,t);t+=2;var a=n.readUshort(e,t);t+=2;for(var i=[],o=0;o<a;o++)i.push(n.readUshort(e,t+2*o));return i},r._lctf.readScriptList=function(e,t){var n=r._bin,a=t,i={},o=n.readUshort(e,t);t+=2;for(var s=0;s<o;s++){var u=n.readASCII(e,t,4);t+=4;var f=n.readUshort(e,t);t+=2,i[u.trim()]=r._lctf.readScriptTable(e,a+f)}return i},r._lctf.readScriptTable=function(e,t){var n=r._bin,a=t,i={},o=n.readUshort(e,t);t+=2,i.default=r._lctf.readLangSysTable(e,a+o);var s=n.readUshort(e,t);t+=2;for(var u=0;u<s;u++){var f=n.readASCII(e,t,4);t+=4;var l=n.readUshort(e,t);t+=2,i[f.trim()]=r._lctf.readLangSysTable(e,a+l)}return i},r._lctf.readLangSysTable=function(e,t){var n=r._bin,a={};n.readUshort(e,t);t+=2,a.reqFeature=n.readUshort(e,t),t+=2;var i=n.readUshort(e,t);return t+=2,a.features=n.readUshorts(e,t,i),a},r.CFF={},r.CFF.parse=function(e,t,n){var a=r._bin;(e=new Uint8Array(e.buffer,t,n))[t=0],e[++t],e[++t],e[++t];t++;var i=[];t=r.CFF.readIndex(e,t,i);for(var o=[],s=0;s<i.length-1;s++)o.push(a.readASCII(e,t+i[s],i[s+1]-i[s]));t+=i[i.length-1];var u=[];t=r.CFF.readIndex(e,t,u);var f=[];for(s=0;s<u.length-1;s++)f.push(r.CFF.readDict(e,t+u[s],t+u[s+1]));t+=u[u.length-1];var l=f[0],h=[];t=r.CFF.readIndex(e,t,h);var d=[];for(s=0;s<h.length-1;s++)d.push(a.readASCII(e,t+h[s],h[s+1]-h[s]));if(t+=h[h.length-1],r.CFF.readSubrs(e,t,l),l.CharStrings){t=l.CharStrings;h=[];t=r.CFF.readIndex(e,t,h);var c=[];for(s=0;s<h.length-1;s++)c.push(a.readBytes(e,t+h[s],h[s+1]-h[s]));l.CharStrings=c}if(l.ROS){t=l.FDArray;var p=[];t=r.CFF.readIndex(e,t,p),l.FDArray=[];for(s=0;s<p.length-1;s++){var v=r.CFF.readDict(e,t+p[s],t+p[s+1]);r.CFF._readFDict(e,v,d),l.FDArray.push(v)}t+=p[p.length-1],t=l.FDSelect,l.FDSelect=[];var g=e[t];if(t++,3!=g)throw g;var m=a.readUshort(e,t);t+=2;for(s=0;s<m+1;s++)l.FDSelect.push(a.readUshort(e,t),e[t+2]),t+=3}return l.Encoding&&(l.Encoding=r.CFF.readEncoding(e,l.Encoding,l.CharStrings.length)),l.charset&&(l.charset=r.CFF.readCharset(e,l.charset,l.CharStrings.length)),r.CFF._readFDict(e,l,d),l},r.CFF._readFDict=function(e,t,n){var a;for(var i in t.Private&&(a=t.Private[1],t.Private=r.CFF.readDict(e,a,a+t.Private[0]),t.Private.Subrs&&r.CFF.readSubrs(e,a+t.Private.Subrs,t.Private)),t)-1!=["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(i)&&(t[i]=n[t[i]-426+35])},r.CFF.readSubrs=function(e,t,n){var a=r._bin,i=[];t=r.CFF.readIndex(e,t,i);var o,s=i.length;o=s<1240?107:s<33900?1131:32768,n.Bias=o,n.Subrs=[];for(var u=0;u<i.length-1;u++)n.Subrs.push(a.readBytes(e,t+i[u],i[u+1]-i[u]))},r.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],r.CFF.glyphByUnicode=function(e,r){for(var t=0;t<e.charset.length;t++)if(e.charset[t]==r)return t;return-1},r.CFF.glyphBySE=function(e,t){return t<0||t>255?-1:r.CFF.glyphByUnicode(e,r.CFF.tableSE[t])},r.CFF.readEncoding=function(e,t,n){r._bin;var a=[".notdef"],i=e[t];if(0!=i)throw"error: unknown encoding format: "+i;var o=e[++t];t++;for(var s=0;s<o;s++)a.push(e[t+s]);return a},r.CFF.readCharset=function(e,t,n){var a=r._bin,i=[".notdef"],o=e[t];if(t++,0==o)for(var s=0;s<n;s++){var u=a.readUshort(e,t);t+=2,i.push(u)}else{if(1!=o&&2!=o)throw"error: format: "+o;for(;i.length<n;){u=a.readUshort(e,t);t+=2;var f=0;1==o?(f=e[t],t++):(f=a.readUshort(e,t),t+=2);for(s=0;s<=f;s++)i.push(u),u++}}return i},r.CFF.readIndex=function(e,t,n){var a=r._bin,i=a.readUshort(e,t)+1,o=e[t+=2];if(t++,1==o)for(var s=0;s<i;s++)n.push(e[t+s]);else if(2==o)for(s=0;s<i;s++)n.push(a.readUshort(e,t+2*s));else if(3==o)for(s=0;s<i;s++)n.push(16777215&a.readUint(e,t+3*s-1));else if(1!=i)throw"unsupported offset size: "+o+", count: "+i;return(t+=i*o)-1},r.CFF.getCharString=function(e,t,n){var a=r._bin,i=e[t],o=e[t+1],s=(e[t+2],e[t+3],e[t+4],1),u=null,f=null;i<=20&&(u=i,s=1),12==i&&(u=100*i+o,s=2),21<=i&&i<=27&&(u=i,s=1),28==i&&(f=a.readShort(e,t+1),s=3),29<=i&&i<=31&&(u=i,s=1),32<=i&&i<=246&&(f=i-139,s=1),247<=i&&i<=250&&(f=256*(i-247)+o+108,s=2),251<=i&&i<=254&&(f=256*-(i-251)-o-108,s=2),255==i&&(f=a.readInt(e,t+1)/65535,s=5),n.val=null!=f?f:"o"+u,n.size=s},r.CFF.readCharString=function(e,t,n){for(var a=t+n,i=r._bin,o=[];t<a;){var s=e[t],u=e[t+1],f=(e[t+2],e[t+3],e[t+4],1),l=null,h=null;s<=20&&(l=s,f=1),12==s&&(l=100*s+u,f=2),19!=s&&20!=s||(l=s,f=2),21<=s&&s<=27&&(l=s,f=1),28==s&&(h=i.readShort(e,t+1),f=3),29<=s&&s<=31&&(l=s,f=1),32<=s&&s<=246&&(h=s-139,f=1),247<=s&&s<=250&&(h=256*(s-247)+u+108,f=2),251<=s&&s<=254&&(h=256*-(s-251)-u-108,f=2),255==s&&(h=i.readInt(e,t+1)/65535,f=5),o.push(null!=h?h:"o"+l),t+=f}return o},r.CFF.readDict=function(e,t,n){for(var a=r._bin,i={},o=[];t<n;){var s=e[t],u=e[t+1],f=(e[t+2],e[t+3],e[t+4],1),l=null,h=null;if(28==s&&(h=a.readShort(e,t+1),f=3),29==s&&(h=a.readInt(e,t+1),f=5),32<=s&&s<=246&&(h=s-139,f=1),247<=s&&s<=250&&(h=256*(s-247)+u+108,f=2),251<=s&&s<=254&&(h=256*-(s-251)-u-108,f=2),255==s)throw h=a.readInt(e,t+1)/65535,f=5,"unknown number";if(30==s){var d=[];for(f=1;;){var c=e[t+f];f++;var p=c>>4,v=15&c;if(15!=p&&d.push(p),15!=v&&d.push(v),15==v)break}for(var g="",m=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],y=0;y<d.length;y++)g+=m[d[y]];h=parseFloat(g)}if(s<=21)if(l=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],f=1,12==s)l=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][u],f=2;null!=l?(i[l]=1==o.length?o[0]:o,o=[]):o.push(h),t+=f}return i},r.cmap={},r.cmap.parse=function(e,t,n){e=new Uint8Array(e.buffer,t,n),t=0;var a=r._bin,i={};a.readUshort(e,t);t+=2;var o=a.readUshort(e,t);t+=2;var s=[];i.tables=[];for(var u=0;u<o;u++){var f=a.readUshort(e,t);t+=2;var l=a.readUshort(e,t);t+=2;var h=a.readUint(e,t);t+=4;var d="p"+f+"e"+l,c=s.indexOf(h);if(-1==c){var p;c=i.tables.length,s.push(h);var v=a.readUshort(e,h);0==v?p=r.cmap.parse0(e,h):4==v?p=r.cmap.parse4(e,h):6==v?p=r.cmap.parse6(e,h):12==v?p=r.cmap.parse12(e,h):console.log("unknown format: "+v,f,l,h),i.tables.push(p)}if(null!=i[d])throw"multiple tables for one platform+encoding";i[d]=c}return i},r.cmap.parse0=function(e,t){var n=r._bin,a={};a.format=n.readUshort(e,t),t+=2;var i=n.readUshort(e,t);t+=2;n.readUshort(e,t);t+=2,a.map=[];for(var o=0;o<i-6;o++)a.map.push(e[t+o]);return a},r.cmap.parse4=function(e,t){var n=r._bin,a=t,i={};i.format=n.readUshort(e,t),t+=2;var o=n.readUshort(e,t);t+=2;n.readUshort(e,t);t+=2;var s=n.readUshort(e,t);t+=2;var u=s/2;i.searchRange=n.readUshort(e,t),t+=2,i.entrySelector=n.readUshort(e,t),t+=2,i.rangeShift=n.readUshort(e,t),t+=2,i.endCount=n.readUshorts(e,t,u),t+=2*u,t+=2,i.startCount=n.readUshorts(e,t,u),t+=2*u,i.idDelta=[];for(var f=0;f<u;f++)i.idDelta.push(n.readShort(e,t)),t+=2;for(i.idRangeOffset=n.readUshorts(e,t,u),t+=2*u,i.glyphIdArray=[];t<a+o;)i.glyphIdArray.push(n.readUshort(e,t)),t+=2;return i},r.cmap.parse6=function(e,t){var n=r._bin,a={};a.format=n.readUshort(e,t),t+=2;n.readUshort(e,t);t+=2;n.readUshort(e,t);t+=2,a.firstCode=n.readUshort(e,t),t+=2;var i=n.readUshort(e,t);t+=2,a.glyphIdArray=[];for(var o=0;o<i;o++)a.glyphIdArray.push(n.readUshort(e,t)),t+=2;return a},r.cmap.parse12=function(e,t){var n=r._bin,a={};a.format=n.readUshort(e,t),t+=2,t+=2;n.readUint(e,t);t+=4;n.readUint(e,t);t+=4;var i=n.readUint(e,t);t+=4,a.groups=[];for(var o=0;o<i;o++){var s=t+12*o,u=n.readUint(e,s+0),f=n.readUint(e,s+4),l=n.readUint(e,s+8);a.groups.push([u,f,l])}return a},r.glyf={},r.glyf.parse=function(e,r,t,n){for(var a=[],i=0;i<n.maxp.numGlyphs;i++)a.push(null);return a},r.glyf._parseGlyf=function(e,t){var n=r._bin,a=e._data,i=r._tabOffset(a,"glyf",e._offset)+e.loca[t];if(e.loca[t]==e.loca[t+1])return null;var o={};if(o.noc=n.readShort(a,i),i+=2,o.xMin=n.readShort(a,i),i+=2,o.yMin=n.readShort(a,i),i+=2,o.xMax=n.readShort(a,i),i+=2,o.yMax=n.readShort(a,i),i+=2,o.xMin>=o.xMax||o.yMin>=o.yMax)return null;if(o.noc>0){o.endPts=[];for(var s=0;s<o.noc;s++)o.endPts.push(n.readUshort(a,i)),i+=2;var u=n.readUshort(a,i);if(i+=2,a.length-i<u)return null;o.instructions=n.readBytes(a,i,u),i+=u;var f=o.endPts[o.noc-1]+1;o.flags=[];for(s=0;s<f;s++){var l=a[i];if(i++,o.flags.push(l),0!=(8&l)){var h=a[i];i++;for(var d=0;d<h;d++)o.flags.push(l),s++}}o.xs=[];for(s=0;s<f;s++){var c=0!=(2&o.flags[s]),p=0!=(16&o.flags[s]);c?(o.xs.push(p?a[i]:-a[i]),i++):p?o.xs.push(0):(o.xs.push(n.readShort(a,i)),i+=2)}o.ys=[];for(s=0;s<f;s++){c=0!=(4&o.flags[s]),p=0!=(32&o.flags[s]);c?(o.ys.push(p?a[i]:-a[i]),i++):p?o.ys.push(0):(o.ys.push(n.readShort(a,i)),i+=2)}var v=0,g=0;for(s=0;s<f;s++)v+=o.xs[s],g+=o.ys[s],o.xs[s]=v,o.ys[s]=g}else{var m;o.parts=[];do{m=n.readUshort(a,i),i+=2;var y={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(o.parts.push(y),y.glyphIndex=n.readUshort(a,i),i+=2,1&m){var U=n.readShort(a,i);i+=2;var S=n.readShort(a,i);i+=2}else{U=n.readInt8(a,i);i++;S=n.readInt8(a,i);i++}2&m?(y.m.tx=U,y.m.ty=S):(y.p1=U,y.p2=S),8&m?(y.m.a=y.m.d=n.readF2dot14(a,i),i+=2):64&m?(y.m.a=n.readF2dot14(a,i),i+=2,y.m.d=n.readF2dot14(a,i),i+=2):128&m&&(y.m.a=n.readF2dot14(a,i),i+=2,y.m.b=n.readF2dot14(a,i),i+=2,y.m.c=n.readF2dot14(a,i),i+=2,y.m.d=n.readF2dot14(a,i),i+=2)}while(32&m);if(256&m){var x=n.readUshort(a,i);i+=2,o.instr=[];for(s=0;s<x;s++)o.instr.push(a[i]),i++}}return o},r.GPOS={},r.GPOS.parse=function(e,t,n,a){return r._lctf.parse(e,t,n,a,r.GPOS.subt)},r.GPOS.subt=function(e,t,n){var a=r._bin,i=n,o={};if(o.fmt=a.readUshort(e,n),n+=2,1==t||2==t||3==t||7==t||8==t&&o.fmt<=2){var s=a.readUshort(e,n);n+=2,o.coverage=r._lctf.readCoverage(e,s+i)}if(1==t&&1==o.fmt){var u=a.readUshort(e,n);n+=2;var f=r._lctf.numOfOnes(u);0!=u&&(o.pos=r.GPOS.readValueRecord(e,n,u))}else if(2==t){u=a.readUshort(e,n);n+=2;var l=a.readUshort(e,n);n+=2;f=r._lctf.numOfOnes(u);var h=r._lctf.numOfOnes(l);if(1==o.fmt){o.pairsets=[];var d=a.readUshort(e,n);n+=2;for(var c=0;c<d;c++){var p=i+a.readUshort(e,n);n+=2;var v=a.readUshort(e,p);p+=2;for(var g=[],m=0;m<v;m++){var y=a.readUshort(e,p);p+=2,0!=u&&(w=r.GPOS.readValueRecord(e,p,u),p+=2*f),0!=l&&(F=r.GPOS.readValueRecord(e,p,l),p+=2*h),g.push({gid2:y,val1:w,val2:F})}o.pairsets.push(g)}}if(2==o.fmt){var U=a.readUshort(e,n);n+=2;var S=a.readUshort(e,n);n+=2;var x=a.readUshort(e,n);n+=2;var b=a.readUshort(e,n);n+=2,o.classDef1=r._lctf.readClassDef(e,i+U),o.classDef2=r._lctf.readClassDef(e,i+S),o.matrix=[];for(c=0;c<x;c++){var _=[];for(m=0;m<b;m++){var w=null,F=null;0!=o.valFmt1&&(w=r.GPOS.readValueRecord(e,n,o.valFmt1),n+=2*f),0!=o.valFmt2&&(F=r.GPOS.readValueRecord(e,n,o.valFmt2),n+=2*h),_.push({val1:w,val2:F})}o.matrix.push(_)}}}return o},r.GPOS.readValueRecord=function(e,t,n){var a=r._bin,i=[];return i.push(1&n?a.readShort(e,t):0),t+=1&n?2:0,i.push(2&n?a.readShort(e,t):0),t+=2&n?2:0,i.push(4&n?a.readShort(e,t):0),t+=4&n?2:0,i.push(8&n?a.readShort(e,t):0),t+=8&n?2:0,i},r.GSUB={},r.GSUB.parse=function(e,t,n,a){return r._lctf.parse(e,t,n,a,r.GSUB.subt)},r.GSUB.subt=function(e,t,n){var a=r._bin,i=n,o={};if(o.fmt=a.readUshort(e,n),n+=2,1!=t&&4!=t&&5!=t&&6!=t)return null;if(1==t||4==t||5==t&&o.fmt<=2||6==t&&o.fmt<=2){var s=a.readUshort(e,n);n+=2,o.coverage=r._lctf.readCoverage(e,i+s)}if(1==t){if(1==o.fmt)o.delta=a.readShort(e,n),n+=2;else if(2==o.fmt){var u=a.readUshort(e,n);n+=2,o.newg=a.readUshorts(e,n,u),n+=2*o.newg.length}}else if(4==t){o.vals=[];u=a.readUshort(e,n);n+=2;for(var f=0;f<u;f++){var l=a.readUshort(e,n);n+=2,o.vals.push(r.GSUB.readLigatureSet(e,i+l))}}else if(5==t){if(2==o.fmt){var h=a.readUshort(e,n);n+=2,o.cDef=r._lctf.readClassDef(e,i+h),o.scset=[];var d=a.readUshort(e,n);n+=2;for(f=0;f<d;f++){var c=a.readUshort(e,n);n+=2,o.scset.push(0==c?null:r.GSUB.readSubClassSet(e,i+c))}}}else if(6==t&&3==o.fmt){for(f=0;f<3;f++){u=a.readUshort(e,n);n+=2;for(var p=[],v=0;v<u;v++)p.push(r._lctf.readCoverage(e,i+a.readUshort(e,n+2*v)));n+=2*u,0==f&&(o.backCvg=p),1==f&&(o.inptCvg=p),2==f&&(o.ahedCvg=p)}u=a.readUshort(e,n);n+=2,o.lookupRec=r.GSUB.readSubstLookupRecords(e,n,u)}return o},r.GSUB.readSubClassSet=function(e,t){var n=r._bin.readUshort,a=t,i=[],o=n(e,t);t+=2;for(var s=0;s<o;s++){var u=n(e,t);t+=2,i.push(r.GSUB.readSubClassRule(e,a+u))}return i},r.GSUB.readSubClassRule=function(e,t){var n=r._bin.readUshort,a={},i=n(e,t),o=n(e,t+=2);t+=2,a.input=[];for(var s=0;s<i-1;s++)a.input.push(n(e,t)),t+=2;return a.substLookupRecords=r.GSUB.readSubstLookupRecords(e,t,o),a},r.GSUB.readSubstLookupRecords=function(e,t,n){for(var a=r._bin.readUshort,i=[],o=0;o<n;o++)i.push(a(e,t),a(e,t+2)),t+=4;return i},r.GSUB.readChainSubClassSet=function(e,t){var n=r._bin,a=t,i=[],o=n.readUshort(e,t);t+=2;for(var s=0;s<o;s++){var u=n.readUshort(e,t);t+=2,i.push(r.GSUB.readChainSubClassRule(e,a+u))}return i},r.GSUB.readChainSubClassRule=function(e,t){for(var n=r._bin,a={},i=["backtrack","input","lookahead"],o=0;o<i.length;o++){var s=n.readUshort(e,t);t+=2,1==o&&s--,a[i[o]]=n.readUshorts(e,t,s),t+=2*a[i[o]].length}s=n.readUshort(e,t);return t+=2,a.subst=n.readUshorts(e,t,2*s),t+=2*a.subst.length,a},r.GSUB.readLigatureSet=function(e,t){var n=r._bin,a=t,i=[],o=n.readUshort(e,t);t+=2;for(var s=0;s<o;s++){var u=n.readUshort(e,t);t+=2,i.push(r.GSUB.readLigature(e,a+u))}return i},r.GSUB.readLigature=function(e,t){var n=r._bin,a={chain:[]};a.nglyph=n.readUshort(e,t),t+=2;var i=n.readUshort(e,t);t+=2;for(var o=0;o<i-1;o++)a.chain.push(n.readUshort(e,t)),t+=2;return a},r.head={},r.head.parse=function(e,t,n){var a=r._bin,i={};a.readFixed(e,t);t+=4,i.fontRevision=a.readFixed(e,t),t+=4;a.readUint(e,t);t+=4;a.readUint(e,t);return t+=4,i.flags=a.readUshort(e,t),t+=2,i.unitsPerEm=a.readUshort(e,t),t+=2,i.created=a.readUint64(e,t),t+=8,i.modified=a.readUint64(e,t),t+=8,i.xMin=a.readShort(e,t),t+=2,i.yMin=a.readShort(e,t),t+=2,i.xMax=a.readShort(e,t),t+=2,i.yMax=a.readShort(e,t),t+=2,i.macStyle=a.readUshort(e,t),t+=2,i.lowestRecPPEM=a.readUshort(e,t),t+=2,i.fontDirectionHint=a.readShort(e,t),t+=2,i.indexToLocFormat=a.readShort(e,t),t+=2,i.glyphDataFormat=a.readShort(e,t),t+=2,i},r.hhea={},r.hhea.parse=function(e,t,n){var a=r._bin,i={};a.readFixed(e,t);return t+=4,i.ascender=a.readShort(e,t),t+=2,i.descender=a.readShort(e,t),t+=2,i.lineGap=a.readShort(e,t),t+=2,i.advanceWidthMax=a.readUshort(e,t),t+=2,i.minLeftSideBearing=a.readShort(e,t),t+=2,i.minRightSideBearing=a.readShort(e,t),t+=2,i.xMaxExtent=a.readShort(e,t),t+=2,i.caretSlopeRise=a.readShort(e,t),t+=2,i.caretSlopeRun=a.readShort(e,t),t+=2,i.caretOffset=a.readShort(e,t),t+=2,t+=8,i.metricDataFormat=a.readShort(e,t),t+=2,i.numberOfHMetrics=a.readUshort(e,t),t+=2,i},r.hmtx={},r.hmtx.parse=function(e,t,n,a){for(var i=r._bin,o={aWidth:[],lsBearing:[]},s=0,u=0,f=0;f<a.maxp.numGlyphs;f++)f<a.hhea.numberOfHMetrics&&(s=i.readUshort(e,t),t+=2,u=i.readShort(e,t),t+=2),o.aWidth.push(s),o.lsBearing.push(u);return o},r.kern={},r.kern.parse=function(e,t,n,a){var i=r._bin,o=i.readUshort(e,t);if(t+=2,1==o)return r.kern.parseV1(e,t-2,n,a);var s=i.readUshort(e,t);t+=2;for(var u={glyph1:[],rval:[]},f=0;f<s;f++){t+=2;n=i.readUshort(e,t);t+=2;var l=i.readUshort(e,t);t+=2;var h=l>>>8;if(0!=(h&=15))throw"unknown kern table format: "+h;t=r.kern.readFormat0(e,t,u)}return u},r.kern.parseV1=function(e,t,n,a){var i=r._bin;i.readFixed(e,t);t+=4;var o=i.readUint(e,t);t+=4;for(var s={glyph1:[],rval:[]},u=0;u<o;u++){i.readUint(e,t);t+=4;var f=i.readUshort(e,t);t+=2;i.readUshort(e,t);t+=2;var l=f>>>8;if(0!=(l&=15))throw"unknown kern table format: "+l;t=r.kern.readFormat0(e,t,s)}return s},r.kern.readFormat0=function(e,t,n){var a=r._bin,i=-1,o=a.readUshort(e,t);t+=2;a.readUshort(e,t);t+=2;a.readUshort(e,t);t+=2;a.readUshort(e,t);t+=2;for(var s=0;s<o;s++){var u=a.readUshort(e,t);t+=2;var f=a.readUshort(e,t);t+=2;var l=a.readShort(e,t);t+=2,u!=i&&(n.glyph1.push(u),n.rval.push({glyph2:[],vals:[]}));var h=n.rval[n.rval.length-1];h.glyph2.push(f),h.vals.push(l),i=u}return t},r.loca={},r.loca.parse=function(e,t,n,a){var i=r._bin,o=[],s=a.head.indexToLocFormat,u=a.maxp.numGlyphs+1;if(0==s)for(var f=0;f<u;f++)o.push(i.readUshort(e,t+(f<<1))<<1);if(1==s)for(f=0;f<u;f++)o.push(i.readUint(e,t+(f<<2)));return o},r.maxp={},r.maxp.parse=function(e,t,n){var a=r._bin,i={},o=a.readUint(e,t);return t+=4,i.numGlyphs=a.readUshort(e,t),t+=2,65536==o&&(i.maxPoints=a.readUshort(e,t),t+=2,i.maxContours=a.readUshort(e,t),t+=2,i.maxCompositePoints=a.readUshort(e,t),t+=2,i.maxCompositeContours=a.readUshort(e,t),t+=2,i.maxZones=a.readUshort(e,t),t+=2,i.maxTwilightPoints=a.readUshort(e,t),t+=2,i.maxStorage=a.readUshort(e,t),t+=2,i.maxFunctionDefs=a.readUshort(e,t),t+=2,i.maxInstructionDefs=a.readUshort(e,t),t+=2,i.maxStackElements=a.readUshort(e,t),t+=2,i.maxSizeOfInstructions=a.readUshort(e,t),t+=2,i.maxComponentElements=a.readUshort(e,t),t+=2,i.maxComponentDepth=a.readUshort(e,t),t+=2),i},r.name={},r.name.parse=function(e,t,n){var a=r._bin,i={};a.readUshort(e,t);t+=2;var o=a.readUshort(e,t);t+=2;a.readUshort(e,t);for(var s,u=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],f=t+=2,l=0;l<o;l++){var h=a.readUshort(e,t);t+=2;var d=a.readUshort(e,t);t+=2;var c=a.readUshort(e,t);t+=2;var p=a.readUshort(e,t);t+=2;var v=a.readUshort(e,t);t+=2;var g=a.readUshort(e,t);t+=2;var m,y=u[p],U=f+12*o+g;if(0==h)m=a.readUnicode(e,U,v/2);else if(3==h&&0==d)m=a.readUnicode(e,U,v/2);else if(0==d)m=a.readASCII(e,U,v);else if(1==d)m=a.readUnicode(e,U,v/2);else if(3==d)m=a.readUnicode(e,U,v/2);else{if(1!=h)throw"unknown encoding "+d+", platformID: "+h;m=a.readASCII(e,U,v),console.log("reading unknown MAC encoding "+d+" as ASCII")}var S="p"+h+","+c.toString(16);null==i[S]&&(i[S]={}),i[S][y]=m,i[S]._lang=c}for(var x in i)if(null!=i[x].postScriptName&&1033==i[x]._lang)return i[x];for(var x in i)if(null!=i[x].postScriptName&&0==i[x]._lang)return i[x];for(var x in i)if(null!=i[x].postScriptName&&3084==i[x]._lang)return i[x];for(var x in i)if(null!=i[x].postScriptName)return i[x];for(var x in i){s=x;break}return console.log("returning name table with languageID "+i[s]._lang),i[s]},r["OS/2"]={},r["OS/2"].parse=function(e,t,n){var a=r._bin.readUshort(e,t);t+=2;var i={};if(0==a)r["OS/2"].version0(e,t,i);else if(1==a)r["OS/2"].version1(e,t,i);else if(2==a||3==a||4==a)r["OS/2"].version2(e,t,i);else{if(5!=a)throw"unknown OS/2 table version: "+a;r["OS/2"].version5(e,t,i)}return i},r["OS/2"].version0=function(e,t,n){var a=r._bin;return n.xAvgCharWidth=a.readShort(e,t),t+=2,n.usWeightClass=a.readUshort(e,t),t+=2,n.usWidthClass=a.readUshort(e,t),t+=2,n.fsType=a.readUshort(e,t),t+=2,n.ySubscriptXSize=a.readShort(e,t),t+=2,n.ySubscriptYSize=a.readShort(e,t),t+=2,n.ySubscriptXOffset=a.readShort(e,t),t+=2,n.ySubscriptYOffset=a.readShort(e,t),t+=2,n.ySuperscriptXSize=a.readShort(e,t),t+=2,n.ySuperscriptYSize=a.readShort(e,t),t+=2,n.ySuperscriptXOffset=a.readShort(e,t),t+=2,n.ySuperscriptYOffset=a.readShort(e,t),t+=2,n.yStrikeoutSize=a.readShort(e,t),t+=2,n.yStrikeoutPosition=a.readShort(e,t),t+=2,n.sFamilyClass=a.readShort(e,t),t+=2,n.panose=a.readBytes(e,t,10),t+=10,n.ulUnicodeRange1=a.readUint(e,t),t+=4,n.ulUnicodeRange2=a.readUint(e,t),t+=4,n.ulUnicodeRange3=a.readUint(e,t),t+=4,n.ulUnicodeRange4=a.readUint(e,t),t+=4,n.achVendID=[a.readInt8(e,t),a.readInt8(e,t+1),a.readInt8(e,t+2),a.readInt8(e,t+3)],t+=4,n.fsSelection=a.readUshort(e,t),t+=2,n.usFirstCharIndex=a.readUshort(e,t),t+=2,n.usLastCharIndex=a.readUshort(e,t),t+=2,n.sTypoAscender=a.readShort(e,t),t+=2,n.sTypoDescender=a.readShort(e,t),t+=2,n.sTypoLineGap=a.readShort(e,t),t+=2,n.usWinAscent=a.readUshort(e,t),t+=2,n.usWinDescent=a.readUshort(e,t),t+=2},r["OS/2"].version1=function(e,t,n){var a=r._bin;return t=r["OS/2"].version0(e,t,n),n.ulCodePageRange1=a.readUint(e,t),t+=4,n.ulCodePageRange2=a.readUint(e,t),t+=4},r["OS/2"].version2=function(e,t,n){var a=r._bin;return t=r["OS/2"].version1(e,t,n),n.sxHeight=a.readShort(e,t),t+=2,n.sCapHeight=a.readShort(e,t),t+=2,n.usDefault=a.readUshort(e,t),t+=2,n.usBreak=a.readUshort(e,t),t+=2,n.usMaxContext=a.readUshort(e,t),t+=2},r["OS/2"].version5=function(e,t,n){var a=r._bin;return t=r["OS/2"].version2(e,t,n),n.usLowerOpticalPointSize=a.readUshort(e,t),t+=2,n.usUpperOpticalPointSize=a.readUshort(e,t),t+=2},r.post={},r.post.parse=function(e,t,n){var a=r._bin,i={};return i.version=a.readFixed(e,t),t+=4,i.italicAngle=a.readFixed(e,t),t+=4,i.underlinePosition=a.readShort(e,t),t+=2,i.underlineThickness=a.readShort(e,t),t+=2,i},r.SVG={},r.SVG.parse=function(e,t,n){var a=r._bin,i={entries:[]},o=t;a.readUshort(e,t);t+=2;var s=a.readUint(e,t);t+=4;a.readUint(e,t);t+=4,t=s+o;var u=a.readUshort(e,t);t+=2;for(var f=0;f<u;f++){var l=a.readUshort(e,t);t+=2;var h=a.readUshort(e,t);t+=2;var d=a.readUint(e,t);t+=4;var c=a.readUint(e,t);t+=4;for(var p=new Uint8Array(e.buffer,o+d+s,c),v=a.readUTF8(p,0,p.length),g=l;g<=h;g++)i.entries[g]=v}return i},r.SVG.toPath=function(e){var t={cmds:[],crds:[]};if(null==e)return t;for(var n=(new DOMParser).parseFromString(e,"image/svg+xml").firstChild;"svg"!=n.tagName;)n=n.nextSibling;var a=n.getAttribute("viewBox");a=a?a.trim().split(" ").map(parseFloat):[0,0,1e3,1e3],r.SVG._toPath(n.children,t);for(var i=0;i<t.crds.length;i+=2){var o=t.crds[i],s=t.crds[i+1];o-=a[0],s=-(s-=a[1]),t.crds[i]=o,t.crds[i+1]=s}return t},r.SVG._toPath=function(e,t,n){for(var a=0;a<e.length;a++){var i=e[a],o=i.tagName,s=i.getAttribute("fill");if(null==s&&(s=n),"g"==o)r.SVG._toPath(i.children,t,s);else if("path"==o){t.cmds.push(s||"#000000");var u=i.getAttribute("d"),f=r.SVG._tokens(u);r.SVG._toksToPath(f,t),t.cmds.push("X")}else"defs"==o||console.log(o,i)}},r.SVG._tokens=function(e){for(var r=[],t=0,n=!1,a="";t<e.length;){var i=e.charCodeAt(t),o=e.charAt(t);t++;var s=48<=i&&i<=57||"."==o||"-"==o;n?"-"==o?(r.push(parseFloat(a)),a=o):s?a+=o:(r.push(parseFloat(a)),","!=o&&" "!=o&&r.push(o),n=!1):s?(a=o,n=!0):","!=o&&" "!=o&&r.push(o)}return n&&r.push(parseFloat(a)),r},r.SVG._toksToPath=function(e,t){for(var n=0,a=0,i=0,o=0,s=0,u={M:2,L:2,H:1,V:1,S:4,C:6},f=t.cmds,l=t.crds;n<e.length;){var h=e[n];if(n++,"z"==h)f.push("Z"),a=o,i=s;else for(var d=h.toUpperCase(),c=u[d],p=r.SVG._reps(e,n,c),v=0;v<p;v++){var g=0,m=0;if(h!=d&&(g=a,m=i),"M"==d)a=g+e[n++],i=m+e[n++],f.push("M"),l.push(a,i),o=a,s=i;else if("L"==d)a=g+e[n++],i=m+e[n++],f.push("L"),l.push(a,i);else if("H"==d)a=g+e[n++],f.push("L"),l.push(a,i);else if("V"==d)i=m+e[n++],f.push("L"),l.push(a,i);else if("C"==d){var y=g+e[n++],U=m+e[n++],S=g+e[n++],x=m+e[n++],b=g+e[n++],_=m+e[n++];f.push("C"),l.push(y,U,S,x,b,_),a=b,i=_}else if("S"==d){var w=Math.max(l.length-4,0);y=a+a-l[w],U=i+i-l[w+1],S=g+e[n++],x=m+e[n++],b=g+e[n++],_=m+e[n++];f.push("C"),l.push(y,U,S,x,b,_),a=b,i=_}else console.log("Unknown SVG command "+h)}}},r.SVG._reps=function(e,r,t){for(var n=r;n<e.length&&"string"!=typeof e[n];)n+=t;return(n-r)/t},null==r&&(r={}),null==r.U&&(r.U={}),r.U.codeToGlyph=function(e,r){var t=e.cmap,n=-1;if(null!=t.p0e4?n=t.p0e4:null!=t.p3e1?n=t.p3e1:null!=t.p1e0?n=t.p1e0:null!=t.p0e3&&(n=t.p0e3),-1==n)throw"no familiar platform and encoding!";var a=t.tables[n];if(0==a.format)return r>=a.map.length?0:a.map[r];if(4==a.format){for(var i=-1,o=0;o<a.endCount.length;o++)if(r<=a.endCount[o]){i=o;break}if(-1==i)return 0;if(a.startCount[i]>r)return 0;return 65535&(0!=a.idRangeOffset[i]?a.glyphIdArray[r-a.startCount[i]+(a.idRangeOffset[i]>>1)-(a.idRangeOffset.length-i)]:r+a.idDelta[i])}if(12==a.format){if(r>a.groups[a.groups.length-1][1])return 0;for(o=0;o<a.groups.length;o++){var s=a.groups[o];if(s[0]<=r&&r<=s[1])return s[2]+(r-s[0])}return 0}throw"unknown cmap table format "+a.format},r.U.glyphToPath=function(e,t){var n={cmds:[],crds:[]};if(e.SVG&&e.SVG.entries[t]){var a=e.SVG.entries[t];return null==a?n:("string"==typeof a&&(a=r.SVG.toPath(a),e.SVG.entries[t]=a),a)}if(e.CFF){var i={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:e.CFF.Private?e.CFF.Private.defaultWidthX:0,open:!1},o=e.CFF,s=e.CFF.Private;if(o.ROS){for(var u=0;o.FDSelect[u+2]<=t;)u+=2;s=o.FDArray[o.FDSelect[u+1]].Private}r.U._drawCFF(e.CFF.CharStrings[t],i,o,s,n)}else e.glyf&&r.U._drawGlyf(t,e,n);return n},r.U._drawGlyf=function(e,t,n){var a=t.glyf[e];null==a&&(a=t.glyf[e]=r.glyf._parseGlyf(t,e)),null!=a&&(a.noc>-1?r.U._simpleGlyph(a,n):r.U._compoGlyph(a,t,n))},r.U._simpleGlyph=function(e,t){for(var n=0;n<e.noc;n++){for(var a=0==n?0:e.endPts[n-1]+1,i=e.endPts[n],o=a;o<=i;o++){var s=o==a?i:o-1,u=o==i?a:o+1,f=1&e.flags[o],l=1&e.flags[s],h=1&e.flags[u],d=e.xs[o],c=e.ys[o];if(o==a)if(f){if(!l){r.U.P.moveTo(t,d,c);continue}r.U.P.moveTo(t,e.xs[s],e.ys[s])}else l?r.U.P.moveTo(t,e.xs[s],e.ys[s]):r.U.P.moveTo(t,(e.xs[s]+d)/2,(e.ys[s]+c)/2);f?l&&r.U.P.lineTo(t,d,c):h?r.U.P.qcurveTo(t,d,c,e.xs[u],e.ys[u]):r.U.P.qcurveTo(t,d,c,(d+e.xs[u])/2,(c+e.ys[u])/2)}r.U.P.closePath(t)}},r.U._compoGlyph=function(e,t,n){for(var a=0;a<e.parts.length;a++){var i={cmds:[],crds:[]},o=e.parts[a];r.U._drawGlyf(o.glyphIndex,t,i);for(var s=o.m,u=0;u<i.crds.length;u+=2){var f=i.crds[u],l=i.crds[u+1];n.crds.push(f*s.a+l*s.b+s.tx),n.crds.push(f*s.c+l*s.d+s.ty)}for(u=0;u<i.cmds.length;u++)n.cmds.push(i.cmds[u])}},r.U._getGlyphClass=function(e,t){var n=r._lctf.getInterval(t,e);return-1==n?0:t[n+2]},r.U.getPairAdjustment=function(e,t,n){if(e.GPOS)for(var a=e.GPOS,i=a.lookupList,o=a.featureList,s=[],u=0;u<o.length;u++){var f=o[u];if("kern"==f.tag)for(var l=0;l<f.tab.length;l++)if(!s[f.tab[l]]){s[f.tab[l]]=!0;for(var h=i[f.tab[l]],d=0;d<h.tabs.length;d++)if(null!=h.tabs[u]){var c,p=h.tabs[d];if(!p.coverage||-1!=(c=r._lctf.coverageIndex(p.coverage,t)))if(1==h.ltype);else if(2==h.ltype){var v;if(1==p.fmt){var g=p.pairsets[c];for(u=0;u<g.length;u++)g[u].gid2==n&&(v=g[u])}else if(2==p.fmt){var m=r.U._getGlyphClass(t,p.classDef1),y=r.U._getGlyphClass(n,p.classDef2);v=p.matrix[m][y]}if(v&&v.val2)return v.val2[2]}}}}if(e.kern){var U=e.kern.glyph1.indexOf(t);if(-1!=U){var S=e.kern.rval[U].glyph2.indexOf(n);if(-1!=S)return e.kern.rval[U].vals[S]}}return 0},r.U.stringToGlyphs=function(e,t){for(var n=[],a=0;a<t.length;a++){(i=t.codePointAt(a))>65535&&a++,n.push(r.U.codeToGlyph(e,i))}for(a=0;a<t.length;a++){var i;if(2367==(i=t.codePointAt(a))){var o=n[a-1];n[a-1]=n[a],n[a]=o}i>65535&&a++}var s=e.GSUB;if(null==s)return n;for(var u=s.lookupList,f=s.featureList,l=["rlig","liga","mset","isol","init","fina","medi","half","pres","blws"],h=[],d=0;d<f.length;d++){var c=f[d];if(-1!=l.indexOf(c.tag))for(var p=0;p<c.tab.length;p++)if(!h[c.tab[p]]){h[c.tab[p]]=!0;for(var v=u[c.tab[p]],g=0;g<n.length;g++){var m=r.U._getWPfeature(t,g);-1!="isol,init,fina,medi".indexOf(c.tag)&&c.tag!=m||r.U._applySubs(n,g,v,u)}}}return n},r.U._getWPfeature=function(e,r){var t='\n\t" ,.:;!?()  ،',n="آأؤإاةدذرزوٱٲٳٵٶٷڈډڊڋڌڍڎڏڐڑڒړڔڕږڗژڙۀۃۄۅۆۇۈۉۊۋۍۏےۓەۮۯܐܕܖܗܘܙܞܨܪܬܯݍݙݚݛݫݬݱݳݴݸݹࡀࡆࡇࡉࡔࡧࡩࡪࢪࢫࢬࢮࢱࢲࢹૅેૉ૊૎૏ૐ૑૒૝ૡ૤૯஁ஃ஄அஉ஌எஏ஑னப஫஬",a=0==r||-1!=t.indexOf(e[r-1]),i=r==e.length-1||-1!=t.indexOf(e[r+1]);a||-1==n.indexOf(e[r-1])||(a=!0),i||-1==n.indexOf(e[r])||(i=!0),i||-1=="ꡲ્૗".indexOf(e[r+1])||(i=!0),a||-1=="ꡲ્૗".indexOf(e[r])||(a=!0);return a?i?"isol":"init":i?"fina":"medi"},r.U._applySubs=function(e,t,n,a){for(var i=e.length-t-1,o=0;o<n.tabs.length;o++)if(null!=n.tabs[o]){var s,u=n.tabs[o];if(!u.coverage||-1!=(s=r._lctf.coverageIndex(u.coverage,e[t])))if(1==n.ltype){e[t];1==u.fmt?e[t]=e[t]+u.delta:e[t]=u.newg[s]}else if(4==n.ltype)for(var f=u.vals[s],l=0;l<f.length;l++){var h=f[l],d=h.chain.length;if(!(d>i)){for(var c=!0,p=0,v=0;v<d;v++){for(;-1==e[t+p+(1+v)];)p++;h.chain[v]!=e[t+p+(1+v)]&&(c=!1)}if(c){e[t]=h.nglyph;for(v=0;v<d+p;v++)e[t+v+1]=-1;break}}}else if(5==n.ltype&&2==u.fmt)for(var g=r._lctf.getInterval(u.cDef,e[t]),m=u.cDef[g+2],y=u.scset[m],U=0;U<y.length;U++){var S=y[U],x=S.input;if(!(x.length>i)){for(c=!0,v=0;v<x.length;v++){var b=r._lctf.getInterval(u.cDef,e[t+1+v]);if(-1==g&&u.cDef[b+2]!=x[v]){c=!1;break}}if(c){var _=S.substLookupRecords;for(l=0;l<_.length;l+=2)_[l],_[l+1]}}}else if(6==n.ltype&&3==u.fmt){if(!r.U._glsCovered(e,u.backCvg,t-u.backCvg.length))continue;if(!r.U._glsCovered(e,u.inptCvg,t))continue;if(!r.U._glsCovered(e,u.ahedCvg,t+u.inptCvg.length))continue;var w=u.lookupRec;for(U=0;U<w.length;U+=2){g=w[U];var F=a[w[U+1]];r.U._applySubs(e,t+g,F,a)}}}},r.U._glsCovered=function(e,t,n){for(var a=0;a<t.length;a++){if(-1==r._lctf.coverageIndex(t[a],e[n+a]))return!1}return!0},r.U.glyphsToPath=function(e,t,n){for(var a={cmds:[],crds:[]},i=0,o=0;o<t.length;o++){var s=t[o];if(-1!=s){for(var u=o<t.length-1&&-1!=t[o+1]?t[o+1]:0,f=r.U.glyphToPath(e,s),l=0;l<f.crds.length;l+=2)a.crds.push(f.crds[l]+i),a.crds.push(f.crds[l+1]);n&&a.cmds.push(n);for(l=0;l<f.cmds.length;l++)a.cmds.push(f.cmds[l]);n&&a.cmds.push("X"),i+=e.hmtx.aWidth[s],o<t.length-1&&(i+=r.U.getPairAdjustment(e,s,u))}}return a},r.U.pathToSVG=function(e,r){null==r&&(r=5);for(var t=[],n=0,a={M:2,L:2,Q:4,C:6},i=0;i<e.cmds.length;i++){var o=e.cmds[i],s=n+(a[o]?a[o]:0);for(t.push(o);n<s;){var u=e.crds[n++];t.push(parseFloat(u.toFixed(r))+(n==s?"":" "))}}return t.join("")},r.U.pathToContext=function(e,r){for(var t=0,n=e.crds,a=0;a<e.cmds.length;a++){var i=e.cmds[a];"M"==i?(r.moveTo(n[t],n[t+1]),t+=2):"L"==i?(r.lineTo(n[t],n[t+1]),t+=2):"C"==i?(r.bezierCurveTo(n[t],n[t+1],n[t+2],n[t+3],n[t+4],n[t+5]),t+=6):"Q"==i?(r.quadraticCurveTo(n[t],n[t+1],n[t+2],n[t+3]),t+=4):"#"==i.charAt(0)?(r.beginPath(),r.fillStyle=i):"Z"==i?r.closePath():"X"==i&&r.fill()}},r.U.P={},r.U.P.moveTo=function(e,r,t){e.cmds.push("M"),e.crds.push(r,t)},r.U.P.lineTo=function(e,r,t){e.cmds.push("L"),e.crds.push(r,t)},r.U.P.curveTo=function(e,r,t,n,a,i,o){e.cmds.push("C"),e.crds.push(r,t,n,a,i,o)},r.U.P.qcurveTo=function(e,r,t,n,a){e.cmds.push("Q"),e.crds.push(r,t,n,a)},r.U.P.closePath=function(e){e.cmds.push("Z")},r.U._drawCFF=function(e,t,n,a,i){for(var o=t.stack,s=t.nStems,u=t.haveWidth,f=t.width,l=t.open,h=0,d=t.x,c=t.y,p=0,v=0,g=0,m=0,y=0,U=0,S=0,x=0,b=0,_=0,w={val:0,size:0};h<e.length;){r.CFF.getCharString(e,h,w);var F=w.val;if(h+=w.size,"o1"==F||"o18"==F)o.length%2!=0&&!u&&(f=o.shift()+a.nominalWidthX),s+=o.length>>1,o.length=0,u=!0;else if("o3"==F||"o23"==F){o.length%2!=0&&!u&&(f=o.shift()+a.nominalWidthX),s+=o.length>>1,o.length=0,u=!0}else if("o4"==F)o.length>1&&!u&&(f=o.shift()+a.nominalWidthX,u=!0),l&&r.U.P.closePath(i),c+=o.pop(),r.U.P.moveTo(i,d,c),l=!0;else if("o5"==F)for(;o.length>0;)d+=o.shift(),c+=o.shift(),r.U.P.lineTo(i,d,c);else if("o6"==F||"o7"==F)for(var k=o.length,C="o6"==F,T=0;T<k;T++){var M=o.shift();C?d+=M:c+=M,C=!C,r.U.P.lineTo(i,d,c)}else if("o8"==F||"o24"==F){k=o.length;for(var D=0;D+6<=k;)p=d+o.shift(),v=c+o.shift(),g=p+o.shift(),m=v+o.shift(),d=g+o.shift(),c=m+o.shift(),r.U.P.curveTo(i,p,v,g,m,d,c),D+=6;"o24"==F&&(d+=o.shift(),c+=o.shift(),r.U.P.lineTo(i,d,c))}else{if("o11"==F)break;if("o1234"==F||"o1235"==F||"o1236"==F||"o1237"==F)"o1234"==F&&(v=c,g=(p=d+o.shift())+o.shift(),_=m=v+o.shift(),U=m,x=c,d=(S=(y=(b=g+o.shift())+o.shift())+o.shift())+o.shift(),r.U.P.curveTo(i,p,v,g,m,b,_),r.U.P.curveTo(i,y,U,S,x,d,c)),"o1235"==F&&(p=d+o.shift(),v=c+o.shift(),g=p+o.shift(),m=v+o.shift(),b=g+o.shift(),_=m+o.shift(),y=b+o.shift(),U=_+o.shift(),S=y+o.shift(),x=U+o.shift(),d=S+o.shift(),c=x+o.shift(),o.shift(),r.U.P.curveTo(i,p,v,g,m,b,_),r.U.P.curveTo(i,y,U,S,x,d,c)),"o1236"==F&&(p=d+o.shift(),v=c+o.shift(),g=p+o.shift(),_=m=v+o.shift(),U=m,S=(y=(b=g+o.shift())+o.shift())+o.shift(),x=U+o.shift(),d=S+o.shift(),r.U.P.curveTo(i,p,v,g,m,b,_),r.U.P.curveTo(i,y,U,S,x,d,c)),"o1237"==F&&(p=d+o.shift(),v=c+o.shift(),g=p+o.shift(),m=v+o.shift(),b=g+o.shift(),_=m+o.shift(),y=b+o.shift(),U=_+o.shift(),S=y+o.shift(),x=U+o.shift(),Math.abs(S-d)>Math.abs(x-c)?d=S+o.shift():c=x+o.shift(),r.U.P.curveTo(i,p,v,g,m,b,_),r.U.P.curveTo(i,y,U,S,x,d,c));else if("o14"==F){if(o.length>0&&!u&&(f=o.shift()+n.nominalWidthX,u=!0),4==o.length){var P=o.shift(),I=o.shift(),A=o.shift(),O=o.shift(),B=r.CFF.glyphBySE(n,A),G=r.CFF.glyphBySE(n,O);r.U._drawCFF(n.CharStrings[B],t,n,a,i),t.x=P,t.y=I,r.U._drawCFF(n.CharStrings[G],t,n,a,i)}l&&(r.U.P.closePath(i),l=!1)}else if("o19"==F||"o20"==F){o.length%2!=0&&!u&&(f=o.shift()+a.nominalWidthX),s+=o.length>>1,o.length=0,u=!0,h+=s+7>>3}else if("o21"==F)o.length>2&&!u&&(f=o.shift()+a.nominalWidthX,u=!0),c+=o.pop(),d+=o.pop(),l&&r.U.P.closePath(i),r.U.P.moveTo(i,d,c),l=!0;else if("o22"==F)o.length>1&&!u&&(f=o.shift()+a.nominalWidthX,u=!0),d+=o.pop(),l&&r.U.P.closePath(i),r.U.P.moveTo(i,d,c),l=!0;else if("o25"==F){for(;o.length>6;)d+=o.shift(),c+=o.shift(),r.U.P.lineTo(i,d,c);p=d+o.shift(),v=c+o.shift(),g=p+o.shift(),m=v+o.shift(),d=g+o.shift(),c=m+o.shift(),r.U.P.curveTo(i,p,v,g,m,d,c)}else if("o26"==F)for(o.length%2&&(d+=o.shift());o.length>0;)p=d,v=c+o.shift(),d=g=p+o.shift(),c=(m=v+o.shift())+o.shift(),r.U.P.curveTo(i,p,v,g,m,d,c);else if("o27"==F)for(o.length%2&&(c+=o.shift());o.length>0;)v=c,g=(p=d+o.shift())+o.shift(),m=v+o.shift(),d=g+o.shift(),c=m,r.U.P.curveTo(i,p,v,g,m,d,c);else if("o10"==F||"o29"==F){var L="o10"==F?a:n;if(0==o.length)console.log("error: empty stack");else{var z=o.pop(),E=L.Subrs[z+L.Bias];t.x=d,t.y=c,t.nStems=s,t.haveWidth=u,t.width=f,t.open=l,r.U._drawCFF(E,t,n,a,i),d=t.x,c=t.y,s=t.nStems,u=t.haveWidth,f=t.width,l=t.open}}else if("o30"==F||"o31"==F){var V=o.length,R=(D=0,"o31"==F);for(D+=V-(k=-3&V);D<k;)R?(v=c,g=(p=d+o.shift())+o.shift(),c=(m=v+o.shift())+o.shift(),k-D==5?(d=g+o.shift(),D++):d=g,R=!1):(p=d,v=c+o.shift(),g=p+o.shift(),m=v+o.shift(),d=g+o.shift(),k-D==5?(c=m+o.shift(),D++):c=m,R=!0),r.U.P.curveTo(i,p,v,g,m,d,c),D+=4}else{if("o"==(F+"").charAt(0))throw console.log("Unknown operation: "+F,e),F;o.push(F)}}}t.x=d,t.y=c,t.nStems=s,t.haveWidth=u,t.width=f,t.open=l},r},function(){var e=function(){var e={},r=0,t=-3;function n(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function a(e,r){this.source=e,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=r,this.destLen=0,this.ltree=new n,this.dtree=new n}var i=new n,o=new n,s=new Uint8Array(30),u=new Uint16Array(30),f=new Uint8Array(30),l=new Uint16Array(30),h=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),d=new n,c=new Uint8Array(320);function p(e,r,t,n){var a,i;for(a=0;a<t;++a)e[a]=0;for(a=0;a<30-t;++a)e[a+t]=a/t|0;for(i=n,a=0;a<30;++a)r[a]=i,i+=1<<e[a]}var v=new Uint16Array(16);function g(e,r,t,n){var a,i;for(a=0;a<16;++a)e.table[a]=0;for(a=0;a<n;++a)e.table[r[t+a]]++;for(e.table[0]=0,i=0,a=0;a<16;++a)v[a]=i,i+=e.table[a];for(a=0;a<n;++a)r[t+a]&&(e.trans[v[r[t+a]]++]=a)}function m(e){e.bitcount--||(e.tag=e.source[e.sourceIndex++],e.bitcount=7);var r=1&e.tag;return e.tag>>>=1,r}function y(e,r,t){if(!r)return t;for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var n=e.tag&65535>>>16-r;return e.tag>>>=r,e.bitcount-=r,n+t}function U(e,r){for(;e.bitcount<24;)e.tag|=e.source[e.sourceIndex++]<<e.bitcount,e.bitcount+=8;var t=0,n=0,a=0,i=e.tag;do{n=2*n+(1&i),i>>>=1,++a,t+=r.table[a],n-=r.table[a]}while(n>=0);return e.tag=i,e.bitcount-=a,r.trans[t+n]}function S(e,r,t){var n,a,i,o,s,u;for(n=y(e,5,257),a=y(e,5,1),i=y(e,4,4),o=0;o<19;++o)c[o]=0;for(o=0;o<i;++o){var f=y(e,3,0);c[h[o]]=f}for(g(d,c,0,19),s=0;s<n+a;){var l=U(e,d);switch(l){case 16:var p=c[s-1];for(u=y(e,2,3);u;--u)c[s++]=p;break;case 17:for(u=y(e,3,3);u;--u)c[s++]=0;break;case 18:for(u=y(e,7,11);u;--u)c[s++]=0;break;default:c[s++]=l}}g(r,c,0,n),g(t,c,n,a)}function x(e,t,n){for(;;){var a,i,o,h,d=U(e,t);if(256===d)return r;if(d<256)e.dest[e.destLen++]=d;else for(a=y(e,s[d-=257],u[d]),i=U(e,n),h=o=e.destLen-y(e,f[i],l[i]);h<o+a;++h)e.dest[e.destLen++]=e.dest[h]}}function b(e){for(var n,a;e.bitcount>8;)e.sourceIndex--,e.bitcount-=8;if((n=256*(n=e.source[e.sourceIndex+1])+e.source[e.sourceIndex])!==(65535&~(256*e.source[e.sourceIndex+3]+e.source[e.sourceIndex+2])))return t;for(e.sourceIndex+=4,a=n;a;--a)e.dest[e.destLen++]=e.source[e.sourceIndex++];return e.bitcount=0,r}return function(e,r){var t;for(t=0;t<7;++t)e.table[t]=0;for(e.table[7]=24,e.table[8]=152,e.table[9]=112,t=0;t<24;++t)e.trans[t]=256+t;for(t=0;t<144;++t)e.trans[24+t]=t;for(t=0;t<8;++t)e.trans[168+t]=280+t;for(t=0;t<112;++t)e.trans[176+t]=144+t;for(t=0;t<5;++t)r.table[t]=0;for(r.table[5]=32,t=0;t<32;++t)r.trans[t]=t}(i,o),p(s,u,4,3),p(f,l,2,1),s[28]=0,u[28]=258,e.exports=function(e,n){var s,u,f=new a(e,n);do{switch(s=m(f),y(f,2,0)){case 0:u=b(f);break;case 1:u=x(f,i,o);break;case 2:S(f,f.ltree,f.dtree),u=x(f,f.ltree,f.dtree);break;default:u=t}if(u!==r)throw new Error("Data error")}while(!s);return f.destLen<f.dest.length?"function"==typeof f.dest.slice?f.dest.slice(0,f.destLen):f.dest.subarray(0,f.destLen):f.dest},e.exports}();return function(r){return function(e,r){var t=new DataView(e),n=0;function a(){var e=t.getUint16(n);return n+=2,e}function i(){var e=t.getUint32(n);return n+=4,e}function o(e){y.setUint16(U,e),U+=2}function s(e){y.setUint32(U,e),U+=4}for(var u={signature:i(),flavor:i(),length:i(),numTables:a(),reserved:a(),totalSfntSize:i(),majorVersion:a(),minorVersion:a(),metaOffset:i(),metaLength:i(),metaOrigLength:i(),privOffset:i(),privLength:i()},f=0;Math.pow(2,f)<=u.numTables;)f++;f--;for(var l=16*Math.pow(2,f),h=16*u.numTables-l,d=12,c=[],p=0;p<u.numTables;p++)c.push({tag:i(),offset:i(),compLength:i(),origLength:i(),origChecksum:i()}),d+=16;var v,g=new Uint8Array(12+16*c.length+c.reduce(function(e,r){return e+r.origLength+4},0)),m=g.buffer,y=new DataView(m),U=0;return s(u.flavor),o(u.numTables),o(l),o(f),o(h),c.forEach(function(e){s(e.tag),s(e.origChecksum),s(d),s(e.origLength),e.outOffset=d,(d+=e.origLength)%4!=0&&(d+=4-d%4)}),c.forEach(function(t){var n=e.slice(t.offset,t.offset+t.compLength);if(t.compLength!=t.origLength){var a=new Uint8Array(t.origLength);r(new Uint8Array(n,2),a)}else a=new Uint8Array(n);g.set(a,t.outOffset);var i=0;(d=t.outOffset+t.origLength)%4!=0&&(i=4-d%4),g.set(new Uint8Array(i).buffer,t.outOffset+t.origLength),v=d+i}),m.slice(0,v)}(r,e)}},function(e,r){var t={M:2,L:2,Q:4,C:6,Z:0};function n(r,t){var n=r.glyphToUnicodeMap;if(!n){n=r.glyphToUnicodeMap=Object.create(null);var a=r.cmap,i=-1;if(null!=a.p0e4?i=a.p0e4:null!=a.p3e1?i=a.p3e1:null!=a.p1e0?i=a.p1e0:null!=a.p0e3&&(i=a.p0e3),-1===i)throw"no familiar platform and encoding!";var o=a.tables[i];if(0===o.format)for(var s=0;s<o.map.length;s++)n[o.map[s]]=s;else if(4===o.format)for(var u=o.startCount,f=o.endCount,l=0;l<u.length;l++)for(var h=u[l];h<=f[l];h++)n[e.U.codeToGlyph(r,h)]=h;else{if(12!==o.format)throw"unknown cmap table format "+o.format;o.groups.forEach(function(e){for(var r=e[0],t=e[1],a=e[2],i=r;i<=t;i++)n[a++]=i})}}return n[t]||0}return function(a){var i,o,s,u,f=new Uint8Array(a,0,4),l=e._bin.readASCII(f,0,4);if("wOFF"===l)a=r(a);else if("wOF2"===l)throw new Error("woff2 fonts not supported");return i=e.parse(a),o=i[0],s=Object.create(null),u={unitsPerEm:o.head.unitsPerEm,ascender:o.hhea.ascender,descender:o.hhea.descender,forEachGlyph:function(r,a,i,f){var l=0,h=1/u.unitsPerEm*a;return e.U.stringToGlyphs(o,r).forEach(function(r){if(-1!==r){var u=s[r];if(!u){var d=e.glyf._parseGlyf(o,r)||{xMin:0,xMax:0,yMin:0,yMax:0},c=e.U.glyphToPath(o,r),p=c.cmds,v=c.crds;u=s[r]={index:r,unicode:n(o,r),advanceWidth:o.hmtx.aWidth[r],xMin:d.xMin,yMin:d.yMin,xMax:d.xMax,yMax:d.yMax,pathCommandCount:p.length,forEachPathCommand:function(e){for(var r=0,n=[],a=0,i=p.length;a<i;a++){var o=t[p[a]];n.length=1+o,n[0]=p[a];for(var s=1;s<=o;s++)n[s]=v[r++];e.apply(null,n)}}}}f.call(null,u,l),u.advanceWidth&&(l+=u.advanceWidth*h),i&&(l+=i*a)}}),l}}}}],init:function(e,r,t){return t(e(),r())}}),D={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64},P=document.createElement("a"),I=64,A=1/8,O=Object.create(null);var B=s({dependencies:[D,A,M,function(e){var r=e.sdfTextureSize,t=e.sdfDistancePercent,n=16;function a(e,r,t,n,a,i,o){var s=1-o;return{x:s*s*e+2*s*o*t+o*o*a,y:s*s*r+2*s*o*n+o*o*i}}function i(e,r,t,n,a,i,o,s,u){var f=1-u;return{x:f*f*f*e+3*f*f*u*t+3*f*u*u*a+u*u*u*o,y:f*f*f*r+3*f*f*u*n+3*f*u*u*i+u*u*u*s}}function o(e){return e*e}function s(e,r,t,n,a,i){var s=a-t,u=i-n,f=o(s)+o(u),l=f?Math.max(0,Math.min(1,((e-t)*s+(r-n)*u)/f)):0;return Math.sqrt(o(e-(t+l*s))+o(r-(n+l*u)))}var u=function(e){var r=e.xMin,t=e.yMin,n=e.xMax-r,a=e.yMax-t,i=Math.round(r+n/2),o=Math.round(t+a/2),s=Math.pow(2,Math.floor(Math.log(Math.max(n,a))*Math.LOG2E));this._root={0:null,1:null,2:null,3:null,data:null,cx:i,cy:o,r:s,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}};return u.prototype.addLineSegment=function(e,r,t,n){var a={x0:e,y0:r,x1:t,y1:n,cx:(e+t)/2,cy:(r+n)/2,minX:Math.min(e,t),minY:Math.min(r,n),maxX:Math.max(e,t),maxY:Math.max(r,n),next:null};this._insertSegment(a,this._root)},u.prototype._insertSegment=function(e,r){var t=e.minX,n=e.minY,a=e.maxX,i=e.maxY,o=e.cx,s=e.cy;t<r.minX&&(r.minX=t),n<r.minY&&(r.minY=n),a>r.maxX&&(r.maxX=a),i>r.maxY&&(r.maxY=i);var u=r.data;if(u)if(u.cx===o&&u.cy===s){for(;u.next;)u=u.next;u.next=e}else r.data=null,this._insertSegment(u,r),this._insertSegment(e,r);else{var f=(s<r.cy?0:2)+(o<r.cx?0:1);r[f]?this._insertSegment(e,r[f]):r[f]={0:null,1:null,2:null,3:null,data:e,cx:r.cx+r.r/2*(f%2?1:-1),cy:r.cy+r.r/2*(f<2?-1:1),r:r.r/2,minX:t,minY:n,maxX:a,maxY:i}}},u.prototype.walkTree=function(e){this.walkBranch(this._root,e)},u.prototype.walkBranch=function(e,r){if(!1!==r(e)&&!e.data)for(var t=0;t<4;t++)null!==e[t]&&this.walkBranch(e[t],r)},u.prototype.findNearestSignedDistance=function(e,r,t){var n=t;return this.walkTree(function(t){if(e-n>t.maxX||e+n<t.minX||r-n>t.maxY||r+n<t.minY)return!1;if(t.data)for(var a=t.data;a;a=a.next)if(e-n<a.maxX||e+n>a.minX||r-n<a.maxY||r+n>a.minY){var i=s(e,r,a.x0,a.y0,a.x1,a.y1);i<n&&(n=i)}}),this.isPointInPoly(e,r)||(n=-n),n},u.prototype.isPointInPoly=function(e,r){var t=!1;return this.walkTree(function(n){if(n.maxX<e||n.minY>r||n.maxY<r)return!1;if(n.data)for(var a=n.data;a;a=a.next){var i=a.x0,o=a.y0,s=a.x1,u=a.y1;o>r!=u>r&&e<(s-i)*(r-o)/(u-o)+i&&(t=!t)}}),t},function(e){var s=new Uint8Array(o(r)),f=e.xMax-e.xMin,l=e.yMax-e.yMin,h=Math.max(f,l)*t,d=(f+2*h)/r,c=(l+2*h)/r,p=e.xMin-h-d,v=e.yMin-h-c,g=e.xMax+h+d,m=e.yMax+h+c;if(e.pathCommandCount){var y,U,S,x,b=new u(e);e.forEachPathCommand(function(e,r,t,o,s,u,f){switch(e){case"M":S=y=r,x=U=t;break;case"L":r===S&&t===x||b.addLineSegment(S,x,S=r,x=t);break;case"Q":for(var l={x:S,y:x},h=1;h<n;h++){var d=a(S,x,r,t,o,s,h/(n-1));b.addLineSegment(l.x,l.y,d.x,d.y),l=d}S=o,x=s;break;case"C":for(var c={x:S,y:x},p=1;p<n;p++){var v=i(S,x,r,t,o,s,u,f,p/(n-1));b.addLineSegment(c.x,c.y,v.x,v.y),c=v}S=u,x=f;break;case"Z":S===y&&x===U||b.addLineSegment(S,x,y,U)}});for(var _=0;_<r;_++)for(var w=0;w<r;w++){var F=b.findNearestSignedDistance(p+(g-p)*(_+.5)/r,v+(m-v)*(w+.5)/r,h),k=isFinite(F)?Math.round(255*(1+F/h)*.5):F;k=Math.max(0,Math.min(255,k)),s[w*r+_]=k}}return{textureData:s,renderingBounds:[p,v,g,m]}}},function(e,r,t){var n=t.defaultFontUrl,a=Object.create(null),i=1/0;function o(r,t){r||(r=n);var i=a[r];if(i)i.onload?i.onload.push(t):t();else{var o=a[r]={onload:[t]};!function(r,t){!function a(){var i=function(e){console.error("Failure loading font "+r+(r===n?"":"; trying fallback"),e),r!==n&&(r=n,a())};try{var o=new XMLHttpRequest;o.open("get",r,!0),o.responseType="arraybuffer",o.onload=function(){if(o.status>=400)i(new Error(o.statusText));else if(o.status>0)try{var r=e(o.response);t(r)}catch(e){i(e)}},o.onerror=i,o.send()}catch(e){i(e)}}()}(r,function(e){i=a[r]={fontObj:e,glyphs:{},glyphCount:0},o.onload.forEach(function(e){return e()})})}}function s(e,t,s){var u=e.text;void 0===u&&(u="");var f=e.font;void 0===f&&(f=n);var l=e.fontSize;void 0===l&&(l=1);var h=e.letterSpacing;void 0===h&&(h=0);var d=e.lineHeight;void 0===d&&(d="normal");var c=e.maxWidth;void 0===c&&(c=i);var p=e.textAlign;void 0===p&&(p="left");var v=e.whiteSpace;void 0===v&&(v="normal");var g=e.overflowWrap;void 0===g&&(g="normal");var m=e.anchor;void 0===s&&(s=!1),function(e,r){e||(e=n),o(e,function(){r(a[e])})}(f,function(e){var n=e.fontObj,a=isFinite(c),o=null,f=null,y=null,U=null,S=0,x=0,b="nowrap"!==v,_=l/n.unitsPerEm;"normal"===d&&(d=(n.ascender-n.descender)/n.unitsPerEm);var w=((d*=l)-(n.ascender-n.descender)*_)/2,F=u.split(/\r?\n/).map(function(e){var r=0,t=[],i=[t];n.forEachGlyph(e,l,h,function(e,n){var o=e.unicode,s="number"==typeof o&&String.fromCharCode(o),u=e.advanceWidth*_,f=!!s&&/\s/.test(s);if(b&&a&&!f&&n+u+r>c&&t.length){var l;if(t[t.length-1].isWhitespace)l=[],r=-n;else for(var h=t.length;h--;){if(0===h&&"break-word"===g){l=[],r=-n;break}if(t[h].isWhitespace){var d=(l=t.splice(h+1))[0].x;r-=d;for(var p=0;p<l.length;p++)l[p].x-=d;break}}if(l){for(;t[t.length-1].isWhitespace;)t.pop();i.push(t=l),x=c}}t.push({glyphObj:e,x:n+r,y:0,width:u,char:s,isWhitespace:f,isEmpty:e.xMin===e.xMax||e.yMin===e.yMax,atlasInfo:null})});for(var o=0;o<i.length&&x<c;o++){var s=i[o];if(s.length){var u=s[s.length-1];x=Math.max(x,u.x+u.width)}}return S+=i.length,i});if(!s){var k=[],C=-(l+w);F.forEach(function(t){for(var n=0;n<t.length;n++){var a=t[n];if(a.length){var i=0,s=a[a.length-1],u=s.x+s.width,f=0;if("center"===p)i=(x-u)/2;else if("right"===p)i=x-u;else if("justify"===p)for(var l=0,h=a.length;l<h;l++)a[l].isWhitespace&&f++;for(var c=0,v=a.length;c<v;c++){var g=a[c];if(g.isWhitespace&&"justify"===p&&n!==t.length-1&&(i+=(x-u)/f),!g.isWhitespace&&!g.isEmpty){var m=g.glyphObj,y=e.glyphs[m.index];if(!y){var U=r(m);U.atlasIndex=e.glyphCount++,o||(o=[]),o.push(U),y=e.glyphs[m.index]={atlasIndex:U.atlasIndex,glyphObj:m,renderingBounds:U.renderingBounds}}g.atlasInfo=y,i&&(g.x+=i),g.y=C,k.push(g)}}}C-=d}});var T=0,M=0;m&&(m[0]&&(T=-x*m[0]),m[1]&&(M=S*d*m[1])),f=new Float32Array(4*k.length),y=new Float32Array(k.length),U=[i,i,-i,-i],k.forEach(function(e,r){var t=e.atlasInfo,n=t.renderingBounds,a=t.atlasIndex,i=f[4*r]=e.x+n[0]*_+T,o=f[4*r+1]=e.y+n[1]*_+M,s=f[4*r+2]=e.x+n[2]*_+T,u=f[4*r+3]=e.y+n[3]*_+M;i<U[0]&&(U[0]=i),o<U[1]&&(U[1]=o),s>U[2]&&(U[2]=s),u>U[3]&&(U[3]=u),y[r]=a})}t({glyphBounds:f,glyphIndices:y,totalBounds:U,totalBlockSize:[x,S*d],newGlyphSDFs:o})})}return{process:s,measure:function(e,r){s(e,function(e){r({width:e.totalBlockSize[0],height:e.totalBlockSize[1]})},!0)},loadFont:o}}],init:function(e,r,t,n,a){return a(t,n({sdfTextureSize:e.sdfGlyphSize,sdfDistancePercent:r}),{defaultFontUrl:e.defaultFontURL})}}),G=s({dependencies:[B,h],init:function(e,r){return function(t){var n=new r;return e.process(t,n.resolve),n}},getTransferables:function(e){var r=[e.glyphBounds.buffer,e.glyphIndices.buffer];return e.newGlyphSDFs&&e.newGlyphSDFs.forEach(function(e){r.push(e.textureData.buffer)}),r}}),L=new r.PlaneBufferGeometry(1,1).translate(.5,.5,0),z=new r.Vector3,E=function(e){function t(){e.call(this),this.copy(L),this.boundingSphere=new r.Sphere}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.computeBoundingSphere=function(){},t.prototype.updateGlyphs=function(e,r,t){V(this,"aTroikaGlyphBounds",e,4),V(this,"aTroikaGlyphIndex",r,1),this.maxInstancedCount=r.length;var n=this.boundingSphere;n.center.set((t[0]+t[2])/2,(t[1]+t[3])/2,0),n.radius=n.center.distanceTo(z.set(t[0],t[1],0))},t}(r.InstancedBufferGeometry);function V(e,t,n,a){var i=e.getAttribute(t);i&&i.array.length===n.length?(i.array.set(n),i.needsUpdate=!0):e.setAttribute(t,new r.InstancedBufferAttribute(n,a))}E.prototype.setAttribute||(E.prototype.setAttribute=function(e,r){return this.attributes[e]=r,this});var R="\nuniform float uTroikaGlyphVSize;\nuniform vec4 uTroikaTotalBounds;\nattribute vec4 aTroikaGlyphBounds;\nattribute float aTroikaGlyphIndex;\nvarying vec2 vTroikaGlyphUV;\nvarying vec3 vTroikaLocalPos;\n",W="\nvTroikaGlyphUV = vec2(\n  position.x,\n  uTroikaGlyphVSize * (aTroikaGlyphIndex + position.y)\n);\n\nposition = vec3(\n  mix(aTroikaGlyphBounds.x, aTroikaGlyphBounds.z, position.x),\n  mix(aTroikaGlyphBounds.y, aTroikaGlyphBounds.w, position.y),\n  position.z\n);\nvTroikaLocalPos = vec3(position);\n\nuv = vec2(\n  (position.x - uTroikaTotalBounds.x) / (uTroikaTotalBounds.z - uTroikaTotalBounds.x),\n  (position.y - uTroikaTotalBounds.y) / (uTroikaTotalBounds.w - uTroikaTotalBounds.y)\n);\n",j="\nuniform sampler2D uTroikaSDFTexture;\nuniform float uTroikaSDFMinDistancePct;\nuniform bool uTroikaSDFDebug;\nuniform float uTroikaGlyphVSize;\nuniform vec4 uTroikaClipRect;\nvarying vec2 vTroikaGlyphUV;\nvarying vec3 vTroikaLocalPos;\n\nfloat troikaGetClipAlpha() {\n  vec4 clip = uTroikaClipRect;\n  vec3 pos = vTroikaLocalPos;\n  float dClip = min(\n    min(pos.x - min(clip.x, clip.z), max(clip.x, clip.z) - pos.x),\n    min(pos.y - min(clip.y, clip.w), max(clip.y, clip.w) - pos.y)\n  );\n  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300\n  float aa = length(fwidth(pos)) * 0.5;\n  return smoothstep(-aa, aa, dClip);\n  #else\n  return step(0.0, dClip);\n  #endif\n}\n\nfloat troikaGetTextAlpha() {\n  float troikaSDFValue = texture2D(uTroikaSDFTexture, vTroikaGlyphUV).r;\n  \n  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)\n  float alpha = step(0.5, troikaSDFValue);\n  #else\n  \n  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300\n  float aaDist = min(\n    0.5,\n    0.5 * min(\n      fwidth(vTroikaGlyphUV.x), \n      fwidth(vTroikaGlyphUV.y / uTroikaGlyphVSize)\n    )\n  ) / uTroikaSDFMinDistancePct;\n  #else\n  float aaDist = 0.01;\n  #endif\n  \n  float alpha = uTroikaSDFDebug ? troikaSDFValue : smoothstep(\n    0.5 - aaDist,\n    0.5 + aaDist,\n    troikaSDFValue\n  );\n  #endif\n  \n  return min(alpha, troikaGetClipAlpha());\n}\n",X="\nfloat troikaAlphaMult = troikaGetTextAlpha();\nif (troikaAlphaMult == 0.0) {\n  discard;\n} else {\n  gl_FragColor.a *= troikaAlphaMult;\n}\n";var N=new r.MeshBasicMaterial({color:16777215,side:r.DoubleSide,transparent:!0}),H=(Object.freeze([-1/0,-1/0,1/0,1/0]),new r.Matrix4),Y=(new r.Plane,new r.Vector3,new r.Mesh(new r.PlaneBufferGeometry(1,1).translate(.5,.5,0),N)),q=function(e){function t(r){var t=new E;e.call(this,t,null),this.text="",this.anchor=null,this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.whiteSpace="normal",this.material=null,this.color=null,this.depthOffset=0,this.clipRect=null,this.debugSDF=!1}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={material:{configurable:!0},customDepthMaterial:{configurable:!0},customDistanceMaterial:{configurable:!0}};return t.prototype.sync=function(e){var t=this;this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(e):(this._isSyncing=!0,function(e,t){e=function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t]);return e}({},e),P.href=e.font||D.defaultFontURL,e.font=P.href,e.text=""+e.text;var n=D.sdfGlyphSize,a=O[e.font];a||((a=O[e.font]={sdfTexture:new r.DataTexture(new Uint8Array(n*n*I),n,n*I,r.LuminanceFormat,void 0,void 0,void 0,void 0,r.LinearFilter,r.LinearFilter)}).sdfTexture.font=e.font),G(e).then(function(e){e.newGlyphSDFs&&(e.newGlyphSDFs.forEach(function(e){for(var r=e.textureData,t=e.atlasIndex,i=a.sdfTexture.image,o=t*n*n;o>i.data.length-1;){var s=new Uint8Array(2*i.data.length);s.set(i.data),i.data=s,i.height*=2}i.data.set(r,o)}),a.sdfTexture.needsUpdate=!0),t({sdfTexture:a.sdfTexture,sdfMinDistancePercent:A,glyphBounds:e.glyphBounds,glyphIndices:e.glyphIndices,totalBounds:e.totalBounds,totalBlockSize:e.totalBlockSize})})}({text:this.text,font:this.font,fontSize:this.fontSize,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,maxWidth:this.maxWidth,textAlign:this.textAlign,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchor:this.anchor},function(r){t._isSyncing=!1,t._textRenderInfo=r,t.geometry.updateGlyphs(r.glyphBounds,r.glyphIndices,r.totalBounds);var n=t._queuedSyncs;n&&(t._queuedSyncs=null,t._needsSync=!0,t.sync(function(){n.forEach(function(e){return e&&e()})})),e&&e()})))},t.prototype.onBeforeRender=function(){this.sync(),this._prepareMaterial()},t.prototype.dispose=function(){this.geometry.dispose()},n.material.get=function(){var e=this._derivedMaterial,t=this._baseMaterial||N;return e&&e.baseMaterial===t||(e&&e.dispose(),e=this._derivedMaterial=function(e){var t=y(e,{extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFMinDistancePct:{value:0},uTroikaGlyphVSize:{value:0},uTroikaTotalBounds:{value:new r.Vector4},uTroikaClipRect:{value:new r.Vector4},uTroikaSDFDebug:{value:!1}},vertexDefs:R,vertexTransform:W,fragmentDefs:j,fragmentColorTransform:X});return t.transparent=!0,Object.defineProperty(t,"shadowSide",{get:function(){return this.side}}),t}(t),t.addEventListener("dispose",function r(){t.removeEventListener("dispose",r),e.dispose()})),e},n.material.set=function(e){this._baseMaterial=e},n.customDepthMaterial.get=function(){return this._updateLayoutUniforms(this.material.getDepthMaterial())},n.customDistanceMaterial.get=function(){return this._updateLayoutUniforms(this.material.getDistanceMaterial())},t.prototype._prepareMaterial=function(){var e=this._derivedMaterial;this._updateLayoutUniforms(e),e.uniforms.uTroikaSDFDebug.value=!!this.debugSDF,e.polygonOffset=!!this.depthOffset,e.polygonOffsetFactor=e.polygonOffsetUnits=this.depthOffset||0;var r=this.color;null!=r&&e.color&&e.color.isColor&&r!==e._troikaColor&&e.color.set(e._troikaColor=r)},t.prototype._updateLayoutUniforms=function(e){var r=this._textRenderInfo,t=e.uniforms;if(r){var n=r.sdfTexture,a=r.totalBounds;t.uTroikaSDFTexture.value=n,t.uTroikaSDFMinDistancePct.value=r.sdfMinDistancePercent,t.uTroikaGlyphVSize.value=n.image.width/n.image.height,t.uTroikaTotalBounds.value.fromArray(a);var i=this.clipRect;i&&Array.isArray(i)&&4===i.length?t.uTroikaClipRect.value.set(Math.max(a[0],i[0]),Math.max(a[1],i[1]),Math.min(a[2],i[2]),Math.min(a[3],i[3])):t.uTroikaClipRect.value.fromArray(a)}return e},t.prototype.raycast=function(e,r){var t=this._textRenderInfo;if(t){var n=t.totalBounds;Y.matrixWorld.multiplyMatrices(this.matrixWorld,H.set(n[2]-n[0],0,0,n[0],0,n[3]-n[1],0,n[1],0,0,1,0,0,0,0,1)),Y.raycast(e,r)}},Object.defineProperties(t.prototype,n),t}(r.Mesh);["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","textAlign","whiteSpace","anchor"].forEach(function(e){var r="_private_"+e;Object.defineProperty(q.prototype,e,{get:function(){return this[r]},set:"anchor"===e?function(e){JSON.stringify(e)!==JSON.stringify(this[r])&&(this[r]=e,this._needsSync=!0)}:function(e){e!==this[r]&&(this[r]=e,this._needsSync=!0)}})});e.registerComponent("troika-text",{schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string"},fontSize:{type:"number",default:.2},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},maxWidth:{type:"number",default:1/0},overflowWrap:{type:"string",default:"normal",oneOf:["normal","break-word"]},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","nowrap"]}},init:function(){var e;"a-troika-text"===this.el.tagName.toLowerCase()?e=this.el:(e=document.createElement("a-entity"),this.el.appendChild(e)),this.troikaTextEntity=e;var r=this.troikaTextMesh=new q;r.anchor=[0,0],e.setObject3D("mesh",r)},update:function(){var e=this.data,r=this.troikaTextMesh,t=this.troikaTextEntity;if(r.text=e.value,r.textAlign=e.align,r.anchor[0]=Z[e.anchor],r.anchor[1]=Q[e.baseline],r.color=e.color,r.font=e.font,r.fontSize=e.fontSize,r.letterSpacing=e.letterSpacing||0,r.lineHeight=e.lineHeight||null,r.overflowWrap=e.overflowWrap,r.whiteSpace=e.whiteSpace,r.maxWidth=e.maxWidth,r.sync(),t!==this.el){var n=this.el.getAttribute("troika-text-material");n?t.setAttribute("material",n):t.removeAttribute("material")}},remove:function(){this.troikaTextMesh.dispose(),this.troikaTextEntity!==this.el&&this.el.removeChild(this.troikaTextEntity)}});var Z={left:0,center:.5,right:1},Q={top:0,center:.5,bottom:1},$={},J=e.components["troika-text"].schema;Object.keys(J).map(function(e){var r=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();$[r]="troika-text."+e}),e.registerPrimitive("a-troika-text",{defaultComponents:{"troika-text":{}},mappings:$})}(AFRAME,THREE);
//# sourceMappingURL=aframe-troika-text.min.js.map
