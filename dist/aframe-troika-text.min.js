!function(r,e){"use strict";r=r&&r.hasOwnProperty("default")?r.default:r;var t="function"==typeof Promise?function(){var r,e,t=new Promise(function(t,n){r=t,e=n});return{then:t.then.bind(t),resolve:r,reject:e}}:function r(){var e,t=0,n=[],a=0,o=0;var i=c(function(r){o||f(1,r)}),s=c(function(r){o||f(-1,r)});function f(r,n){o++;var a=0;try{n===g&&v();var i=r>0&&d(n);i?i.call(n,c(function(r){a++,f(1,r)}),c(function(r){a++,f(-1,r)})):(t=r,e=n,u())}catch(r){t||a||f(-1,r)}}function u(){a||(setTimeout(h,0),a=1)}function h(){var r=n;a=0,n=[],r.forEach(l)}function l(r){r()}function d(r){var e=r&&(p(r)||"object"==typeof r)&&r.then;return p(e)&&e}function c(r){var e=0;return function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];e++||r.apply(this,t)}}function v(){throw new TypeError("Chaining cycle detected")}var p=function(r){return"function"==typeof r},g={then:function(a,o){var i=r();return n.push(function(){var r=t>0?a:o;if(p(r))try{var n=r(e);n===i&&v();var s=d(n);s?s.call(n,i.resolve,i.reject):i.resolve(n)}catch(r){i.reject(r)}else i[t>0?"resolve":"reject"](e)}),t&&u(),i},resolve:i,reject:s};return g},n=0,a=0,o=null,i=Object.create(null);function s(r){if(!r||"function"!=typeof r.init)throw new Error("requires `options.init` function");var e=r.dependencies,t=r.init,a=r.getTransferables,o="workerModule"+ ++n,i=null;function u(){for(var r=[],e=arguments.length;e--;)r[e]=arguments[e];return i||(i=h("registerModule",u.workerModuleData)),i.then(function(e){if(e.isCallable)return h("callModule",{id:o,args:r});throw new Error("Worker module function was called but `init` did not return a callable function")})}return e=e&&e.map(function(r){return"function"!=typeof r||r.workerModuleData||(r=s({init:new Function("return function(){return ("+f(r)+")}")()})),r&&r.workerModuleData&&(r=r.workerModuleData),r}),u.workerModuleData={isWorkerModule:!0,id:o,dependencies:e,init:f(t),getTransferables:a&&f(a)},u}function f(r){var e=r.toString();return!/^function/.test(e)&&/^\w+\s*\(/.test(e)&&(e="function "+e),e}function u(){if(!o){var r=function(){var r=Object.create(null);self.addEventListener("message",function(e){var t=e.data,n=t.messageId,a=t.action,o=t.data;try{"registerModule"===a&&function e(t,n){var a=t.id,o=t.dependencies;void 0===o&&(o=[]);var i=t.init;void 0===i&&(i=function(){});var s=t.getTransferables;if(void 0===s&&(s=null),!r[a])try{o=o.map(function(t){return t&&t.isWorkerModule&&(e(t,function(r){if(r instanceof Error)throw r}),t=r[t.id].value),t}),i=new Function("return ("+i+")")(),s&&(s=new Function("return ("+s+")")());var f=i.apply(void 0,o);r[a]={id:a,value:f,getTransferables:s},n(f)}catch(r){r&&r.noLog||console.error(r),n(r)}}(o,function(r){r instanceof Error?postMessage({messageId:n,success:!1,error:r.message}):postMessage({messageId:n,success:!0,result:{isCallable:"function"==typeof r}})}),"callModule"===a&&function(e,t){var n,a=e.id,o=e.args;r[a]&&"function"==typeof r[a].value||t(new Error("Worker module "+a+": not found or its 'init' did not return a function"));try{var i=(n=r[a]).value.apply(n,o);i&&"function"==typeof i.then?i.then(s,function(r){return t(r instanceof Error?r:new Error(""+r))}):s(i)}catch(r){t(r)}function s(e){try{var n=r[a].getTransferables&&r[a].getTransferables(e);n&&Array.isArray(n)&&n.length||(n=void 0),t(e,n)}catch(r){console.error(r),t(r)}}}(o,function(r,e){r instanceof Error?postMessage({messageId:n,success:!1,error:r.message}):postMessage({messageId:n,success:!0,result:r},e||void 0)})}catch(r){postMessage({messageId:n,success:!1,error:r.stack})}})}.toString();(o=new Worker(URL.createObjectURL(new Blob([";("+r+")()"],{type:"application/javascript"})))).onmessage=function(r){var e=r.data,t=e.messageId,n=i[t];if(!n)throw new Error("WorkerModule response with empty or unknown messageId");delete i[t],i.count--,n(e)}}return o}function h(r,e){var n=t(),o=++a;return i[o]=function(e){e.success?n.resolve(e.result):n.reject(new Error("Error in worker "+r+" call: "+e.error))},i._count++,i.count>1e3&&console.warn("Large number of open WorkerModule requests, some may not be returning"),u().postMessage({messageId:o,action:r,data:e}),n}i._count=0;var l=s({dependencies:[t],init:function(r){return r}}),d=/\bvoid\s+main\s*\(\s*\)\s*{/g;function c(r){return r.replace(/^[ \t]*#include +<([\w\d.\/]+)>/gm,function(r,t){var n=e.ShaderChunk[t];return n?c(n):r})}var v=Object.assign||function(){for(var r=arguments,e=arguments[0],t=1,n=arguments.length;t<n;t++){var a=r[t];if(a)for(var o in a)a.hasOwnProperty(o)&&(e[o]=a[o])}return e},p=0,g=new WeakMap;function m(r,t){var n=function(r){return JSON.stringify(r,y)}(t),a=g.get(r);if(a||(a=Object.create(null),g.set(r,a)),a[n])return a[n].clone();var o=++p,i="_derivedShaders"+o,s="_onBeforeCompile"+o;function f(e){r.onBeforeCompile.call(this,e);var n=this[i]||(this[i]={vertex:{},fragment:{}}),a=n.vertex,f=n.fragment;if(a.source!==e.vertexShader||f.source!==e.fragmentShader){var u=function(r,e,t){var n=r.vertexShader,a=r.fragmentShader,o=e.vertexDefs,i=e.vertexMainIntro,s=e.vertexTransform,f=e.fragmentDefs,u=e.fragmentMainIntro,h=e.fragmentColorTransform;(o||i||s)&&(s&&(n=c(n),o=(o||"")+"\nvoid troikaVertexTransform"+t+"(inout vec3 position, inout vec3 normal, inout vec2 uv) {\n  "+s+"\n}\n",n=n.replace(/\b(position|normal|uv)\b/g,function(r,e,n,a){return/\battribute\s+vec3\s+$/.test(a.substr(0,n))?e:"troika_"+e+"_"+t}),i="\nvec3 troika_position_"+t+" = vec3(position);\nvec3 troika_normal_"+t+" = vec3(normal);\nvec2 troika_uv_"+t+" = vec2(uv);\ntroikaVertexTransform"+t+"(troika_position_"+t+", troika_normal_"+t+", troika_uv_"+t+");\n"+(i||"")+"\n"),n=n.replace(d,(o||"")+"\n\n$&\n\n"+(i||"")));(f||u||h)&&(a=(a=c(a)).replace(d,"\n"+(f||"")+"\nvoid troikaOrigMain"+t+"() {\n"+(u||"")+"\n"),a+="\nvoid main() {\n  troikaOrigMain"+t+"();\n  "+(h||"")+"\n}");return{vertexShader:n,fragmentShader:a}}(e,t,o);a.source=e.vertexShader,a.result=u.vertexShader,f.source=e.fragmentShader,f.result=u.fragmentShader}e.vertexShader=a.result,e.fragmentShader=f.result,v(e.uniforms,this.uniforms),this[s]&&this[s](e)}function u(){r.constructor.apply(this,arguments)}u.prototype=Object.create(r,{constructor:{value:u},isDerivedMaterial:{value:!0},baseMaterial:{value:r},onBeforeCompile:{get:function(){return f},set:function(r){this[s]=r}},copy:{value:function(t){return r.copy.call(this,t),r.isShaderMaterial||r.isDerivedMaterial||(this.extensions=t.extensions,this.defines=v({},t.defines),this.uniforms=e.UniformsUtils.clone(t.uniforms)),this}}});var h=new u;return h.copy(r),h.uniforms=v(e.UniformsUtils.clone(r.uniforms||{}),t.uniforms),h.defines=v({},r.defines,t.defines),h.defines.TROIKA_DERIVED_MATERIAL=o,h.extensions=v({},r.extensions,t.extensions),a[n]=h,h.clone()}function y(r,e){return"uniforms"===r?void 0:e}var U=function(r){this.name=r,this.textureUniform="dataTex_"+r,this.textureSizeUniform="dataTexSize_"+r,this.multiplierUniform="dataMultiplier_"+r,this.dataSizeUniform="dataSize_"+r,this.readFunction="readData_"+r,this._raw=new Float32Array(0),this._texture=new e.DataTexture(new Uint8Array(0),0,1),this._length=0,this._multiplier=1},S={length:{configurable:!0}};function x(r,e,t){var n=255*r,a=n%1*255,o=a%1*255,i=o%1*255;return n&=255,a&=255,o&=255,i=255&Math.round(i),e[t]=n,e[t+1]=a,e[t+2]=o,e[t+3]=i,e}S.length.set=function(r){if(r!==this._length){var e=Math.pow(2,Math.ceil(Math.log2(r))),t=this._raw;e<t.length?this._raw=t.subarray(0,e):e>t.length&&(this._raw=new Float32Array(e),this._raw.set(t)),this._length=r}},S.length.get=function(){return this._length},U.prototype.push=function(r){return this.set(this.length++,r)},U.prototype.setArray=function(r){this.length=r.length,this._raw.set(r),this._needsRepack=!0},U.prototype.get=function(r){return this._raw[r]},U.prototype.set=function(r,e){r+1>this._length&&(this.length=r+1),e!==this._raw[r]&&(this._raw[r]=e,x(e/this._multiplier,this._texture.image.data,4*r),this._needsMultCheck=!0)},U.prototype.clone=function(){var r=new U(this.name);return r.setArray(this._raw),r},U.prototype.getShaderUniforms=function(){var r,e=this;return(r={})[this.textureUniform]={get value(){return e._sync(),e._texture}},r[this.textureSizeUniform]={get value(){return e._sync(),e._texture.image.width}},r[this.dataSizeUniform]={get value(){return e._sync(),e.length}},r[this.multiplierUniform]={get value(){return e._sync(),e._multiplier}},r},U.prototype.getShaderHeaderCode=function(){var r=this.textureUniform,e=this.textureSizeUniform,t=this.dataSizeUniform,n=this.multiplierUniform;return"\nuniform sampler2D "+r+";\nuniform float "+e+";\nuniform float "+t+";\nuniform float "+n+";\n\nfloat "+this.readFunction+"(float index) {\n  vec2 texUV = vec2((index + 0.5) / "+e+", 0.5);\n  vec4 pixel = texture2D("+r+", texUV);\n  return dot(pixel, 1.0 / vec4(1.0, 255.0, 65025.0, 16581375.0)) * "+n+";\n}\n"},U.prototype._sync=function(){var r=this._texture,e=this._raw,t=this._needsRepack;if(e.length!==r.image.width&&(r.image={data:new Uint8Array(4*e.length),width:e.length,height:1},t=!0),t||this._needsMultCheck){var n=this._raw.reduce(function(r,e){return Math.max(r,e)},0),a=Math.pow(2,Math.ceil(Math.log2(n)));a!==this._multiplier&&(this._multiplier=a,t=!0),r.needsUpdate=!0,this._needsMultCheck=!1}if(t){for(var o=0,i=e.length,s=this._multiplier;o<i;o++)x(e[o]/s,r.image.data,4*o);this._needsRepack=!1}},Object.defineProperties(U.prototype,S);var b=s({dependencies:[function(){var r=self,e={parse:function(r){var t=e._bin,n=new Uint8Array(r);if("ttcf"==t.readASCII(n,0,4)){var a=4;t.readUshort(n,a);a+=2;t.readUshort(n,a);a+=2;var o=t.readUint(n,a);a+=4;for(var i=[],s=0;s<o;s++){var f=t.readUint(n,a);a+=4,i.push(e._readFont(n,f))}return i}return[e._readFont(n,0)]},_readFont:function(r,t){var n=e._bin,a=t;n.readFixed(r,t);t+=4;var o=n.readUshort(r,t);t+=2;n.readUshort(r,t);t+=2;n.readUshort(r,t);t+=2;n.readUshort(r,t);t+=2;for(var i=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GPOS","GSUB","SVG "],s={_data:r,_offset:a},f={},u=0;u<o;u++){var h=n.readASCII(r,t,4);t+=4;n.readUint(r,t);t+=4;var l=n.readUint(r,t);t+=4;var d=n.readUint(r,t);t+=4,f[h]={offset:l,length:d}}for(u=0;u<i.length;u++){var c=i[u];f[c]&&(s[c.trim()]=e[c.trim()].parse(r,f[c].offset,f[c].length,s))}return s},_tabOffset:function(r,t,n){for(var a=e._bin,o=a.readUshort(r,n+4),i=n+12,s=0;s<o;s++){var f=a.readASCII(r,i,4);i+=4;a.readUint(r,i);i+=4;var u=a.readUint(r,i);i+=4;a.readUint(r,i);if(i+=4,f==t)return u}return 0}};return e._bin={readFixed:function(r,e){return(r[e]<<8|r[e+1])+(r[e+2]<<8|r[e+3])/65540},readF2dot14:function(r,t){return e._bin.readShort(r,t)/16384},readInt:function(r,t){var n=e._bin.t.uint8;return n[0]=r[t+3],n[1]=r[t+2],n[2]=r[t+1],n[3]=r[t],e._bin.t.int32[0]},readInt8:function(r,t){return e._bin.t.uint8[0]=r[t],e._bin.t.int8[0]},readShort:function(r,t){var n=e._bin.t.uint8;return n[1]=r[t],n[0]=r[t+1],e._bin.t.int16[0]},readUshort:function(r,e){return r[e]<<8|r[e+1]},readUshorts:function(r,t,n){for(var a=[],o=0;o<n;o++)a.push(e._bin.readUshort(r,t+2*o));return a},readUint:function(r,t){var n=e._bin.t.uint8;return n[3]=r[t],n[2]=r[t+1],n[1]=r[t+2],n[0]=r[t+3],e._bin.t.uint32[0]},readUint64:function(r,t){return 4294967296*e._bin.readUint(r,t)+e._bin.readUint(r,t+4)},readASCII:function(r,e,t){for(var n="",a=0;a<t;a++)n+=String.fromCharCode(r[e+a]);return n},readUnicode:function(r,e,t){for(var n="",a=0;a<t;a++){var o=r[e++]<<8|r[e++];n+=String.fromCharCode(o)}return n},_tdec:r.TextDecoder?new r.TextDecoder:null,readUTF8:function(r,t,n){var a=e._bin._tdec;return a&&0==t&&n==r.length?a.decode(r):e._bin.readASCII(r,t,n)},readBytes:function(r,e,t){for(var n=[],a=0;a<t;a++)n.push(r[e+a]);return n},readASCIIArray:function(r,e,t){for(var n=[],a=0;a<t;a++)n.push(String.fromCharCode(r[e+a]));return n}},e._bin.t={buff:new ArrayBuffer(8)},e._bin.t.int8=new Int8Array(e._bin.t.buff),e._bin.t.uint8=new Uint8Array(e._bin.t.buff),e._bin.t.int16=new Int16Array(e._bin.t.buff),e._bin.t.uint16=new Uint16Array(e._bin.t.buff),e._bin.t.int32=new Int32Array(e._bin.t.buff),e._bin.t.uint32=new Uint32Array(e._bin.t.buff),e._lctf={},e._lctf.parse=function(r,t,n,a,o){var i=e._bin,s={},f=t;i.readFixed(r,t);t+=4;var u=i.readUshort(r,t);t+=2;var h=i.readUshort(r,t);t+=2;var l=i.readUshort(r,t);return t+=2,s.scriptList=e._lctf.readScriptList(r,f+u),s.featureList=e._lctf.readFeatureList(r,f+h),s.lookupList=e._lctf.readLookupList(r,f+l,o),s},e._lctf.readLookupList=function(r,t,n){var a=e._bin,o=t,i=[],s=a.readUshort(r,t);t+=2;for(var f=0;f<s;f++){var u=a.readUshort(r,t);t+=2;var h=e._lctf.readLookupTable(r,o+u,n);i.push(h)}return i},e._lctf.readLookupTable=function(r,t,n){var a=e._bin,o=t,i={tabs:[]};i.ltype=a.readUshort(r,t),t+=2,i.flag=a.readUshort(r,t),t+=2;var s=a.readUshort(r,t);t+=2;for(var f=0;f<s;f++){var u=a.readUshort(r,t);t+=2;var h=n(r,i.ltype,o+u);i.tabs.push(h)}return i},e._lctf.numOfOnes=function(r){for(var e=0,t=0;t<32;t++)0!=(r>>>t&1)&&e++;return e},e._lctf.readClassDef=function(r,t){var n=e._bin,a=[],o=n.readUshort(r,t);if(t+=2,1==o){var i=n.readUshort(r,t);t+=2;var s=n.readUshort(r,t);t+=2;for(var f=0;f<s;f++)a.push(i+f),a.push(i+f),a.push(n.readUshort(r,t)),t+=2}if(2==o){var u=n.readUshort(r,t);t+=2;for(f=0;f<u;f++)a.push(n.readUshort(r,t)),t+=2,a.push(n.readUshort(r,t)),t+=2,a.push(n.readUshort(r,t)),t+=2}return a},e._lctf.getInterval=function(r,e){for(var t=0;t<r.length;t+=3){var n=r[t],a=r[t+1];r[t+2];if(n<=e&&e<=a)return t}return-1},e._lctf.readCoverage=function(r,t){var n=e._bin,a={};a.fmt=n.readUshort(r,t),t+=2;var o=n.readUshort(r,t);return t+=2,1==a.fmt&&(a.tab=n.readUshorts(r,t,o)),2==a.fmt&&(a.tab=n.readUshorts(r,t,3*o)),a},e._lctf.coverageIndex=function(r,t){var n=r.tab;if(1==r.fmt)return n.indexOf(t);if(2==r.fmt){var a=e._lctf.getInterval(n,t);if(-1!=a)return n[a+2]+(t-n[a])}return-1},e._lctf.readFeatureList=function(r,t){var n=e._bin,a=t,o=[],i=n.readUshort(r,t);t+=2;for(var s=0;s<i;s++){var f=n.readASCII(r,t,4);t+=4;var u=n.readUshort(r,t);t+=2,o.push({tag:f.trim(),tab:e._lctf.readFeatureTable(r,a+u)})}return o},e._lctf.readFeatureTable=function(r,t){var n=e._bin;n.readUshort(r,t);t+=2;var a=n.readUshort(r,t);t+=2;for(var o=[],i=0;i<a;i++)o.push(n.readUshort(r,t+2*i));return o},e._lctf.readScriptList=function(r,t){var n=e._bin,a=t,o={},i=n.readUshort(r,t);t+=2;for(var s=0;s<i;s++){var f=n.readASCII(r,t,4);t+=4;var u=n.readUshort(r,t);t+=2,o[f.trim()]=e._lctf.readScriptTable(r,a+u)}return o},e._lctf.readScriptTable=function(r,t){var n=e._bin,a=t,o={},i=n.readUshort(r,t);t+=2,o.default=e._lctf.readLangSysTable(r,a+i);var s=n.readUshort(r,t);t+=2;for(var f=0;f<s;f++){var u=n.readASCII(r,t,4);t+=4;var h=n.readUshort(r,t);t+=2,o[u.trim()]=e._lctf.readLangSysTable(r,a+h)}return o},e._lctf.readLangSysTable=function(r,t){var n=e._bin,a={};n.readUshort(r,t);t+=2,a.reqFeature=n.readUshort(r,t),t+=2;var o=n.readUshort(r,t);return t+=2,a.features=n.readUshorts(r,t,o),a},e.CFF={},e.CFF.parse=function(r,t,n){var a=e._bin;(r=new Uint8Array(r.buffer,t,n))[t=0],r[++t],r[++t],r[++t];t++;var o=[];t=e.CFF.readIndex(r,t,o);for(var i=[],s=0;s<o.length-1;s++)i.push(a.readASCII(r,t+o[s],o[s+1]-o[s]));t+=o[o.length-1];var f=[];t=e.CFF.readIndex(r,t,f);var u=[];for(s=0;s<f.length-1;s++)u.push(e.CFF.readDict(r,t+f[s],t+f[s+1]));t+=f[f.length-1];var h=u[0],l=[];t=e.CFF.readIndex(r,t,l);var d=[];for(s=0;s<l.length-1;s++)d.push(a.readASCII(r,t+l[s],l[s+1]-l[s]));if(t+=l[l.length-1],e.CFF.readSubrs(r,t,h),h.CharStrings){t=h.CharStrings;l=[];t=e.CFF.readIndex(r,t,l);var c=[];for(s=0;s<l.length-1;s++)c.push(a.readBytes(r,t+l[s],l[s+1]-l[s]));h.CharStrings=c}if(h.ROS){t=h.FDArray;var v=[];t=e.CFF.readIndex(r,t,v),h.FDArray=[];for(s=0;s<v.length-1;s++){var p=e.CFF.readDict(r,t+v[s],t+v[s+1]);e.CFF._readFDict(r,p,d),h.FDArray.push(p)}t+=v[v.length-1],t=h.FDSelect,h.FDSelect=[];var g=r[t];if(t++,3!=g)throw g;var m=a.readUshort(r,t);t+=2;for(s=0;s<m+1;s++)h.FDSelect.push(a.readUshort(r,t),r[t+2]),t+=3}return h.Encoding&&(h.Encoding=e.CFF.readEncoding(r,h.Encoding,h.CharStrings.length)),h.charset&&(h.charset=e.CFF.readCharset(r,h.charset,h.CharStrings.length)),e.CFF._readFDict(r,h,d),h},e.CFF._readFDict=function(r,t,n){var a;for(var o in t.Private&&(a=t.Private[1],t.Private=e.CFF.readDict(r,a,a+t.Private[0]),t.Private.Subrs&&e.CFF.readSubrs(r,a+t.Private.Subrs,t.Private)),t)-1!=["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(o)&&(t[o]=n[t[o]-426+35])},e.CFF.readSubrs=function(r,t,n){var a=e._bin,o=[];t=e.CFF.readIndex(r,t,o);var i,s=o.length;i=s<1240?107:s<33900?1131:32768,n.Bias=i,n.Subrs=[];for(var f=0;f<o.length-1;f++)n.Subrs.push(a.readBytes(r,t+o[f],o[f+1]-o[f]))},e.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],e.CFF.glyphByUnicode=function(r,e){for(var t=0;t<r.charset.length;t++)if(r.charset[t]==e)return t;return-1},e.CFF.glyphBySE=function(r,t){return t<0||t>255?-1:e.CFF.glyphByUnicode(r,e.CFF.tableSE[t])},e.CFF.readEncoding=function(r,t,n){e._bin;var a=[".notdef"],o=r[t];if(0!=o)throw"error: unknown encoding format: "+o;var i=r[++t];t++;for(var s=0;s<i;s++)a.push(r[t+s]);return a},e.CFF.readCharset=function(r,t,n){var a=e._bin,o=[".notdef"],i=r[t];if(t++,0==i)for(var s=0;s<n;s++){var f=a.readUshort(r,t);t+=2,o.push(f)}else{if(1!=i&&2!=i)throw"error: format: "+i;for(;o.length<n;){f=a.readUshort(r,t);t+=2;var u=0;1==i?(u=r[t],t++):(u=a.readUshort(r,t),t+=2);for(s=0;s<=u;s++)o.push(f),f++}}return o},e.CFF.readIndex=function(r,t,n){var a=e._bin,o=a.readUshort(r,t)+1,i=r[t+=2];if(t++,1==i)for(var s=0;s<o;s++)n.push(r[t+s]);else if(2==i)for(s=0;s<o;s++)n.push(a.readUshort(r,t+2*s));else if(3==i)for(s=0;s<o;s++)n.push(16777215&a.readUint(r,t+3*s-1));else if(1!=o)throw"unsupported offset size: "+i+", count: "+o;return(t+=o*i)-1},e.CFF.getCharString=function(r,t,n){var a=e._bin,o=r[t],i=r[t+1],s=(r[t+2],r[t+3],r[t+4],1),f=null,u=null;o<=20&&(f=o,s=1),12==o&&(f=100*o+i,s=2),21<=o&&o<=27&&(f=o,s=1),28==o&&(u=a.readShort(r,t+1),s=3),29<=o&&o<=31&&(f=o,s=1),32<=o&&o<=246&&(u=o-139,s=1),247<=o&&o<=250&&(u=256*(o-247)+i+108,s=2),251<=o&&o<=254&&(u=256*-(o-251)-i-108,s=2),255==o&&(u=a.readInt(r,t+1)/65535,s=5),n.val=null!=u?u:"o"+f,n.size=s},e.CFF.readCharString=function(r,t,n){for(var a=t+n,o=e._bin,i=[];t<a;){var s=r[t],f=r[t+1],u=(r[t+2],r[t+3],r[t+4],1),h=null,l=null;s<=20&&(h=s,u=1),12==s&&(h=100*s+f,u=2),19!=s&&20!=s||(h=s,u=2),21<=s&&s<=27&&(h=s,u=1),28==s&&(l=o.readShort(r,t+1),u=3),29<=s&&s<=31&&(h=s,u=1),32<=s&&s<=246&&(l=s-139,u=1),247<=s&&s<=250&&(l=256*(s-247)+f+108,u=2),251<=s&&s<=254&&(l=256*-(s-251)-f-108,u=2),255==s&&(l=o.readInt(r,t+1)/65535,u=5),i.push(null!=l?l:"o"+h),t+=u}return i},e.CFF.readDict=function(r,t,n){for(var a=e._bin,o={},i=[];t<n;){var s=r[t],f=r[t+1],u=(r[t+2],r[t+3],r[t+4],1),h=null,l=null;if(28==s&&(l=a.readShort(r,t+1),u=3),29==s&&(l=a.readInt(r,t+1),u=5),32<=s&&s<=246&&(l=s-139,u=1),247<=s&&s<=250&&(l=256*(s-247)+f+108,u=2),251<=s&&s<=254&&(l=256*-(s-251)-f-108,u=2),255==s)throw l=a.readInt(r,t+1)/65535,u=5,"unknown number";if(30==s){var d=[];for(u=1;;){var c=r[t+u];u++;var v=c>>4,p=15&c;if(15!=v&&d.push(v),15!=p&&d.push(p),15==p)break}for(var g="",m=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],y=0;y<d.length;y++)g+=m[d[y]];l=parseFloat(g)}if(s<=21)if(h=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][s],u=1,12==s)h=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][f],u=2;null!=h?(o[h]=1==i.length?i[0]:i,i=[]):i.push(l),t+=u}return o},e.cmap={},e.cmap.parse=function(r,t,n){r=new Uint8Array(r.buffer,t,n),t=0;var a=e._bin,o={};a.readUshort(r,t);t+=2;var i=a.readUshort(r,t);t+=2;var s=[];o.tables=[];for(var f=0;f<i;f++){var u=a.readUshort(r,t);t+=2;var h=a.readUshort(r,t);t+=2;var l=a.readUint(r,t);t+=4;var d="p"+u+"e"+h,c=s.indexOf(l);if(-1==c){var v;c=o.tables.length,s.push(l);var p=a.readUshort(r,l);0==p?v=e.cmap.parse0(r,l):4==p?v=e.cmap.parse4(r,l):6==p?v=e.cmap.parse6(r,l):12==p?v=e.cmap.parse12(r,l):console.log("unknown format: "+p,u,h,l),o.tables.push(v)}if(null!=o[d])throw"multiple tables for one platform+encoding";o[d]=c}return o},e.cmap.parse0=function(r,t){var n=e._bin,a={};a.format=n.readUshort(r,t),t+=2;var o=n.readUshort(r,t);t+=2;n.readUshort(r,t);t+=2,a.map=[];for(var i=0;i<o-6;i++)a.map.push(r[t+i]);return a},e.cmap.parse4=function(r,t){var n=e._bin,a=t,o={};o.format=n.readUshort(r,t),t+=2;var i=n.readUshort(r,t);t+=2;n.readUshort(r,t);t+=2;var s=n.readUshort(r,t);t+=2;var f=s/2;o.searchRange=n.readUshort(r,t),t+=2,o.entrySelector=n.readUshort(r,t),t+=2,o.rangeShift=n.readUshort(r,t),t+=2,o.endCount=n.readUshorts(r,t,f),t+=2*f,t+=2,o.startCount=n.readUshorts(r,t,f),t+=2*f,o.idDelta=[];for(var u=0;u<f;u++)o.idDelta.push(n.readShort(r,t)),t+=2;for(o.idRangeOffset=n.readUshorts(r,t,f),t+=2*f,o.glyphIdArray=[];t<a+i;)o.glyphIdArray.push(n.readUshort(r,t)),t+=2;return o},e.cmap.parse6=function(r,t){var n=e._bin,a={};a.format=n.readUshort(r,t),t+=2;n.readUshort(r,t);t+=2;n.readUshort(r,t);t+=2,a.firstCode=n.readUshort(r,t),t+=2;var o=n.readUshort(r,t);t+=2,a.glyphIdArray=[];for(var i=0;i<o;i++)a.glyphIdArray.push(n.readUshort(r,t)),t+=2;return a},e.cmap.parse12=function(r,t){var n=e._bin,a={};a.format=n.readUshort(r,t),t+=2,t+=2;n.readUint(r,t);t+=4;n.readUint(r,t);t+=4;var o=n.readUint(r,t);t+=4,a.groups=[];for(var i=0;i<o;i++){var s=t+12*i,f=n.readUint(r,s+0),u=n.readUint(r,s+4),h=n.readUint(r,s+8);a.groups.push([f,u,h])}return a},e.glyf={},e.glyf.parse=function(r,e,t,n){for(var a=[],o=0;o<n.maxp.numGlyphs;o++)a.push(null);return a},e.glyf._parseGlyf=function(r,t){var n=e._bin,a=r._data,o=e._tabOffset(a,"glyf",r._offset)+r.loca[t];if(r.loca[t]==r.loca[t+1])return null;var i={};if(i.noc=n.readShort(a,o),o+=2,i.xMin=n.readShort(a,o),o+=2,i.yMin=n.readShort(a,o),o+=2,i.xMax=n.readShort(a,o),o+=2,i.yMax=n.readShort(a,o),o+=2,i.xMin>=i.xMax||i.yMin>=i.yMax)return null;if(i.noc>0){i.endPts=[];for(var s=0;s<i.noc;s++)i.endPts.push(n.readUshort(a,o)),o+=2;var f=n.readUshort(a,o);if(o+=2,a.length-o<f)return null;i.instructions=n.readBytes(a,o,f),o+=f;var u=i.endPts[i.noc-1]+1;i.flags=[];for(s=0;s<u;s++){var h=a[o];if(o++,i.flags.push(h),0!=(8&h)){var l=a[o];o++;for(var d=0;d<l;d++)i.flags.push(h),s++}}i.xs=[];for(s=0;s<u;s++){var c=0!=(2&i.flags[s]),v=0!=(16&i.flags[s]);c?(i.xs.push(v?a[o]:-a[o]),o++):v?i.xs.push(0):(i.xs.push(n.readShort(a,o)),o+=2)}i.ys=[];for(s=0;s<u;s++){c=0!=(4&i.flags[s]),v=0!=(32&i.flags[s]);c?(i.ys.push(v?a[o]:-a[o]),o++):v?i.ys.push(0):(i.ys.push(n.readShort(a,o)),o+=2)}var p=0,g=0;for(s=0;s<u;s++)p+=i.xs[s],g+=i.ys[s],i.xs[s]=p,i.ys[s]=g}else{var m;i.parts=[];do{m=n.readUshort(a,o),o+=2;var y={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(i.parts.push(y),y.glyphIndex=n.readUshort(a,o),o+=2,1&m){var U=n.readShort(a,o);o+=2;var S=n.readShort(a,o);o+=2}else{U=n.readInt8(a,o);o++;S=n.readInt8(a,o);o++}2&m?(y.m.tx=U,y.m.ty=S):(y.p1=U,y.p2=S),8&m?(y.m.a=y.m.d=n.readF2dot14(a,o),o+=2):64&m?(y.m.a=n.readF2dot14(a,o),o+=2,y.m.d=n.readF2dot14(a,o),o+=2):128&m&&(y.m.a=n.readF2dot14(a,o),o+=2,y.m.b=n.readF2dot14(a,o),o+=2,y.m.c=n.readF2dot14(a,o),o+=2,y.m.d=n.readF2dot14(a,o),o+=2)}while(32&m);if(256&m){var x=n.readUshort(a,o);o+=2,i.instr=[];for(s=0;s<x;s++)i.instr.push(a[o]),o++}}return i},e.GPOS={},e.GPOS.parse=function(r,t,n,a){return e._lctf.parse(r,t,n,a,e.GPOS.subt)},e.GPOS.subt=function(r,t,n){var a=e._bin,o=n,i={};if(i.fmt=a.readUshort(r,n),n+=2,1==t||2==t||3==t||7==t||8==t&&i.fmt<=2){var s=a.readUshort(r,n);n+=2,i.coverage=e._lctf.readCoverage(r,s+o)}if(1==t&&1==i.fmt){var f=a.readUshort(r,n);n+=2;var u=e._lctf.numOfOnes(f);0!=f&&(i.pos=e.GPOS.readValueRecord(r,n,f))}else if(2==t){f=a.readUshort(r,n);n+=2;var h=a.readUshort(r,n);n+=2;u=e._lctf.numOfOnes(f);var l=e._lctf.numOfOnes(h);if(1==i.fmt){i.pairsets=[];var d=a.readUshort(r,n);n+=2;for(var c=0;c<d;c++){var v=o+a.readUshort(r,n);n+=2;var p=a.readUshort(r,v);v+=2;for(var g=[],m=0;m<p;m++){var y=a.readUshort(r,v);v+=2,0!=f&&(w=e.GPOS.readValueRecord(r,v,f),v+=2*u),0!=h&&(F=e.GPOS.readValueRecord(r,v,h),v+=2*l),g.push({gid2:y,val1:w,val2:F})}i.pairsets.push(g)}}if(2==i.fmt){var U=a.readUshort(r,n);n+=2;var S=a.readUshort(r,n);n+=2;var x=a.readUshort(r,n);n+=2;var b=a.readUshort(r,n);n+=2,i.classDef1=e._lctf.readClassDef(r,o+U),i.classDef2=e._lctf.readClassDef(r,o+S),i.matrix=[];for(c=0;c<x;c++){var _=[];for(m=0;m<b;m++){var w=null,F=null;0!=i.valFmt1&&(w=e.GPOS.readValueRecord(r,n,i.valFmt1),n+=2*u),0!=i.valFmt2&&(F=e.GPOS.readValueRecord(r,n,i.valFmt2),n+=2*l),_.push({val1:w,val2:F})}i.matrix.push(_)}}}return i},e.GPOS.readValueRecord=function(r,t,n){var a=e._bin,o=[];return o.push(1&n?a.readShort(r,t):0),t+=1&n?2:0,o.push(2&n?a.readShort(r,t):0),t+=2&n?2:0,o.push(4&n?a.readShort(r,t):0),t+=4&n?2:0,o.push(8&n?a.readShort(r,t):0),t+=8&n?2:0,o},e.GSUB={},e.GSUB.parse=function(r,t,n,a){return e._lctf.parse(r,t,n,a,e.GSUB.subt)},e.GSUB.subt=function(r,t,n){var a=e._bin,o=n,i={};if(i.fmt=a.readUshort(r,n),n+=2,1!=t&&4!=t&&5!=t&&6!=t)return null;if(1==t||4==t||5==t&&i.fmt<=2||6==t&&i.fmt<=2){var s=a.readUshort(r,n);n+=2,i.coverage=e._lctf.readCoverage(r,o+s)}if(1==t){if(1==i.fmt)i.delta=a.readShort(r,n),n+=2;else if(2==i.fmt){var f=a.readUshort(r,n);n+=2,i.newg=a.readUshorts(r,n,f),n+=2*i.newg.length}}else if(4==t){i.vals=[];f=a.readUshort(r,n);n+=2;for(var u=0;u<f;u++){var h=a.readUshort(r,n);n+=2,i.vals.push(e.GSUB.readLigatureSet(r,o+h))}}else if(5==t){if(2==i.fmt){var l=a.readUshort(r,n);n+=2,i.cDef=e._lctf.readClassDef(r,o+l),i.scset=[];var d=a.readUshort(r,n);n+=2;for(u=0;u<d;u++){var c=a.readUshort(r,n);n+=2,i.scset.push(0==c?null:e.GSUB.readSubClassSet(r,o+c))}}}else if(6==t&&3==i.fmt){for(u=0;u<3;u++){f=a.readUshort(r,n);n+=2;for(var v=[],p=0;p<f;p++)v.push(e._lctf.readCoverage(r,o+a.readUshort(r,n+2*p)));n+=2*f,0==u&&(i.backCvg=v),1==u&&(i.inptCvg=v),2==u&&(i.ahedCvg=v)}f=a.readUshort(r,n);n+=2,i.lookupRec=e.GSUB.readSubstLookupRecords(r,n,f)}return i},e.GSUB.readSubClassSet=function(r,t){var n=e._bin.readUshort,a=t,o=[],i=n(r,t);t+=2;for(var s=0;s<i;s++){var f=n(r,t);t+=2,o.push(e.GSUB.readSubClassRule(r,a+f))}return o},e.GSUB.readSubClassRule=function(r,t){var n=e._bin.readUshort,a={},o=n(r,t),i=n(r,t+=2);t+=2,a.input=[];for(var s=0;s<o-1;s++)a.input.push(n(r,t)),t+=2;return a.substLookupRecords=e.GSUB.readSubstLookupRecords(r,t,i),a},e.GSUB.readSubstLookupRecords=function(r,t,n){for(var a=e._bin.readUshort,o=[],i=0;i<n;i++)o.push(a(r,t),a(r,t+2)),t+=4;return o},e.GSUB.readChainSubClassSet=function(r,t){var n=e._bin,a=t,o=[],i=n.readUshort(r,t);t+=2;for(var s=0;s<i;s++){var f=n.readUshort(r,t);t+=2,o.push(e.GSUB.readChainSubClassRule(r,a+f))}return o},e.GSUB.readChainSubClassRule=function(r,t){for(var n=e._bin,a={},o=["backtrack","input","lookahead"],i=0;i<o.length;i++){var s=n.readUshort(r,t);t+=2,1==i&&s--,a[o[i]]=n.readUshorts(r,t,s),t+=2*a[o[i]].length}s=n.readUshort(r,t);return t+=2,a.subst=n.readUshorts(r,t,2*s),t+=2*a.subst.length,a},e.GSUB.readLigatureSet=function(r,t){var n=e._bin,a=t,o=[],i=n.readUshort(r,t);t+=2;for(var s=0;s<i;s++){var f=n.readUshort(r,t);t+=2,o.push(e.GSUB.readLigature(r,a+f))}return o},e.GSUB.readLigature=function(r,t){var n=e._bin,a={chain:[]};a.nglyph=n.readUshort(r,t),t+=2;var o=n.readUshort(r,t);t+=2;for(var i=0;i<o-1;i++)a.chain.push(n.readUshort(r,t)),t+=2;return a},e.head={},e.head.parse=function(r,t,n){var a=e._bin,o={};a.readFixed(r,t);t+=4,o.fontRevision=a.readFixed(r,t),t+=4;a.readUint(r,t);t+=4;a.readUint(r,t);return t+=4,o.flags=a.readUshort(r,t),t+=2,o.unitsPerEm=a.readUshort(r,t),t+=2,o.created=a.readUint64(r,t),t+=8,o.modified=a.readUint64(r,t),t+=8,o.xMin=a.readShort(r,t),t+=2,o.yMin=a.readShort(r,t),t+=2,o.xMax=a.readShort(r,t),t+=2,o.yMax=a.readShort(r,t),t+=2,o.macStyle=a.readUshort(r,t),t+=2,o.lowestRecPPEM=a.readUshort(r,t),t+=2,o.fontDirectionHint=a.readShort(r,t),t+=2,o.indexToLocFormat=a.readShort(r,t),t+=2,o.glyphDataFormat=a.readShort(r,t),t+=2,o},e.hhea={},e.hhea.parse=function(r,t,n){var a=e._bin,o={};a.readFixed(r,t);return t+=4,o.ascender=a.readShort(r,t),t+=2,o.descender=a.readShort(r,t),t+=2,o.lineGap=a.readShort(r,t),t+=2,o.advanceWidthMax=a.readUshort(r,t),t+=2,o.minLeftSideBearing=a.readShort(r,t),t+=2,o.minRightSideBearing=a.readShort(r,t),t+=2,o.xMaxExtent=a.readShort(r,t),t+=2,o.caretSlopeRise=a.readShort(r,t),t+=2,o.caretSlopeRun=a.readShort(r,t),t+=2,o.caretOffset=a.readShort(r,t),t+=2,t+=8,o.metricDataFormat=a.readShort(r,t),t+=2,o.numberOfHMetrics=a.readUshort(r,t),t+=2,o},e.hmtx={},e.hmtx.parse=function(r,t,n,a){for(var o=e._bin,i={aWidth:[],lsBearing:[]},s=0,f=0,u=0;u<a.maxp.numGlyphs;u++)u<a.hhea.numberOfHMetrics&&(s=o.readUshort(r,t),t+=2,f=o.readShort(r,t),t+=2),i.aWidth.push(s),i.lsBearing.push(f);return i},e.kern={},e.kern.parse=function(r,t,n,a){var o=e._bin,i=o.readUshort(r,t);if(t+=2,1==i)return e.kern.parseV1(r,t-2,n,a);var s=o.readUshort(r,t);t+=2;for(var f={glyph1:[],rval:[]},u=0;u<s;u++){t+=2;n=o.readUshort(r,t);t+=2;var h=o.readUshort(r,t);t+=2;var l=h>>>8;if(0!=(l&=15))throw"unknown kern table format: "+l;t=e.kern.readFormat0(r,t,f)}return f},e.kern.parseV1=function(r,t,n,a){var o=e._bin;o.readFixed(r,t);t+=4;var i=o.readUint(r,t);t+=4;for(var s={glyph1:[],rval:[]},f=0;f<i;f++){o.readUint(r,t);t+=4;var u=o.readUshort(r,t);t+=2;o.readUshort(r,t);t+=2;var h=u>>>8;if(0!=(h&=15))throw"unknown kern table format: "+h;t=e.kern.readFormat0(r,t,s)}return s},e.kern.readFormat0=function(r,t,n){var a=e._bin,o=-1,i=a.readUshort(r,t);t+=2;a.readUshort(r,t);t+=2;a.readUshort(r,t);t+=2;a.readUshort(r,t);t+=2;for(var s=0;s<i;s++){var f=a.readUshort(r,t);t+=2;var u=a.readUshort(r,t);t+=2;var h=a.readShort(r,t);t+=2,f!=o&&(n.glyph1.push(f),n.rval.push({glyph2:[],vals:[]}));var l=n.rval[n.rval.length-1];l.glyph2.push(u),l.vals.push(h),o=f}return t},e.loca={},e.loca.parse=function(r,t,n,a){var o=e._bin,i=[],s=a.head.indexToLocFormat,f=a.maxp.numGlyphs+1;if(0==s)for(var u=0;u<f;u++)i.push(o.readUshort(r,t+(u<<1))<<1);if(1==s)for(u=0;u<f;u++)i.push(o.readUint(r,t+(u<<2)));return i},e.maxp={},e.maxp.parse=function(r,t,n){var a=e._bin,o={},i=a.readUint(r,t);return t+=4,o.numGlyphs=a.readUshort(r,t),t+=2,65536==i&&(o.maxPoints=a.readUshort(r,t),t+=2,o.maxContours=a.readUshort(r,t),t+=2,o.maxCompositePoints=a.readUshort(r,t),t+=2,o.maxCompositeContours=a.readUshort(r,t),t+=2,o.maxZones=a.readUshort(r,t),t+=2,o.maxTwilightPoints=a.readUshort(r,t),t+=2,o.maxStorage=a.readUshort(r,t),t+=2,o.maxFunctionDefs=a.readUshort(r,t),t+=2,o.maxInstructionDefs=a.readUshort(r,t),t+=2,o.maxStackElements=a.readUshort(r,t),t+=2,o.maxSizeOfInstructions=a.readUshort(r,t),t+=2,o.maxComponentElements=a.readUshort(r,t),t+=2,o.maxComponentDepth=a.readUshort(r,t),t+=2),o},e.name={},e.name.parse=function(r,t,n){var a=e._bin,o={};a.readUshort(r,t);t+=2;var i=a.readUshort(r,t);t+=2;a.readUshort(r,t);for(var s,f=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],u=t+=2,h=0;h<i;h++){var l=a.readUshort(r,t);t+=2;var d=a.readUshort(r,t);t+=2;var c=a.readUshort(r,t);t+=2;var v=a.readUshort(r,t);t+=2;var p=a.readUshort(r,t);t+=2;var g=a.readUshort(r,t);t+=2;var m,y=f[v],U=u+12*i+g;if(0==l)m=a.readUnicode(r,U,p/2);else if(3==l&&0==d)m=a.readUnicode(r,U,p/2);else if(0==d)m=a.readASCII(r,U,p);else if(1==d)m=a.readUnicode(r,U,p/2);else if(3==d)m=a.readUnicode(r,U,p/2);else{if(1!=l)throw"unknown encoding "+d+", platformID: "+l;m=a.readASCII(r,U,p),console.log("reading unknown MAC encoding "+d+" as ASCII")}var S="p"+l+","+c.toString(16);null==o[S]&&(o[S]={}),o[S][y]=m,o[S]._lang=c}for(var x in o)if(null!=o[x].postScriptName&&1033==o[x]._lang)return o[x];for(var x in o)if(null!=o[x].postScriptName&&0==o[x]._lang)return o[x];for(var x in o)if(null!=o[x].postScriptName&&3084==o[x]._lang)return o[x];for(var x in o)if(null!=o[x].postScriptName)return o[x];for(var x in o){s=x;break}return console.log("returning name table with languageID "+o[s]._lang),o[s]},e["OS/2"]={},e["OS/2"].parse=function(r,t,n){var a=e._bin.readUshort(r,t);t+=2;var o={};if(0==a)e["OS/2"].version0(r,t,o);else if(1==a)e["OS/2"].version1(r,t,o);else if(2==a||3==a||4==a)e["OS/2"].version2(r,t,o);else{if(5!=a)throw"unknown OS/2 table version: "+a;e["OS/2"].version5(r,t,o)}return o},e["OS/2"].version0=function(r,t,n){var a=e._bin;return n.xAvgCharWidth=a.readShort(r,t),t+=2,n.usWeightClass=a.readUshort(r,t),t+=2,n.usWidthClass=a.readUshort(r,t),t+=2,n.fsType=a.readUshort(r,t),t+=2,n.ySubscriptXSize=a.readShort(r,t),t+=2,n.ySubscriptYSize=a.readShort(r,t),t+=2,n.ySubscriptXOffset=a.readShort(r,t),t+=2,n.ySubscriptYOffset=a.readShort(r,t),t+=2,n.ySuperscriptXSize=a.readShort(r,t),t+=2,n.ySuperscriptYSize=a.readShort(r,t),t+=2,n.ySuperscriptXOffset=a.readShort(r,t),t+=2,n.ySuperscriptYOffset=a.readShort(r,t),t+=2,n.yStrikeoutSize=a.readShort(r,t),t+=2,n.yStrikeoutPosition=a.readShort(r,t),t+=2,n.sFamilyClass=a.readShort(r,t),t+=2,n.panose=a.readBytes(r,t,10),t+=10,n.ulUnicodeRange1=a.readUint(r,t),t+=4,n.ulUnicodeRange2=a.readUint(r,t),t+=4,n.ulUnicodeRange3=a.readUint(r,t),t+=4,n.ulUnicodeRange4=a.readUint(r,t),t+=4,n.achVendID=[a.readInt8(r,t),a.readInt8(r,t+1),a.readInt8(r,t+2),a.readInt8(r,t+3)],t+=4,n.fsSelection=a.readUshort(r,t),t+=2,n.usFirstCharIndex=a.readUshort(r,t),t+=2,n.usLastCharIndex=a.readUshort(r,t),t+=2,n.sTypoAscender=a.readShort(r,t),t+=2,n.sTypoDescender=a.readShort(r,t),t+=2,n.sTypoLineGap=a.readShort(r,t),t+=2,n.usWinAscent=a.readUshort(r,t),t+=2,n.usWinDescent=a.readUshort(r,t),t+=2},e["OS/2"].version1=function(r,t,n){var a=e._bin;return t=e["OS/2"].version0(r,t,n),n.ulCodePageRange1=a.readUint(r,t),t+=4,n.ulCodePageRange2=a.readUint(r,t),t+=4},e["OS/2"].version2=function(r,t,n){var a=e._bin;return t=e["OS/2"].version1(r,t,n),n.sxHeight=a.readShort(r,t),t+=2,n.sCapHeight=a.readShort(r,t),t+=2,n.usDefault=a.readUshort(r,t),t+=2,n.usBreak=a.readUshort(r,t),t+=2,n.usMaxContext=a.readUshort(r,t),t+=2},e["OS/2"].version5=function(r,t,n){var a=e._bin;return t=e["OS/2"].version2(r,t,n),n.usLowerOpticalPointSize=a.readUshort(r,t),t+=2,n.usUpperOpticalPointSize=a.readUshort(r,t),t+=2},e.post={},e.post.parse=function(r,t,n){var a=e._bin,o={};return o.version=a.readFixed(r,t),t+=4,o.italicAngle=a.readFixed(r,t),t+=4,o.underlinePosition=a.readShort(r,t),t+=2,o.underlineThickness=a.readShort(r,t),t+=2,o},e.SVG={},e.SVG.parse=function(r,t,n){var a=e._bin,o={entries:[]},i=t;a.readUshort(r,t);t+=2;var s=a.readUint(r,t);t+=4;a.readUint(r,t);t+=4,t=s+i;var f=a.readUshort(r,t);t+=2;for(var u=0;u<f;u++){var h=a.readUshort(r,t);t+=2;var l=a.readUshort(r,t);t+=2;var d=a.readUint(r,t);t+=4;var c=a.readUint(r,t);t+=4;for(var v=new Uint8Array(r.buffer,i+d+s,c),p=a.readUTF8(v,0,v.length),g=h;g<=l;g++)o.entries[g]=p}return o},e.SVG.toPath=function(r){var t={cmds:[],crds:[]};if(null==r)return t;for(var n=(new DOMParser).parseFromString(r,"image/svg+xml").firstChild;"svg"!=n.tagName;)n=n.nextSibling;var a=n.getAttribute("viewBox");a=a?a.trim().split(" ").map(parseFloat):[0,0,1e3,1e3],e.SVG._toPath(n.children,t);for(var o=0;o<t.crds.length;o+=2){var i=t.crds[o],s=t.crds[o+1];i-=a[0],s=-(s-=a[1]),t.crds[o]=i,t.crds[o+1]=s}return t},e.SVG._toPath=function(r,t,n){for(var a=0;a<r.length;a++){var o=r[a],i=o.tagName,s=o.getAttribute("fill");if(null==s&&(s=n),"g"==i)e.SVG._toPath(o.children,t,s);else if("path"==i){t.cmds.push(s||"#000000");var f=o.getAttribute("d"),u=e.SVG._tokens(f);e.SVG._toksToPath(u,t),t.cmds.push("X")}else"defs"==i||console.log(i,o)}},e.SVG._tokens=function(r){for(var e=[],t=0,n=!1,a="";t<r.length;){var o=r.charCodeAt(t),i=r.charAt(t);t++;var s=48<=o&&o<=57||"."==i||"-"==i;n?"-"==i?(e.push(parseFloat(a)),a=i):s?a+=i:(e.push(parseFloat(a)),","!=i&&" "!=i&&e.push(i),n=!1):s?(a=i,n=!0):","!=i&&" "!=i&&e.push(i)}return n&&e.push(parseFloat(a)),e},e.SVG._toksToPath=function(r,t){for(var n=0,a=0,o=0,i=0,s=0,f={M:2,L:2,H:1,V:1,S:4,C:6},u=t.cmds,h=t.crds;n<r.length;){var l=r[n];if(n++,"z"==l)u.push("Z"),a=i,o=s;else for(var d=l.toUpperCase(),c=f[d],v=e.SVG._reps(r,n,c),p=0;p<v;p++){var g=0,m=0;if(l!=d&&(g=a,m=o),"M"==d)a=g+r[n++],o=m+r[n++],u.push("M"),h.push(a,o),i=a,s=o;else if("L"==d)a=g+r[n++],o=m+r[n++],u.push("L"),h.push(a,o);else if("H"==d)a=g+r[n++],u.push("L"),h.push(a,o);else if("V"==d)o=m+r[n++],u.push("L"),h.push(a,o);else if("C"==d){var y=g+r[n++],U=m+r[n++],S=g+r[n++],x=m+r[n++],b=g+r[n++],_=m+r[n++];u.push("C"),h.push(y,U,S,x,b,_),a=b,o=_}else if("S"==d){var w=Math.max(h.length-4,0);y=a+a-h[w],U=o+o-h[w+1],S=g+r[n++],x=m+r[n++],b=g+r[n++],_=m+r[n++];u.push("C"),h.push(y,U,S,x,b,_),a=b,o=_}else console.log("Unknown SVG command "+l)}}},e.SVG._reps=function(r,e,t){for(var n=e;n<r.length&&"string"!=typeof r[n];)n+=t;return(n-e)/t},null==e&&(e={}),null==e.U&&(e.U={}),e.U.codeToGlyph=function(r,e){var t=r.cmap,n=-1;if(null!=t.p0e4?n=t.p0e4:null!=t.p3e1?n=t.p3e1:null!=t.p1e0?n=t.p1e0:null!=t.p0e3&&(n=t.p0e3),-1==n)throw"no familiar platform and encoding!";var a=t.tables[n];if(0==a.format)return e>=a.map.length?0:a.map[e];if(4==a.format){for(var o=-1,i=0;i<a.endCount.length;i++)if(e<=a.endCount[i]){o=i;break}if(-1==o)return 0;if(a.startCount[o]>e)return 0;return 65535&(0!=a.idRangeOffset[o]?a.glyphIdArray[e-a.startCount[o]+(a.idRangeOffset[o]>>1)-(a.idRangeOffset.length-o)]:e+a.idDelta[o])}if(12==a.format){if(e>a.groups[a.groups.length-1][1])return 0;for(i=0;i<a.groups.length;i++){var s=a.groups[i];if(s[0]<=e&&e<=s[1])return s[2]+(e-s[0])}return 0}throw"unknown cmap table format "+a.format},e.U.glyphToPath=function(r,t){var n={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[t]){var a=r.SVG.entries[t];return null==a?n:("string"==typeof a&&(a=e.SVG.toPath(a),r.SVG.entries[t]=a),a)}if(r.CFF){var o={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},i=r.CFF,s=r.CFF.Private;if(i.ROS){for(var f=0;i.FDSelect[f+2]<=t;)f+=2;s=i.FDArray[i.FDSelect[f+1]].Private}e.U._drawCFF(r.CFF.CharStrings[t],o,i,s,n)}else r.glyf&&e.U._drawGlyf(t,r,n);return n},e.U._drawGlyf=function(r,t,n){var a=t.glyf[r];null==a&&(a=t.glyf[r]=e.glyf._parseGlyf(t,r)),null!=a&&(a.noc>-1?e.U._simpleGlyph(a,n):e.U._compoGlyph(a,t,n))},e.U._simpleGlyph=function(r,t){for(var n=0;n<r.noc;n++){for(var a=0==n?0:r.endPts[n-1]+1,o=r.endPts[n],i=a;i<=o;i++){var s=i==a?o:i-1,f=i==o?a:i+1,u=1&r.flags[i],h=1&r.flags[s],l=1&r.flags[f],d=r.xs[i],c=r.ys[i];if(i==a)if(u){if(!h){e.U.P.moveTo(t,d,c);continue}e.U.P.moveTo(t,r.xs[s],r.ys[s])}else h?e.U.P.moveTo(t,r.xs[s],r.ys[s]):e.U.P.moveTo(t,(r.xs[s]+d)/2,(r.ys[s]+c)/2);u?h&&e.U.P.lineTo(t,d,c):l?e.U.P.qcurveTo(t,d,c,r.xs[f],r.ys[f]):e.U.P.qcurveTo(t,d,c,(d+r.xs[f])/2,(c+r.ys[f])/2)}e.U.P.closePath(t)}},e.U._compoGlyph=function(r,t,n){for(var a=0;a<r.parts.length;a++){var o={cmds:[],crds:[]},i=r.parts[a];e.U._drawGlyf(i.glyphIndex,t,o);for(var s=i.m,f=0;f<o.crds.length;f+=2){var u=o.crds[f],h=o.crds[f+1];n.crds.push(u*s.a+h*s.b+s.tx),n.crds.push(u*s.c+h*s.d+s.ty)}for(f=0;f<o.cmds.length;f++)n.cmds.push(o.cmds[f])}},e.U._getGlyphClass=function(r,t){var n=e._lctf.getInterval(t,r);return-1==n?0:t[n+2]},e.U.getPairAdjustment=function(r,t,n){if(r.GPOS)for(var a=r.GPOS,o=a.lookupList,i=a.featureList,s=[],f=0;f<i.length;f++){var u=i[f];if("kern"==u.tag)for(var h=0;h<u.tab.length;h++)if(!s[u.tab[h]]){s[u.tab[h]]=!0;for(var l=o[u.tab[h]],d=0;d<l.tabs.length;d++)if(null!=l.tabs[f]){var c,v=l.tabs[d];if(!v.coverage||-1!=(c=e._lctf.coverageIndex(v.coverage,t)))if(1==l.ltype);else if(2==l.ltype){var p;if(1==v.fmt){var g=v.pairsets[c];for(f=0;f<g.length;f++)g[f].gid2==n&&(p=g[f])}else if(2==v.fmt){var m=e.U._getGlyphClass(t,v.classDef1),y=e.U._getGlyphClass(n,v.classDef2);p=v.matrix[m][y]}if(p&&p.val2)return p.val2[2]}}}}if(r.kern){var U=r.kern.glyph1.indexOf(t);if(-1!=U){var S=r.kern.rval[U].glyph2.indexOf(n);if(-1!=S)return r.kern.rval[U].vals[S]}}return 0},e.U.stringToGlyphs=function(r,t){for(var n=[],a=0;a<t.length;a++){(o=t.codePointAt(a))>65535&&a++,n.push(e.U.codeToGlyph(r,o))}for(a=0;a<t.length;a++){var o;if(2367==(o=t.codePointAt(a))){var i=n[a-1];n[a-1]=n[a],n[a]=i}o>65535&&a++}var s=r.GSUB;if(null==s)return n;for(var f=s.lookupList,u=s.featureList,h=["rlig","liga","mset","isol","init","fina","medi","half","pres","blws"],l=[],d=0;d<u.length;d++){var c=u[d];if(-1!=h.indexOf(c.tag))for(var v=0;v<c.tab.length;v++)if(!l[c.tab[v]]){l[c.tab[v]]=!0;for(var p=f[c.tab[v]],g=0;g<n.length;g++){var m=e.U._getWPfeature(t,g);-1!="isol,init,fina,medi".indexOf(c.tag)&&c.tag!=m||e.U._applySubs(n,g,p,f)}}}return n},e.U._getWPfeature=function(r,e){var t='\n\t" ,.:;!?()  ،',n="آأؤإاةدذرزوٱٲٳٵٶٷڈډڊڋڌڍڎڏڐڑڒړڔڕږڗژڙۀۃۄۅۆۇۈۉۊۋۍۏےۓەۮۯܐܕܖܗܘܙܞܨܪܬܯݍݙݚݛݫݬݱݳݴݸݹࡀࡆࡇࡉࡔࡧࡩࡪࢪࢫࢬࢮࢱࢲࢹૅેૉ૊૎૏ૐ૑૒૝ૡ૤૯஁ஃ஄அஉ஌எஏ஑னப஫஬",a=0==e||-1!=t.indexOf(r[e-1]),o=e==r.length-1||-1!=t.indexOf(r[e+1]);a||-1==n.indexOf(r[e-1])||(a=!0),o||-1==n.indexOf(r[e])||(o=!0),o||-1=="ꡲ્૗".indexOf(r[e+1])||(o=!0),a||-1=="ꡲ્૗".indexOf(r[e])||(a=!0);return a?o?"isol":"init":o?"fina":"medi"},e.U._applySubs=function(r,t,n,a){for(var o=r.length-t-1,i=0;i<n.tabs.length;i++)if(null!=n.tabs[i]){var s,f=n.tabs[i];if(!f.coverage||-1!=(s=e._lctf.coverageIndex(f.coverage,r[t])))if(1==n.ltype){r[t];1==f.fmt?r[t]=r[t]+f.delta:r[t]=f.newg[s]}else if(4==n.ltype)for(var u=f.vals[s],h=0;h<u.length;h++){var l=u[h],d=l.chain.length;if(!(d>o)){for(var c=!0,v=0,p=0;p<d;p++){for(;-1==r[t+v+(1+p)];)v++;l.chain[p]!=r[t+v+(1+p)]&&(c=!1)}if(c){r[t]=l.nglyph;for(p=0;p<d+v;p++)r[t+p+1]=-1;break}}}else if(5==n.ltype&&2==f.fmt)for(var g=e._lctf.getInterval(f.cDef,r[t]),m=f.cDef[g+2],y=f.scset[m],U=0;U<y.length;U++){var S=y[U],x=S.input;if(!(x.length>o)){for(c=!0,p=0;p<x.length;p++){var b=e._lctf.getInterval(f.cDef,r[t+1+p]);if(-1==g&&f.cDef[b+2]!=x[p]){c=!1;break}}if(c){var _=S.substLookupRecords;for(h=0;h<_.length;h+=2)_[h],_[h+1]}}}else if(6==n.ltype&&3==f.fmt){if(!e.U._glsCovered(r,f.backCvg,t-f.backCvg.length))continue;if(!e.U._glsCovered(r,f.inptCvg,t))continue;if(!e.U._glsCovered(r,f.ahedCvg,t+f.inptCvg.length))continue;var w=f.lookupRec;for(U=0;U<w.length;U+=2){g=w[U];var F=a[w[U+1]];e.U._applySubs(r,t+g,F,a)}}}},e.U._glsCovered=function(r,t,n){for(var a=0;a<t.length;a++){if(-1==e._lctf.coverageIndex(t[a],r[n+a]))return!1}return!0},e.U.glyphsToPath=function(r,t,n){for(var a={cmds:[],crds:[]},o=0,i=0;i<t.length;i++){var s=t[i];if(-1!=s){for(var f=i<t.length-1&&-1!=t[i+1]?t[i+1]:0,u=e.U.glyphToPath(r,s),h=0;h<u.crds.length;h+=2)a.crds.push(u.crds[h]+o),a.crds.push(u.crds[h+1]);n&&a.cmds.push(n);for(h=0;h<u.cmds.length;h++)a.cmds.push(u.cmds[h]);n&&a.cmds.push("X"),o+=r.hmtx.aWidth[s],i<t.length-1&&(o+=e.U.getPairAdjustment(r,s,f))}}return a},e.U.pathToSVG=function(r,e){null==e&&(e=5);for(var t=[],n=0,a={M:2,L:2,Q:4,C:6},o=0;o<r.cmds.length;o++){var i=r.cmds[o],s=n+(a[i]?a[i]:0);for(t.push(i);n<s;){var f=r.crds[n++];t.push(parseFloat(f.toFixed(e))+(n==s?"":" "))}}return t.join("")},e.U.pathToContext=function(r,e){for(var t=0,n=r.crds,a=0;a<r.cmds.length;a++){var o=r.cmds[a];"M"==o?(e.moveTo(n[t],n[t+1]),t+=2):"L"==o?(e.lineTo(n[t],n[t+1]),t+=2):"C"==o?(e.bezierCurveTo(n[t],n[t+1],n[t+2],n[t+3],n[t+4],n[t+5]),t+=6):"Q"==o?(e.quadraticCurveTo(n[t],n[t+1],n[t+2],n[t+3]),t+=4):"#"==o.charAt(0)?(e.beginPath(),e.fillStyle=o):"Z"==o?e.closePath():"X"==o&&e.fill()}},e.U.P={},e.U.P.moveTo=function(r,e,t){r.cmds.push("M"),r.crds.push(e,t)},e.U.P.lineTo=function(r,e,t){r.cmds.push("L"),r.crds.push(e,t)},e.U.P.curveTo=function(r,e,t,n,a,o,i){r.cmds.push("C"),r.crds.push(e,t,n,a,o,i)},e.U.P.qcurveTo=function(r,e,t,n,a){r.cmds.push("Q"),r.crds.push(e,t,n,a)},e.U.P.closePath=function(r){r.cmds.push("Z")},e.U._drawCFF=function(r,t,n,a,o){for(var i=t.stack,s=t.nStems,f=t.haveWidth,u=t.width,h=t.open,l=0,d=t.x,c=t.y,v=0,p=0,g=0,m=0,y=0,U=0,S=0,x=0,b=0,_=0,w={val:0,size:0};l<r.length;){e.CFF.getCharString(r,l,w);var F=w.val;if(l+=w.size,"o1"==F||"o18"==F)i.length%2!=0&&!f&&(u=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,f=!0;else if("o3"==F||"o23"==F){i.length%2!=0&&!f&&(u=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,f=!0}else if("o4"==F)i.length>1&&!f&&(u=i.shift()+a.nominalWidthX,f=!0),h&&e.U.P.closePath(o),c+=i.pop(),e.U.P.moveTo(o,d,c),h=!0;else if("o5"==F)for(;i.length>0;)d+=i.shift(),c+=i.shift(),e.U.P.lineTo(o,d,c);else if("o6"==F||"o7"==F)for(var C=i.length,k="o6"==F,T=0;T<C;T++){var M=i.shift();k?d+=M:c+=M,k=!k,e.U.P.lineTo(o,d,c)}else if("o8"==F||"o24"==F){C=i.length;for(var P=0;P+6<=C;)v=d+i.shift(),p=c+i.shift(),g=v+i.shift(),m=p+i.shift(),d=g+i.shift(),c=m+i.shift(),e.U.P.curveTo(o,v,p,g,m,d,c),P+=6;"o24"==F&&(d+=i.shift(),c+=i.shift(),e.U.P.lineTo(o,d,c))}else{if("o11"==F)break;if("o1234"==F||"o1235"==F||"o1236"==F||"o1237"==F)"o1234"==F&&(p=c,g=(v=d+i.shift())+i.shift(),_=m=p+i.shift(),U=m,x=c,d=(S=(y=(b=g+i.shift())+i.shift())+i.shift())+i.shift(),e.U.P.curveTo(o,v,p,g,m,b,_),e.U.P.curveTo(o,y,U,S,x,d,c)),"o1235"==F&&(v=d+i.shift(),p=c+i.shift(),g=v+i.shift(),m=p+i.shift(),b=g+i.shift(),_=m+i.shift(),y=b+i.shift(),U=_+i.shift(),S=y+i.shift(),x=U+i.shift(),d=S+i.shift(),c=x+i.shift(),i.shift(),e.U.P.curveTo(o,v,p,g,m,b,_),e.U.P.curveTo(o,y,U,S,x,d,c)),"o1236"==F&&(v=d+i.shift(),p=c+i.shift(),g=v+i.shift(),_=m=p+i.shift(),U=m,S=(y=(b=g+i.shift())+i.shift())+i.shift(),x=U+i.shift(),d=S+i.shift(),e.U.P.curveTo(o,v,p,g,m,b,_),e.U.P.curveTo(o,y,U,S,x,d,c)),"o1237"==F&&(v=d+i.shift(),p=c+i.shift(),g=v+i.shift(),m=p+i.shift(),b=g+i.shift(),_=m+i.shift(),y=b+i.shift(),U=_+i.shift(),S=y+i.shift(),x=U+i.shift(),Math.abs(S-d)>Math.abs(x-c)?d=S+i.shift():c=x+i.shift(),e.U.P.curveTo(o,v,p,g,m,b,_),e.U.P.curveTo(o,y,U,S,x,d,c));else if("o14"==F){if(i.length>0&&!f&&(u=i.shift()+n.nominalWidthX,f=!0),4==i.length){var I=i.shift(),D=i.shift(),O=i.shift(),A=i.shift(),G=e.CFF.glyphBySE(n,O),B=e.CFF.glyphBySE(n,A);e.U._drawCFF(n.CharStrings[G],t,n,a,o),t.x=I,t.y=D,e.U._drawCFF(n.CharStrings[B],t,n,a,o)}h&&(e.U.P.closePath(o),h=!1)}else if("o19"==F||"o20"==F){i.length%2!=0&&!f&&(u=i.shift()+a.nominalWidthX),s+=i.length>>1,i.length=0,f=!0,l+=s+7>>3}else if("o21"==F)i.length>2&&!f&&(u=i.shift()+a.nominalWidthX,f=!0),c+=i.pop(),d+=i.pop(),h&&e.U.P.closePath(o),e.U.P.moveTo(o,d,c),h=!0;else if("o22"==F)i.length>1&&!f&&(u=i.shift()+a.nominalWidthX,f=!0),d+=i.pop(),h&&e.U.P.closePath(o),e.U.P.moveTo(o,d,c),h=!0;else if("o25"==F){for(;i.length>6;)d+=i.shift(),c+=i.shift(),e.U.P.lineTo(o,d,c);v=d+i.shift(),p=c+i.shift(),g=v+i.shift(),m=p+i.shift(),d=g+i.shift(),c=m+i.shift(),e.U.P.curveTo(o,v,p,g,m,d,c)}else if("o26"==F)for(i.length%2&&(d+=i.shift());i.length>0;)v=d,p=c+i.shift(),d=g=v+i.shift(),c=(m=p+i.shift())+i.shift(),e.U.P.curveTo(o,v,p,g,m,d,c);else if("o27"==F)for(i.length%2&&(c+=i.shift());i.length>0;)p=c,g=(v=d+i.shift())+i.shift(),m=p+i.shift(),d=g+i.shift(),c=m,e.U.P.curveTo(o,v,p,g,m,d,c);else if("o10"==F||"o29"==F){var L="o10"==F?a:n;if(0==i.length)console.log("error: empty stack");else{var W=i.pop(),E=L.Subrs[W+L.Bias];t.x=d,t.y=c,t.nStems=s,t.haveWidth=f,t.width=u,t.open=h,e.U._drawCFF(E,t,n,a,o),d=t.x,c=t.y,s=t.nStems,f=t.haveWidth,u=t.width,h=t.open}}else if("o30"==F||"o31"==F){var R=i.length,V=(P=0,"o31"==F);for(P+=R-(C=-3&R);P<C;)V?(p=c,g=(v=d+i.shift())+i.shift(),c=(m=p+i.shift())+i.shift(),C-P==5?(d=g+i.shift(),P++):d=g,V=!1):(v=d,p=c+i.shift(),g=v+i.shift(),m=p+i.shift(),d=g+i.shift(),C-P==5?(c=m+i.shift(),P++):c=m,V=!0),e.U.P.curveTo(o,v,p,g,m,d,c),P+=4}else{if("o"==(F+"").charAt(0))throw console.log("Unknown operation: "+F,r),F;i.push(F)}}}t.x=d,t.y=c,t.nStems=s,t.haveWidth=f,t.width=u,t.open=h},e},function(){var r=function(){var r={},e=0,t=-3;function n(){this.table=new Uint16Array(16),this.trans=new Uint16Array(288)}function a(r,e){this.source=r,this.sourceIndex=0,this.tag=0,this.bitcount=0,this.dest=e,this.destLen=0,this.ltree=new n,this.dtree=new n}var o=new n,i=new n,s=new Uint8Array(30),f=new Uint16Array(30),u=new Uint8Array(30),h=new Uint16Array(30),l=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),d=new n,c=new Uint8Array(320);function v(r,e,t,n){var a,o;for(a=0;a<t;++a)r[a]=0;for(a=0;a<30-t;++a)r[a+t]=a/t|0;for(o=n,a=0;a<30;++a)e[a]=o,o+=1<<r[a]}var p=new Uint16Array(16);function g(r,e,t,n){var a,o;for(a=0;a<16;++a)r.table[a]=0;for(a=0;a<n;++a)r.table[e[t+a]]++;for(r.table[0]=0,o=0,a=0;a<16;++a)p[a]=o,o+=r.table[a];for(a=0;a<n;++a)e[t+a]&&(r.trans[p[e[t+a]]++]=a)}function m(r){r.bitcount--||(r.tag=r.source[r.sourceIndex++],r.bitcount=7);var e=1&r.tag;return r.tag>>>=1,e}function y(r,e,t){if(!e)return t;for(;r.bitcount<24;)r.tag|=r.source[r.sourceIndex++]<<r.bitcount,r.bitcount+=8;var n=r.tag&65535>>>16-e;return r.tag>>>=e,r.bitcount-=e,n+t}function U(r,e){for(;r.bitcount<24;)r.tag|=r.source[r.sourceIndex++]<<r.bitcount,r.bitcount+=8;var t=0,n=0,a=0,o=r.tag;do{n=2*n+(1&o),o>>>=1,++a,t+=e.table[a],n-=e.table[a]}while(n>=0);return r.tag=o,r.bitcount-=a,e.trans[t+n]}function S(r,e,t){var n,a,o,i,s,f;for(n=y(r,5,257),a=y(r,5,1),o=y(r,4,4),i=0;i<19;++i)c[i]=0;for(i=0;i<o;++i){var u=y(r,3,0);c[l[i]]=u}for(g(d,c,0,19),s=0;s<n+a;){var h=U(r,d);switch(h){case 16:var v=c[s-1];for(f=y(r,2,3);f;--f)c[s++]=v;break;case 17:for(f=y(r,3,3);f;--f)c[s++]=0;break;case 18:for(f=y(r,7,11);f;--f)c[s++]=0;break;default:c[s++]=h}}g(e,c,0,n),g(t,c,n,a)}function x(r,t,n){for(;;){var a,o,i,l,d=U(r,t);if(256===d)return e;if(d<256)r.dest[r.destLen++]=d;else for(a=y(r,s[d-=257],f[d]),o=U(r,n),l=i=r.destLen-y(r,u[o],h[o]);l<i+a;++l)r.dest[r.destLen++]=r.dest[l]}}function b(r){for(var n,a;r.bitcount>8;)r.sourceIndex--,r.bitcount-=8;if((n=256*(n=r.source[r.sourceIndex+1])+r.source[r.sourceIndex])!==(65535&~(256*r.source[r.sourceIndex+3]+r.source[r.sourceIndex+2])))return t;for(r.sourceIndex+=4,a=n;a;--a)r.dest[r.destLen++]=r.source[r.sourceIndex++];return r.bitcount=0,e}return function(r,e){var t;for(t=0;t<7;++t)r.table[t]=0;for(r.table[7]=24,r.table[8]=152,r.table[9]=112,t=0;t<24;++t)r.trans[t]=256+t;for(t=0;t<144;++t)r.trans[24+t]=t;for(t=0;t<8;++t)r.trans[168+t]=280+t;for(t=0;t<112;++t)r.trans[176+t]=144+t;for(t=0;t<5;++t)e.table[t]=0;for(e.table[5]=32,t=0;t<32;++t)e.trans[t]=t}(o,i),v(s,f,4,3),v(u,h,2,1),s[28]=0,f[28]=258,r.exports=function(r,n){var s,f,u=new a(r,n);do{switch(s=m(u),y(u,2,0)){case 0:f=b(u);break;case 1:f=x(u,o,i);break;case 2:S(u,u.ltree,u.dtree),f=x(u,u.ltree,u.dtree);break;default:f=t}if(f!==e)throw new Error("Data error")}while(!s);return u.destLen<u.dest.length?"function"==typeof u.dest.slice?u.dest.slice(0,u.destLen):u.dest.subarray(0,u.destLen):u.dest},r.exports}();return function(e){return function(r,e){var t=new DataView(r),n=0;function a(){var r=t.getUint16(n);return n+=2,r}function o(){var r=t.getUint32(n);return n+=4,r}function i(r){y.setUint16(U,r),U+=2}function s(r){y.setUint32(U,r),U+=4}for(var f={signature:o(),flavor:o(),length:o(),numTables:a(),reserved:a(),totalSfntSize:o(),majorVersion:a(),minorVersion:a(),metaOffset:o(),metaLength:o(),metaOrigLength:o(),privOffset:o(),privLength:o()},u=0;Math.pow(2,u)<=f.numTables;)u++;u--;for(var h=16*Math.pow(2,u),l=16*f.numTables-h,d=12,c=[],v=0;v<f.numTables;v++)c.push({tag:o(),offset:o(),compLength:o(),origLength:o(),origChecksum:o()}),d+=16;var p,g=new Uint8Array(12+16*c.length+c.reduce(function(r,e){return r+e.origLength+4},0)),m=g.buffer,y=new DataView(m),U=0;return s(f.flavor),i(f.numTables),i(h),i(u),i(l),c.forEach(function(r){s(r.tag),s(r.origChecksum),s(d),s(r.origLength),r.outOffset=d,(d+=r.origLength)%4!=0&&(d+=4-d%4)}),c.forEach(function(t){var n=r.slice(t.offset,t.offset+t.compLength);if(t.compLength!=t.origLength){var a=new Uint8Array(t.origLength);e(new Uint8Array(n,2),a)}else a=new Uint8Array(n);g.set(a,t.outOffset);var o=0;(d=t.outOffset+t.origLength)%4!=0&&(o=4-d%4),g.set(new Uint8Array(o).buffer,t.outOffset+t.origLength),p=d+o}),m.slice(0,p)}(e,r)}},function(r,e){var t={M:2,L:2,Q:4,C:6,Z:0};function n(e,t){var n=e.glyphToUnicodeMap;if(!n){n=e.glyphToUnicodeMap=Object.create(null);var a=e.cmap,o=-1;if(null!=a.p0e4?o=a.p0e4:null!=a.p3e1?o=a.p3e1:null!=a.p1e0?o=a.p1e0:null!=a.p0e3&&(o=a.p0e3),-1===o)throw"no familiar platform and encoding!";var i=a.tables[o];if(0===i.format)for(var s=0;s<i.map.length;s++)n[i.map[s]]=s;else if(4===i.format)for(var f=i.startCount,u=i.endCount,h=0;h<f.length;h++)for(var l=f[h];l<=u[h];l++)n[r.U.codeToGlyph(e,l)]=l;else{if(12!==i.format)throw"unknown cmap table format "+i.format;i.groups.forEach(function(r){for(var e=r[0],t=r[1],a=r[2],o=e;o<=t;o++)n[a++]=o})}}return n[t]||0}return function(a){var o,i,s,f,u=new Uint8Array(a,0,4),h=r._bin.readASCII(u,0,4);if("wOFF"===h)a=e(a);else if("wOF2"===h)throw new Error("woff2 fonts not supported");return o=r.parse(a),i=o[0],s=Object.create(null),f={unitsPerEm:i.head.unitsPerEm,ascender:i.hhea.ascender,descender:i.hhea.descender,forEachGlyph:function(e,a,o,u){var h=0,l=1/f.unitsPerEm*a;return r.U.stringToGlyphs(i,e).forEach(function(e){if(-1!==e){var f=s[e];if(!f){var d=r.glyf._parseGlyf(i,e)||{xMin:0,xMax:0,yMin:0,yMax:0},c=r.U.glyphToPath(i,e),v=c.cmds,p=c.crds;f=s[e]={index:e,unicode:n(i,e),advanceWidth:i.hmtx.aWidth[e],xMin:d.xMin,yMin:d.yMin,xMax:d.xMax,yMax:d.yMax,pathCommandCount:v.length,forEachPathCommand:function(r){for(var e=0,n=[],a=0,o=v.length;a<o;a++){var i=t[v[a]];n.length=1+i,n[0]=v[a];for(var s=1;s<=i;s++)n[s]=p[e++];r.apply(null,n)}}}}u.call(null,f,h),f.advanceWidth&&(h+=f.advanceWidth*l),o&&(h+=o*a)}}),h}}}}],init:function(r,e,t){return t(r(),e())}}),_={defaultFontURL:"https://fonts.gstatic.com/s/roboto/v18/KFOmCnqEu92Fr1Mu4mxM.woff",sdfGlyphSize:64},w=document.createElement("a"),F=64,C=1/8,k=Object.create(null);var T=s({dependencies:[_,C,b,function(r){var e=r.sdfTextureSize,t=r.sdfDistancePercent,n=16;function a(r,e,t,n,a,o,i){var s=1-i;return{x:s*s*r+2*s*i*t+i*i*a,y:s*s*e+2*s*i*n+i*i*o}}function o(r,e,t,n,a,o,i,s,f){var u=1-f;return{x:u*u*u*r+3*u*u*f*t+3*u*f*f*a+f*f*f*i,y:u*u*u*e+3*u*u*f*n+3*u*f*f*o+f*f*f*s}}function i(r){return r*r}function s(r,e,t,n,a,o){var s=a-t,f=o-n,u=i(s)+i(f),h=u?Math.max(0,Math.min(1,((r-t)*s+(e-n)*f)/u)):0;return Math.sqrt(i(r-(t+h*s))+i(e-(n+h*f)))}var f=function(r){var e=r.xMin,t=r.yMin,n=r.xMax-e,a=r.yMax-t,o=Math.round(e+n/2),i=Math.round(t+a/2),s=Math.pow(2,Math.floor(Math.log(Math.max(n,a))*Math.LOG2E));this._root={0:null,1:null,2:null,3:null,data:null,cx:o,cy:i,r:s,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}};return f.prototype.addLineSegment=function(r,e,t,n){var a={x0:r,y0:e,x1:t,y1:n,cx:(r+t)/2,cy:(e+n)/2,minX:Math.min(r,t),minY:Math.min(e,n),maxX:Math.max(r,t),maxY:Math.max(e,n),next:null};this._insertSegment(a,this._root)},f.prototype._insertSegment=function(r,e){var t=r.minX,n=r.minY,a=r.maxX,o=r.maxY,i=r.cx,s=r.cy;t<e.minX&&(e.minX=t),n<e.minY&&(e.minY=n),a>e.maxX&&(e.maxX=a),o>e.maxY&&(e.maxY=o);var f=e.data;if(f)if(f.cx===i&&f.cy===s){for(;f.next;)f=f.next;f.next=r}else e.data=null,this._insertSegment(f,e),this._insertSegment(r,e);else{var u=(s<e.cy?0:2)+(i<e.cx?0:1);e[u]?this._insertSegment(r,e[u]):e[u]={0:null,1:null,2:null,3:null,data:r,cx:e.cx+e.r/2*(u%2?1:-1),cy:e.cy+e.r/2*(u<2?-1:1),r:e.r/2,minX:t,minY:n,maxX:a,maxY:o}}},f.prototype.walkTree=function(r){this.walkBranch(this._root,r)},f.prototype.walkBranch=function(r,e){if(!1!==e(r)&&!r.data)for(var t=0;t<4;t++)null!==r[t]&&this.walkBranch(r[t],e)},f.prototype.findNearestSignedDistance=function(r,e,t){var n=t;return this.walkTree(function(t){if(r-n>t.maxX||r+n<t.minX||e-n>t.maxY||e+n<t.minY)return!1;if(t.data)for(var a=t.data;a;a=a.next)if(r-n<a.maxX||r+n>a.minX||e-n<a.maxY||e+n>a.minY){var o=s(r,e,a.x0,a.y0,a.x1,a.y1);o<n&&(n=o)}}),this.isPointInPoly(r,e)||(n=-n),n},f.prototype.isPointInPoly=function(r,e){var t=!1;return this.walkTree(function(n){if(n.maxX<r||n.minY>e||n.maxY<e)return!1;if(n.data)for(var a=n.data;a;a=a.next){var o=a.x0,i=a.y0,s=a.x1,f=a.y1;i>e!=f>e&&r<(s-o)*(e-i)/(f-i)+o&&(t=!t)}}),t},function(r){var s=new Uint8Array(i(e)),u=r.xMax-r.xMin,h=r.yMax-r.yMin,l=Math.max(u,h)*t,d=(u+2*l)/e,c=(h+2*l)/e,v=r.xMin-l-d,p=r.yMin-l-c,g=r.xMax+l+d,m=r.yMax+l+c;if(r.pathCommandCount){var y,U,S,x,b=new f(r);r.forEachPathCommand(function(r,e,t,i,s,f,u){switch(r){case"M":S=y=e,x=U=t;break;case"L":e===S&&t===x||b.addLineSegment(S,x,S=e,x=t);break;case"Q":for(var h={x:S,y:x},l=1;l<n;l++){var d=a(S,x,e,t,i,s,l/(n-1));b.addLineSegment(h.x,h.y,d.x,d.y),h=d}S=i,x=s;break;case"C":for(var c={x:S,y:x},v=1;v<n;v++){var p=o(S,x,e,t,i,s,f,u,v/(n-1));b.addLineSegment(c.x,c.y,p.x,p.y),c=p}S=f,x=u;break;case"Z":S===y&&x===U||b.addLineSegment(S,x,y,U)}});for(var _=0;_<e;_++)for(var w=0;w<e;w++){var F=b.findNearestSignedDistance(v+(g-v)*(_+.5)/e,p+(m-p)*(w+.5)/e,l),C=isFinite(F)?Math.round(255*(1+F/l)*.5):F;C=Math.max(0,Math.min(255,C)),s[w*e+_]=C}}return{textureData:s,renderingBounds:[v,p,g,m]}}},function(r,e,t){var n=t.defaultFontUrl,a=Object.create(null),o=1/0;function i(e,t){e||(e=n);var o=a[e];if(o)o.onload?o.onload.push(t):t();else{var i=a[e]={onload:[t]};!function(e,t){!function a(){var o=function(r){console.error("Failure loading font "+e+(e===n?"":"; trying fallback"),r),e!==n&&(e=n,a())};try{var i=new XMLHttpRequest;i.open("get",e,!0),i.responseType="arraybuffer",i.onload=function(){try{var e=r(i.response);t(e)}catch(r){o(r)}},i.onerror=o,i.send()}catch(r){o(r)}}()}(e,function(r){o=a[e]={fontObj:r,glyphs:{},glyphCount:0},i.onload.forEach(function(r){return r()})})}}function s(r,t,s){var f=r.text;void 0===f&&(f="");var u=r.font;void 0===u&&(u=n);var h=r.fontSize;void 0===h&&(h=1);var l=r.letterSpacing;void 0===l&&(l=0);var d=r.lineHeight;void 0===d&&(d="normal");var c=r.maxWidth;void 0===c&&(c=o);var v=r.textAlign;void 0===v&&(v="left");var p=r.whiteSpace;void 0===p&&(p="normal");var g=r.overflowWrap;void 0===g&&(g="normal");var m=r.anchor;void 0===s&&(s=!1),function(r,e){r||(r=n),i(r,function(){e(a[r])})}(u,function(r){var n=r.fontObj,a=isFinite(c),i=null,u=null,y=null,U=null,S=0,x=0,b="nowrap"!==p,_=h/n.unitsPerEm;"normal"===d&&(d=(n.ascender-n.descender)/n.unitsPerEm);var w=((d*=h)-(n.ascender-n.descender)*_)/2,F=f.split(/\r?\n/).map(function(r){var e=0,t=[],o=[t];n.forEachGlyph(r,h,l,function(r,n){var i=r.unicode,s="number"==typeof i&&String.fromCharCode(i),f=r.advanceWidth*_,u=!!s&&/\s/.test(s);if(b&&a&&!u&&n+f+e>c&&t.length){var h;if(t[t.length-1].isWhitespace)h=[],e=-n;else for(var l=t.length;l--;){if(0===l&&"break-word"===g){h=[],e=-n;break}if(t[l].isWhitespace){var d=(h=t.splice(l+1))[0].x;e-=d;for(var v=0;v<h.length;v++)h[v].x-=d;break}}if(h){for(;t[t.length-1].isWhitespace;)t.pop();o.push(t=h),x=c}}t.push({glyphObj:r,x:n+e,y:0,width:f,char:s,isWhitespace:u,isEmpty:r.xMin===r.xMax||r.yMin===r.yMax,atlasInfo:null})});for(var i=0;i<o.length&&x<c;i++){var s=o[i];if(s.length){var f=s[s.length-1];x=Math.max(x,f.x+f.width)}}return S+=o.length,o});if(!s){var C=[],k=-(h+w);F.forEach(function(t){for(var n=0;n<t.length;n++){var a=t[n];if(a.length){var o=0,s=a[a.length-1],f=s.x+s.width,u=0;if("center"===v)o=(x-f)/2;else if("right"===v)o=x-f;else if("justify"===v)for(var h=0,l=a.length;h<l;h++)a[h].isWhitespace&&u++;for(var c=0,p=a.length;c<p;c++){var g=a[c];if(g.isWhitespace&&"justify"===v&&n!==t.length-1&&(o+=(x-f)/u),!g.isWhitespace&&!g.isEmpty){var m=g.glyphObj,y=r.glyphs[m.index];if(!y){var U=e(m);U.atlasIndex=r.glyphCount++,i||(i=[]),i.push(U),y=r.glyphs[m.index]={atlasIndex:U.atlasIndex,glyphObj:m,renderingBounds:U.renderingBounds}}g.atlasInfo=y,o&&(g.x+=o),g.y=k,C.push(g)}}}k-=d}});var T=0,M=0;m&&(m[0]&&(T=-x*m[0]),m[1]&&(M=S*d*m[1])),u=new Float32Array(4*C.length),y=new Float32Array(C.length),U=[o,o,-o,-o],C.forEach(function(r,e){var t=r.atlasInfo,n=t.renderingBounds,a=t.atlasIndex,o=u[4*e]=r.x+n[0]*_+T,i=u[4*e+1]=r.y+n[1]*_+M,s=u[4*e+2]=r.x+n[2]*_+T,f=u[4*e+3]=r.y+n[3]*_+M;o<U[0]&&(U[0]=o),i<U[1]&&(U[1]=i),s>U[2]&&(U[2]=s),f>U[3]&&(U[3]=f),y[e]=a})}t({glyphBounds:u,glyphIndices:y,totalBounds:U,totalBlockSize:[x,S*d],newGlyphSDFs:i})})}return{process:s,measure:function(r,e){s(r,function(r){e({width:r.totalBlockSize[0],height:r.totalBlockSize[1]})},!0)},loadFont:i}}],init:function(r,e,t,n,a){return a(t,n({sdfTextureSize:r.sdfGlyphSize,sdfDistancePercent:e}),{defaultFontUrl:r.defaultFontURL})}}),M=s({dependencies:[T,l],init:function(r,e){return function(t){var n=new e;return r.process(t,n.resolve),n}},getTransferables:function(r){var e=[r.glyphBounds.buffer,r.glyphIndices.buffer];return r.newGlyphSDFs&&r.newGlyphSDFs.forEach(function(r){e.push(r.textureData.buffer)}),e}}),P=new e.PlaneBufferGeometry(1,1).translate(.5,.5,0),I=new e.Vector3,D="aTroikaGlyphBounds",O="aTroikaGlyphIndex",A=function(r){function t(){r.call(this),this.copy(P),this.addAttribute(D,new e.InstancedBufferAttribute(new Float32Array(0),4)),this.addAttribute(O,new e.InstancedBufferAttribute(new Float32Array(0),1)),this.boundingSphere=new e.Sphere}return r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t,t.prototype.computeBoundingSphere=function(){},t.prototype.updateGlyphs=function(r,e,t){G(this.attributes[D],r),G(this.attributes[O],e),this.maxInstancedCount=e.length;var n=this.boundingSphere;n.center.set((t[0]+t[2])/2,(t[1]+t[3])/2,0),n.radius=n.center.distanceTo(I.set(t[0],t[1],0))},t}(e.InstancedBufferGeometry);function G(r,e){r.array.length===e.length?r.array.set(e):r.setArray(e),r.needsUpdate=!0}var B="\nuniform float uTroikaGlyphVSize;\nuniform vec4 uTroikaTotalBounds;\nattribute vec4 aTroikaGlyphBounds;\nattribute float aTroikaGlyphIndex;\nvarying vec2 vTroikaGlyphUV;\nvarying vec3 vTroikaLocalPos;\n",L="\nvTroikaGlyphUV = vec2(\n  position.x,\n  uTroikaGlyphVSize * (aTroikaGlyphIndex + position.y)\n);\n\nposition = vec3(\n  position.x == 1.0 ? aTroikaGlyphBounds.z : aTroikaGlyphBounds.x,\n  position.y == 1.0 ? aTroikaGlyphBounds.w : aTroikaGlyphBounds.y,\n  0.0\n);\nvTroikaLocalPos = vec3(position);\n\nuv = vec2(\n  (position.x - uTroikaTotalBounds.x) / (uTroikaTotalBounds.z - uTroikaTotalBounds.x),\n  (position.y - uTroikaTotalBounds.y) / (uTroikaTotalBounds.w - uTroikaTotalBounds.y)\n);\n",W="\nuniform sampler2D uTroikaSDFTexture;\nuniform float uTroikaSDFMinDistancePct;\nuniform bool uTroikaSDFDebug;\nuniform float uTroikaGlyphVSize;\nuniform vec4 uTroikaClipRect;\nvarying vec2 vTroikaGlyphUV;\nvarying vec3 vTroikaLocalPos;\n\nvoid troikaApplyClipping() {\n  vec4 rect = uTroikaClipRect;\n  vec3 pos = vTroikaLocalPos;\n  if (rect != vec4(.0,.0,.0,.0) && (\n    pos.x < min(rect.x, rect.z) || \n    pos.y < min(rect.y, rect.w) ||\n    pos.x > max(rect.x, rect.z) ||\n    pos.y > max(rect.y, rect.w)\n  )) {\n    discard;\n  }\n}\n",E="\ntroikaApplyClipping();\n\nfloat troikaSDFValue = texture2D(uTroikaSDFTexture, vTroikaGlyphUV).r;\n\n\n#if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300\n  float troikaAntiAliasDist = min(\n    0.5,\n    0.5 * min(\n      fwidth(vTroikaGlyphUV.x), \n      fwidth(vTroikaGlyphUV.y / uTroikaGlyphVSize)\n    )\n  ) / uTroikaSDFMinDistancePct;\n#else\n  float troikaAntiAliasDist = 0.01;\n#endif\n\nfloat textAlphaMult = uTroikaSDFDebug ? troikaSDFValue : smoothstep(\n  0.5 - troikaAntiAliasDist,\n  0.5 + troikaAntiAliasDist,\n  troikaSDFValue\n);\nif (textAlphaMult == 0.0) {\n  if (uTroikaSDFDebug) {\n    gl_FragColor *= 0.5;\n  } else {\n    discard;\n  }\n} else {\n  gl_FragColor.a *= textAlphaMult;\n}\n";var R=new e.MeshBasicMaterial({color:16777215,side:e.DoubleSide,transparent:!0}),V=Object.freeze([0,0,0,0]),z=new e.Matrix4,j=new e.Mesh(new e.PlaneBufferGeometry(1,1).translate(.5,.5,0),R),X=function(r){function t(e){var t=new A;r.call(this,t,null),this.text="",this.anchor=null,this.font=null,this.fontSize=.1,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.whiteSpace="normal",this.material=null,this.color=null,this.depthOffset=0,this.clipRect=null,this.debugSDF=!1}r&&(t.__proto__=r),t.prototype=Object.create(r&&r.prototype),t.prototype.constructor=t;var n={material:{configurable:!0}};return t.prototype.sync=function(r){var t=this;this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(r):(this._isSyncing=!0,function(r,t){r=function(r,e){for(var t in e)e.hasOwnProperty(t)&&(r[t]=e[t]);return r}({},r),w.href=r.font||_.defaultFontURL,r.font=w.href,r.text=""+r.text;var n=_.sdfGlyphSize,a=k[r.font];a||((a=k[r.font]={sdfTexture:new e.DataTexture(new Uint8Array(n*n*F),n,n*F,e.LuminanceFormat,void 0,void 0,void 0,void 0,e.LinearFilter,e.LinearFilter)}).sdfTexture.font=r.font),M(r).then(function(r){r.newGlyphSDFs&&(r.newGlyphSDFs.forEach(function(r){for(var e=r.textureData,t=r.atlasIndex,o=a.sdfTexture.image,i=t*n*n;i>o.data.length-1;){var s=new Uint8Array(2*o.data.length);s.set(o.data),o.data=s,o.height*=2}o.data.set(e,i)}),a.sdfTexture.needsUpdate=!0),t({sdfTexture:a.sdfTexture,sdfMinDistancePercent:C,glyphBounds:r.glyphBounds,glyphIndices:r.glyphIndices,totalBounds:r.totalBounds,totalBlockSize:r.totalBlockSize})})}({text:this.text,font:this.font,fontSize:this.fontSize,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,maxWidth:this.maxWidth,textAlign:this.textAlign,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchor:this.anchor},function(e){t._isSyncing=!1,t._textRenderInfo=e,t.geometry.updateGlyphs(e.glyphBounds,e.glyphIndices,e.totalBounds);var n=t._queuedSyncs;n&&(t._queuedSyncs=null,t._needsSync=!0,t.sync(function(){n.forEach(function(r){return r&&r()})})),r&&r()})))},t.prototype.onBeforeRender=function(){this.sync(),this._prepareMaterial()},t.prototype.dispose=function(){var r=this._derivedMaterial;r&&r.dispose(),this.geometry.dispose()},n.material.get=function(){var r=this._derivedMaterial,t=this._baseMaterial||R;return r&&r.baseMaterial===t||(r&&r.dispose(),r=this._derivedMaterial=function(r){var t=m(r,{extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFMinDistancePct:{value:0},uTroikaGlyphVSize:{value:0},uTroikaTotalBounds:{value:new e.Vector4},uTroikaClipRect:{value:new e.Vector4},uTroikaSDFDebug:{value:!1}},vertexDefs:B,vertexTransform:L,fragmentDefs:W,fragmentColorTransform:E});return t.transparent=!0,t}(t)),r},n.material.set=function(r){this._baseMaterial=r},t.prototype._prepareMaterial=function(){var r=this._derivedMaterial,e=this._textRenderInfo,t=r.uniforms;if(e){var n=e.sdfTexture;t.uTroikaSDFTexture.value=n,t.uTroikaSDFMinDistancePct.value=e.sdfMinDistancePercent,t.uTroikaGlyphVSize.value=n.image.width/n.image.height,t.uTroikaTotalBounds.value.fromArray(e.totalBounds)}t.uTroikaSDFDebug.value=!!this.debugSDF;var a=this.clipRect;a&&Array.isArray(a)&&4===a.length||(a=V),t.uTroikaClipRect.value.fromArray(a),r.polygonOffset=!!this.depthOffset,r.polygonOffsetFactor=r.polygonOffsetUnits=this.depthOffset||0;var o=this.color;null!=o&&r.color&&r.color.isColor&&o!==r._troikaColor&&r.color.set(r._troikaColor=o)},t.prototype.raycast=function(r,e){var t=this._textRenderInfo;if(t){var n=t.totalBounds;j.matrixWorld.multiplyMatrices(this.matrixWorld,z.set(n[2]-n[0],0,0,n[0],0,n[3]-n[1],0,n[1],0,0,1,0,0,0,0,1)),j.raycast(r,e)}},Object.defineProperties(t.prototype,n),t}(e.Mesh);["font","fontSize","letterSpacing","lineHeight","maxWidth","overflowWrap","text","textAlign","whiteSpace","anchor"].forEach(function(r){var e="_private_"+r;Object.defineProperty(X.prototype,r,{get:function(){return this[e]},set:"anchor"===r?function(r){JSON.stringify(r)!==JSON.stringify(this[e])&&(this[e]=r,this._needsSync=!0)}:function(r){r!==this[e]&&(this[e]=r,this._needsSync=!0)}})});r.registerComponent("troika-text",{schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string"},fontSize:{type:"number",default:.2},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},maxWidth:{type:"number",default:1/0},overflowWrap:{type:"string",default:"normal",oneOf:["normal","break-word"]},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","nowrap"]}},init:function(){(this.textMesh=new X).anchor=[0,0],this.el.setObject3D(this.attrName,this.textMesh)},update:function(){var r=this.data,e=this.textMesh;console.log(r),e.text=r.value,e.textAlign=r.align,e.anchor[0]=N[r.anchor],e.anchor[1]=Y[r.baseline],e.color=r.color,e.font=r.font,e.fontSize=r.fontSize,e.letterSpacing=r.letterSpacing||0,e.lineHeight=r.lineHeight||null,e.overflowWrap=r.overflowWrap,e.whiteSpace=r.whiteSpace,e.maxWidth=r.maxWidth,e.sync()},remove:function(){this.textMesh.dispose(),this.el.removeObject3D(this.attrName)}});var N={left:0,center:.5,right:1},Y={top:0,center:.5,bottom:1},H={},q=r.components["troika-text"].schema;Object.keys(q).map(function(r){var e=r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();H[e]="troika-text."+r}),r.registerPrimitive("a-troika-text",{defaultComponents:{"troika-text":{}},mappings:H})}(AFRAME,THREE);
//# sourceMappingURL=aframe-troika-text.min.js.map
